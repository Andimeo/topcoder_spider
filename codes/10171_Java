<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br> <br>public class PerfectRectangles {<br>    public int numberOfRectangles(int n, int M, int X0, int A, int B, int Y0, int C, int D) {<br>        boolean[][] a = new boolean[n + 2][n + 2];<br> <br>        int x = X0 % n;<br>        int y = Y0 % n;<br>        for (int i = 0; i &lt; M; i++) {<br>            a[x + 1][y + 1] = true;<br>            x = (x * A + B) % n;<br>            y = (y * C + D) % n;<br>        }<br> <br>        for (int i = 0; i &lt; n + 2; i++) {<br>            a[0][i] = true;<br>            a[n + 1][i] = true;<br>            a[i][0] = true;<br>            a[i][n + 1] = true;<br>        }<br> <br>//        for (int i = 1; i &lt;= n; i++) {<br>//            for (int j = 1; j &lt;= n; j++) {<br>//                System.out.print(a[i][j] ? "+" : ".");<br>//            }<br>//            System.out.println("");<br>//        }<br>//        System.out.println("");<br> <br>        int[][] u = new int[n + 2][n + 2];<br>        for (int i = 0; i &lt; n + 2; i++) {<br>            for (int j = 0; j &lt; n + 2; j++) {<br>                if (a[i][j]) {<br>                    u[i][j] = 0;<br>                } else {<br>                    u[i][j] = u[i - 1][j] + 1;<br>                }<br>            }<br>        }<br> <br>        int[][] s = new int[n + 2][n + 2];<br>        for (int i = 0; i &lt; n + 2; i++) {<br>            s[i][0] = 1;<br>            for (int j = 1; j &lt; n + 2; j++) {<br>                s[i][j] = s[i][j - 1];<br>                if (a[i][j]) s[i][j]++;<br>            }<br>        }<br> <br>        int[] c = new int[n + 2];<br>        int[] h = new int[n + 2];<br> <br>        int res = 0;<br>        for (int i = 1; i &lt;= n; i++) {<br>            int k = 0;<br>            for (int j = 1; j &lt;= n + 1; j++) {<br>                int jj = j;<br>                while (k &gt; 0 &amp;&amp; h[k - 1] &gt; u[i][j]) {<br>                    jj = c[k - 1];<br>                    if (s[i + 1][j - 1] &gt; s[i + 1][c[k - 1] - 1]) {<br>                        res++;<br>                    }<br>                    k--;<br>                }<br>                if (u[i][j] &gt; 0 &amp;&amp; (k == 0 || h[k - 1] &lt; u[i][j])) {<br>                    c[k] = jj;<br>                    h[k] = u[i][j];<br>                    k++;<br>                }<br>            }<br>        }<br> <br>        return res;<br>    }<br> <br>}<br> <br> <br>// Powered by FileEdit<br>// Powered by RETester [based on ExampleBuilder]<br>// Powered by CodeProcessor<br></td>