<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class ShufflingMachine<br>  Public Function stackDeck(ByVal shuffle As Integer(), ByVal maxShuffles As Integer, ByVal cardsReceived As Integer(), ByVal K As Integer) As Double<br>    dim nc as integer = shuffle.getupperbound(0)<br>    dim ishuffle(nc) as integer<br>    dim i as integer, j as integer, L as  Integer<br>    <br>    <br>    dim ishuffles(nc, maxshuffles) as integer<br>    For I = 0 to nc<br>      ishuffles(I,0) = I<br>    Next I<br>    For I = 1 to maxshuffles<br>      for J = 0 to nc<br>        ishuffles(shuffle(J), I) = ishuffles(J,I-1)<br>      next J<br>    Next I<br>    <br>    Dim EV As Double = 0<br>    Dim BestSpot As Integer<br>    Dim BestVal as Integer<br>    Dim Pick(nc) As Integer<br>    <br>    For I = 0 to cardsreceived.getupperbound(0)<br>      For J = 1 to maxshuffles<br>        pick(ishuffles(cardsreceived(I),J)) += 1<br>      Next J<br>    Next I<br>    <br>    <br>    For I = 1 to K<br>      BestVal = 0<br>      For J = 0 to nc<br>        If BestVal &lt; pick(J) Then<br>          BestVal = pick(J)<br>          BestSpot = J<br>        end If<br>      Next J<br>      pick(bestspot) =  0<br>      EV += BestVal / maxshuffles<br>    Next I<br>    Return EV<br>    <br>  End Function<br>End Class<br></td>