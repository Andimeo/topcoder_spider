<td class="problemText" colspan="8" valign="middle" align="left">
            using System; using System.Collections; public class Calculate { public int calc(String expr_, String[] vs) {<br>expr = expr_;<br>foreach (String vv in vs)<br> {<br> String[] ss = vv.Split(new char[]{' '});<br> v[ss[0]] = Convert.ToInt64(ss[1]);<br> }<br> <br>return (int) Expr();<br>}<br> <br>long Expr()<br>{<br>/*if (expr[pos] == '(')<br> {<br> pos++;<br> long xx = Expr();<br> pos++;<br> return xx;<br> }<br>*/<br> <br>long x = Expr2();<br>while (pos &lt; expr.Length &amp;&amp; (expr[pos] == '+' || expr[pos] == '-'))<br> {<br> char op = expr[pos++];<br> long y = Expr2();<br> long z = (op=='+') ? x+y : x-y;<br> //Console.WriteLine("{0} {1} {2} -&gt; {3}", x, op, y, z);<br> x = z;<br> }<br> <br>return x;<br>} // Expr<br> <br>long Expr2()<br>{<br>long x = Expr3();<br>while (pos &lt; expr.Length &amp;&amp; (expr[pos] == '*' || expr[pos] == '/'))<br> {<br> char op = expr[pos++];<br> long y = Expr3();<br> long z = (op=='*') ? x*y : x/y;<br> //Console.WriteLine("{0} {1} {2} -&gt; {3}", x, op, y, z);<br> x = z;<br> }<br> <br>return x;<br>} // Expr2<br> <br>long Expr3()<br>{<br>long x = Expr4();<br>while (pos &lt; expr.Length &amp;&amp; expr[pos] == '^')<br> {<br> pos++;<br> long y = Expr4();<br> long z = (long) Math.Pow(x,y);<br> //Console.WriteLine("{0} ^ {2} -&gt; {3}", x, "^", y, z);<br> x = z;<br> }<br> <br>return x;<br>}<br> <br>long Expr4()<br>{<br>char c = expr[pos++];<br>if (c == '(')<br> {<br> long xx = Expr();<br> pos++;<br> return xx;<br> }<br> <br>if (c &gt;= '0' &amp;&amp; c &lt;= '9')<br> {<br> long x = (int)c - 48;<br> while (pos &lt; expr.Length &amp;&amp; Char.IsDigit(expr[pos]))<br>  x = x*10 + (int)expr[pos++] - 48;<br> <br> return x;<br> }<br> <br>int start = pos-1;<br>while (pos &lt; expr.Length &amp;&amp; Char.IsLetter(expr[pos]))<br> pos++;<br> <br>String vname = expr.Substring(start, pos-start);<br>// Console.WriteLine(vname);<br>return (long) v[vname];<br>}<br> <br>int pos = 0;<br>String expr;<br>Hashtable v = new Hashtable();<br>}<br></td>