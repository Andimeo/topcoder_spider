<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt;<br>#include &lt;list&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;deque&gt;<br>#include &lt;queue&gt;<br>#include &lt;stack&gt;<br>#include &lt;bitset&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;functional&gt;<br>#include &lt;numeric&gt;<br>#include &lt;utility&gt;<br>#include &lt;sstream&gt;<br>#include &lt;iostream&gt;<br>#include &lt;iomanip&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;cctype&gt;<br>#include &lt;string&gt;<br>#include &lt;cstring&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;ctime&gt;<br> <br>using namespace std;<br> <br>#define LENGTH(X) ((int)(X.length()))<br> <br>const int maxsize=400+5;<br>const int MODE=1000000007;<br> <br>class Unicorn<br>{<br>public:<br>  char A[maxsize][maxsize];<br>  int f0[maxsize][maxsize],f1[maxsize][maxsize];<br>  int n,m;<br>  int s1[maxsize],s2[maxsize];<br>  int countWays(int R, int C, int L, int seed, string word)<br>  {<br>    int x=seed;<br>    int d=(65535/L)+1;<br>    for (int r=0; r&lt;R; r++)<br>      for (int c=0; c&lt;C; c++) <br>      {<br>        x=(x*25173+13849)%65536;<br>        A[r+1][c+1] =char(65+x/d);<br>      }<br>    n=R;<br>    m=C;<br>    memset(f0,0,sizeof(f0));<br>    for (int i=1;i&lt;=n;i++)<br>      for (int j=1;j&lt;=m;j++)<br>        if (A[i][j]==word[0])<br>          f0[i][j]=1;<br>    for (int pos=1;pos&lt;LENGTH(word);pos++)<br>    {<br>      char key=word[pos];<br>      memset(f1,0,sizeof(f1));<br>      int S=0;<br>      memset(s1,0,sizeof(s1));<br>      memset(s2,0,sizeof(s2));<br>      for (int i=1;i&lt;=n;i++)<br>        for (int j=1;j&lt;=m;j++)<br>        {<br>          S=(S+f0[i][j])%MODE;<br>          s1[i]=(s1[i]+f0[i][j])%MODE;<br>          s2[j]=(s2[j]+f0[i][j])%MODE;<br>        }<br>      for (int i=1;i&lt;=n;i++)<br>        for (int j=1;j&lt;=m;j++)<br>          if (A[i][j]==key)<br>          {<br>            int t=S;<br>            for (int d=-1;d&lt;=1;d++)<br>            {<br>              if (i+d&gt;=1 &amp;&amp; i+d&lt;=n)<br>                t=(t-s1[i+d]+MODE)%MODE;<br>              if (j+d&gt;=1 &amp;&amp; j+d&lt;=m)<br>                t=(t-s2[j+d]+MODE)%MODE;<br>            }<br>            for (int dx=-1;dx&lt;=1;dx++)<br>              for (int dy=-1;dy&lt;=1;dy++)<br>                if (i+dx&gt;=1 &amp;&amp; i+dx&lt;=n &amp;&amp; j+dy&gt;=1 &amp;&amp; j+dy&lt;=m)<br>                  t=(t+f0[i+dx][j+dy])%MODE;<br>            for (int dx=-2;dx&lt;=2;dx+=4)<br>              for (int dy=-2;dy&lt;=2;dy+=4)<br>                if (i+dx&gt;=1 &amp;&amp; i+dx&lt;=n &amp;&amp; j+dy&gt;=1 &amp;&amp; j+dy&lt;=m)<br>                  t=(t-f0[i+dx][j+dy]+MODE)%MODE;<br>            f1[i][j]=t;<br>          }<br>      memcpy(f0,f1,sizeof(f0));<br>    }<br>    int result=0;<br>    for (int i=1;i&lt;=n;i++)<br>      for (int j=1;j&lt;=m;j++)<br>        result=(result+f0[i][j])%MODE;<br>    return result;<br>  }<br>};<br> <br> <br> <br>// Powered by PopsEdit<br></td>