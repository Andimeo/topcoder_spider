<td class="problemText" colspan="8" valign="middle" align="left">
            Imports System<br>Imports System.Collections<br><br><br>  Public Class BidirectionalQueue<br>  <br>    Public Sub New()<br>    End Sub<br>    <br>    Public Function extractElements(N As Integer, indices As Integer()) As Integer<br>      Dim result As Integer = 0<br>      Dim queue As ArrayList = New ArrayList()<br>      For i As Integer = 1 To N<br>        queue.Add(i)<br>      Next<br>      <br>      Dim index As Integer<br>      Dim counter As Integer<br>      Dim ind As Integer<br>      For j As Integer = 0 To indices.Length - 1<br>        ind = indices(j)<br>        index = LinearSearch(queue, ind)<br>        If index &lt;= (queue.Count / 2) Then<br>          result += index<br>          counter = index<br>          'Console.Write("Index: " &amp; index &amp; ", Ind: " &amp; ind &amp; ", Count: " &amp; index &amp; " =&gt; ")<br>          'WriteQueue(queue)<br>          While counter &gt; 0 <br>            ShiftLeft(queue)<br>            counter -= 1<br>          End While<br>        Else<br>          result += (queue.Count - index)<br>          counter = (queue.Count - index)<br>          'Console.Write("Index: " &amp; index &amp; ", Ind: " &amp; ind &amp; ", Count: " &amp; (queue.Count - index) &amp; " =&gt; ")<br>          'WriteQueue(queue)<br>          While counter &gt; 0 <br>            ShiftRight(queue)<br>            counter -= 1<br>          End While<br>        End If<br>        queue.RemoveAt(0)<br>      Next<br>      'Console.WriteLine("Result: " &amp; result)<br>      Return result<br>    End Function<br>    <br>    Private Sub ShiftLeft(queue As ArrayList)<br>      If queue.Count &gt; 1 Then<br>        Dim temp As Integer = queue(0)<br>        For i As Integer = 1 To queue.Count - 1<br>          queue(i - 1) = queue(i)<br>        Next<br>        queue(queue.Count - 1) = temp<br>      End If<br>    End Sub<br>    <br>    Private Sub ShiftRight(queue As ArrayList)<br>      If queue.Count &gt; 1 Then<br>        Dim temp As Integer = queue(queue.Count - 1)<br>        For i As Integer = queue.Count - 1 To 1 Step -1<br>          queue(i) = queue(i-1)<br>        Next<br>        queue(0) = temp<br>      End If<br>    End Sub<br>    <br>    Private Function LinearSearch(queue As ArrayList, pattern As Integer) As Integer<br>      Dim result As Integer = -1<br>      For i As Integer = 0 To queue.Count - 1<br>        If queue(i) = pattern Then<br>          result = i<br>          Exit For<br>        End If<br>      Next<br>      Return result<br>    End Function<br>    <br>    Public Sub WriteQueue(queue As ArrayList)<br>      For Each a As Integer In queue<br>        Console.Write(a &amp; " ")<br>      Next<br>      Console.WriteLine<br>    End Sub<br>  End Class<br></td>