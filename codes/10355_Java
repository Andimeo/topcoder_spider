<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br> <br>public class EndlessStringMachine {<br>    public String getFragment(String input, String program, int s, int min, int max) {<br>        int numDollar = 0;<br>        for (int i = 0; i &lt; program.length(); ++i)<br>            if (program.charAt(i) == '$')<br>                ++numDollar;<br>        if (numDollar == 1) {<br>            String suffix = program.substring(1);<br>            String res = "";<br>            for (int i = min; i &lt;= max; ++i)<br>                res += getSimple(input, suffix, s, i);<br>            return res;<br>        } else {<br>            List&lt;Long&gt; sizes = new ArrayList&lt;Long&gt;();<br>            long cur = input.length();<br>            sizes.add(cur);<br>            while (cur &lt; max &amp;&amp; sizes.size() &lt; s + 1) {<br>                cur = cur * numDollar + (program.length() - numDollar);<br>                sizes.add(cur);<br>            }<br>            s = sizes.size() - 1;<br>            String res = "";<br>            for (int i = min; i &lt;= max; ++i)<br>                res += get(sizes, input, program, s, i);<br>            return res;<br>        }<br>    }<br> <br>    private char getSimple(String input, String suffix, int s, int i) {<br>        if (i &gt; input.length() + suffix.length() * (long) s)<br>            return '-';<br>        if (i &lt;= input.length())<br>            return input.charAt(i - 1);<br>        return suffix.charAt((i - input.length() - 1) % suffix.length());<br>    }<br> <br>    private char get(List&lt;Long&gt; sizes, String input, String program, int s, int i) {<br>        if (i &gt; sizes.get(s))<br>            return '-';<br>        if (s == 0)<br>            return input.charAt(i - 1);<br>        for (int j = 0; j &lt; program.length(); ++j) {<br>            if (program.charAt(j) == '$') {<br>                if (sizes.get(s - 1) &gt;= i)<br>                    return get(sizes, input, program, s - 1, i);<br>                else<br>                    i -= sizes.get(s - 1);<br>            } else {<br>                if (i == 1)<br>                    return program.charAt(j);<br>                else<br>                    --i;<br>            }<br>        }<br>        throw new RuntimeException();<br>    }<br> <br>}<br> <br> <br>// Powered by FileEdit<br>// Powered by RETester [based on ExampleBuilder]<br>// Powered by CodeProcessor<br></td>