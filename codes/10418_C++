<td class="problemText" colspan="8" valign="middle" align="left">
            // unfortunately I have no ideas for a good line here<br><br>#include &lt;algorithm&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>using namespace std;<br><br>#define LS &lt;<br>#define Size(x) (int(x.size()))<br><br>// All macros with parameters "k,a,b" run the "k" variable in range [a,b)<br>#define FOR(k,a,b) for(typeof(a) k=(a); k LS (b); ++k)<br><br>#line 3 "CantorDust.cc"<br><br>int occ(string&amp; a, string&amp; b) {<br>  int res = 0;<br>  FOR(k,0,1+Size(b)-Size(a)) if(b.substr(k,Size(a)) == a) res++;<br>  return res;<br>  }<br><br>char cantor(int i) {<br>  if(i &lt; 3) return i["X.X"];<br>  if(i%3 == 1) return '.';<br>  return cantor(i/3);<br>  }<br><br>class CantorDust {<br>  public:<br>  int occurrencesNumber(vector &lt;string&gt; pattern, int time) {<br>    // !FDI<br>    <br>    int by, bx = -1;<br>    <br>    int sy = Size(pattern);<br>    int sx = Size(pattern[0]);<br>    <br>    FOR(y,0,sy) FOR(x,0,sx) if(pattern[y][x] == 'X') by = y, bx = x;<br>    <br>    string key = "";<br>    <br>    int its = 1; FOR(u,0,time) its *= 3;<br>    FOR(xx,0,its) key += cantor(xx);<br>    <br>    string stry = "";<br>    string strx = "";<br>    <br>    bool empty = bx == -1; if(empty) bx = 0, by = 0;<br>    <br>    FOR(y,0,sy) stry += pattern[y][bx];<br>    FOR(x,0,sx) strx += pattern[by][x];<br>    <br>    FOR(y,0,sy) FOR(x,0,sx) {<br>      bool bs = stry[y] == 'X' &amp;&amp; strx[x] == 'X';<br>      bool ba = pattern[y][x] == 'X';<br>      if(bs != ba) return 0;<br>      }<br>    <br>    int occy = occ(stry, key);<br>    int occx = occ(strx, key);<br>    <br>    if(empty) {<br>      return occy * (its-sx+1) + occx * (its-sy+1) - occy*occx;<br>      }<br><br>    return occy * occx;<br>    }<br>  };<br><br><br><br><br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003]<br>// Powered by CodeProcessor<br></td>