<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br> <br>public class IOIString {<br>    static final int MOD = 1000000007;<br> <br>    public int countIOIs(String[] mask) {<br>        StringBuilder b = new StringBuilder();<br>        for (String x : mask)<br>            b.append(x);<br>        String s = b.toString();<br>        int res = 1;<br>        int numIs = 0;<br>        for (int i = 0; i &lt; s.length(); ++i)<br>            if (s.charAt(i) == '?')<br>                res = (res * 2) % MOD;<br>            else if (s.charAt(i) == 'I')<br>                ++numIs;<br>        for (int delta = 1; delta &lt; s.length(); delta += 2)<br>            for (int start = 0; start &lt; delta; ++start) {<br>                res = (res - count(s, start, delta, numIs) + MOD) % MOD;<br>            }<br>        if (numIs == 1)<br>            res = (res - 1 + MOD) % MOD;<br>        if (numIs == 0) {<br>            res = (res - 1 + MOD) % MOD;<br>            for (int i = 0; i &lt; s.length(); ++i)<br>                if (s.charAt(i) == '?')<br>                    res = (res - 1 + MOD) % MOD;<br>        }<br>        return res;<br>    }<br> <br>    private int count(String s, int start, int delta, int numIs) {<br>        int firstI = -1;<br>        int lastI = -1;<br>        int numI = 0;<br>        for (int i = start; i &lt; s.length(); i += delta)<br>            if (s.charAt(i) == 'I') {<br>                if (firstI &lt; 0)<br>                    firstI = i;<br>                lastI = i;<br>                ++numI;<br>            }<br>        if (numI != numIs)<br>            return 0;<br>        int res = 0;<br>        if (numI &gt; 0) {<br>            for (int i = firstI; i &lt;= lastI; i += delta)<br>                if (s.charAt(i) == 'O')<br>                    return 0;<br>            int lI = firstI;<br>            while (lI - delta &gt;= 0 &amp;&amp; s.charAt(lI - delta) == '?')<br>                lI -= delta;<br>            int rI = lastI;<br>            while (rI + delta &lt; s.length() &amp;&amp; s.charAt(rI + delta) == '?')<br>                rI += delta;<br>            res += ((rI - lastI) / delta + 1) * ((firstI - lI) / delta + 1);<br>            if (firstI == lastI)<br>                --res;<br>        } else {<br>            int first = start;<br>            int i;<br>            for (i = start; i &lt; s.length(); i += delta)<br>                if (s.charAt(i) == 'O') {<br>                    if (first + delta &lt; i) {<br>                        int num = (i - first) / delta;<br>                        res += num * (num - 1) / 2;<br>                    }<br>                    first = i + delta;<br>                }<br>            if (first + delta &lt; i) {<br>                int num = (i - first) / delta;<br>                res += num * (num - 1) / 2;<br>            }<br>        }<br>        return res % MOD;<br>    }<br> <br>}<br> <br> <br>// Powered by FileEdit<br>// Powered by RETester [based on ExampleBuilder]<br>// Powered by CodeProcessor<br></td>