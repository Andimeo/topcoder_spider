<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.util.regex.*;<br>import java.text.*;<br>import java.math.*;<br> <br>public class DonutsOnTheGrid {<br>  public long calc(int H, int W, int seed, int threshold) {<br>    boolean[][] field = new boolean[H][W];<br>    for (int i = 0; i &lt; H; i++) {<br>      for (int j = 0; j &lt; W; j++) {<br>        seed = (seed * 25173 + 13849) % 65536;<br>        if (seed &lt; threshold) {<br>          field[i][j] = true;<br>        }<br>      }<br>    }<br>    boolean[] ok = new boolean[W];<br>    long ans = 0;<br>    for (int top = 0; top &lt; H - 2; top++) {<br>      for (int i = 0; i &lt; ok.length; i++) {<br>        ok[i] = field[top][i] &amp; field[top + 1][i];<br>      }<br>      for (int bottom = top + 2; bottom &lt; H; bottom++) {<br>        int cnt = 0, first = -1, last = -1;<br>        ;<br>        for (int i = 0; i &lt; ok.length; i++) {<br>          ok[i] &amp;= field[bottom][i];<br>          if (ok[i]) {<br>            if (first == -1)<br>              first = i;<br>            last = i;<br>          }<br>        }<br>        if (first == last)<br>          continue; // no donuts<br>        boolean okok = true;<br>        for (int i = first + 1; i &lt;= last; i++) {<br>          okok &amp;= field[top][i] &amp;&amp; field[bottom][i];<br>          if (ok[i]) {<br>            if (okok) {<br>              cnt++;<br>              ans += cnt;<br>              if (ok[i - 1])<br>                ans--;<br>            } else {<br>              cnt = 0;<br>              okok = true;<br>            }<br>          }<br>        }<br>      }<br>    }<br>    return ans;<br>  }<br> <br>}<br>//Powered by KawigiEdit 2.1.4 (beta) modified by pivanof!<br></td>