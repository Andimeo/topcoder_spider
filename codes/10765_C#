<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Collections.Generic;<br>using System.Text;<br><br>public class RoadOrFlightHard {<br>    public long minTime(int N, int roadFirst, int roadProd, int roadAdd, int roadMod, int flightFirst, int flightProd, int flightAdd, int flightMod, int K)<br>    {<br>        long[] roadTime = new long[N];<br>        long[] flightTime = new long[N];<br>        int i, j;<br>        roadTime[0] = roadFirst % roadMod;<br>        flightTime[0] = flightFirst % flightMod;<br>        for (i = 1; i &lt; N; i++)<br>        {<br>            roadTime[i] = ((long)roadTime[i - 1] * roadProd + roadAdd) % roadMod;<br>            flightTime[i] = ((long)flightTime[i - 1] * flightProd + flightAdd) % flightMod;<br>        }<br>        long[,] dp = new long[K + 2, 2];<br>        for (j = 0; j &lt;= K + 1; j++)<br>        {<br>            dp[j, 0] = dp[j, 1] = long.MaxValue &gt;&gt; 1;<br>        }<br>        dp[0, 0] = 0;<br>        for (i = 0; i &lt; N; i++)<br>        {<br>            long[,] ndp = new long[K + 2, 2];<br>            for (j = 0; j &lt;= K + 1; j++)<br>            {<br>                ndp[j, 0] = ndp[j, 1] = long.MaxValue &gt;&gt; 1;<br>            }<br>            for (j = 0; j &lt;= K; j++)<br>            {<br>                ndp[j + 1, 1] = Math.Min(ndp[j + 1, 1], dp[j, 0] + flightTime[i]);<br>                ndp[j, 1] = Math.Min(ndp[j, 1], dp[j, 1] + flightTime[i]);<br>                ndp[j, 0] = Math.Min(ndp[j, 0], dp[j, 0] + roadTime[i]);<br>                ndp[j, 0] = Math.Min(ndp[j, 0], dp[j, 1] + roadTime[i]);<br>            }<br>            dp = (long[,])ndp.Clone();<br>        }<br>        long res = long.MaxValue &gt;&gt; 1;<br>        for (i = 0; i &lt;= K; i++)<br>        {<br>            for (j = 0; j &lt; 2; j++) res = Math.Min(res, dp[i, j]);<br>        }<br>        return res;<br>    }<br><br><br>}<br><br><br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003] [modified for C# by Petr]<br>// Powered by CodeProcessor<br></td>