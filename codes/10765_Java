<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.math.*;<br>import java.io.*;<br>import java.text.*;<br>public class RoadOrFlightHard {<br>  final static long INF = 1000000000000000L;<br>    public long minTime(int N, int roadFirst, int roadProd, int roadAdd, int roadMod, int flightFirst, int flightProd, int flightAdd, int flightMod, int K) {<br>        long res;<br>        long tf[] = new long[N];<br>        long tr[] = new long[N];<br>        tr[0] = roadFirst % roadMod;<br>        for( int i = 1; i &lt; N; i++ ) {<br>          tr[i] = (tr[i-1] * roadProd + roadAdd) % roadMod;<br>        }<br>        tf[0] = flightFirst % flightMod;<br>        for( int i = 1; i &lt; N; i++ ) {<br>          tf[i] = (tf[i-1] * flightProd + flightAdd) % flightMod;<br>        }<br>        long cur[][] = new long[K+1][2];<br>        long next[][] = new long[K+1][2];<br>        for( int i = 0; i &lt;= K; i++ ) {<br>          for( int j = 0; j &lt; 2; j++ ) {<br>            cur[i][j] = INF;<br>          }<br>        }<br>        cur[K][0] = 0;<br>        for( int i = 0; i &lt; N; i++ ) {<br>            for( int j = 0; j &lt;= K; j++ ) {<br>              for( int k = 0; k &lt; 2; k++ ) {<br>                next[j][k] = INF;<br>              }<br>            }<br>          for( int j = 0; j &lt;= K; j++ ) {<br>             if( next[j][0] &gt; cur[j][0] + tr[i] ) {<br>               next[j][0] = cur[j][0] + tr[i];<br>             }<br>             if( j &gt; 0 &amp;&amp; next[j-1][1] &gt; cur[j][0] + tf[i] ) {<br>               next[j-1][1] = cur[j][0] + tf[i];<br>             }<br>             if( next[j][1] &gt; cur[j][1] + tf[i] ) {<br>               next[j][1] = cur[j][1] + tf[i];<br>             }<br>          }<br>            for( int j = 0; j &lt;= K; j++ ) {<br>              if( next[j][0] &gt; next[j][1] ) next[j][0] = next[j][1];<br>              for( int k = 0; k &lt; 2; k++ ) {<br>                cur[j][k] = next[j][k];<br>              }<br>            }<br>        }<br>        res = INF;<br>        for( int i = 0; i &lt;= K; i++ ) {<br>          for( int k = 0; k &lt; 2; k++ ) {<br>            if( res &gt; cur[i][k] ) res = cur[i][k];<br>          }<br>        }<br>        return res;<br>    }<br><br>}<br><br><br>// Powered by FileEdit<br>// Powered by CodeProcessor<br></td>