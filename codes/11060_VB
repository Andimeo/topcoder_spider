<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class TimeTravellingGardener<br><br>        Public Function determineUsage(ByVal distance As Integer(), ByVal height As Integer()) As Integer<br><br>            Dim xDist(height.Length - 1) As Integer<br>            Dim bestCount As Integer = 1<br>            Dim valid As Boolean<br>            Dim y As Double<br><br>            xDist(0) = 0<br>            For i As Integer = 1 To height.Length - 1<br>                xDist(i) = xDist(i - 1) + distance(i - 1)<br>            Next<br><br>            For i As Integer = 0 To height.Length - 2<br>                For j As Integer = i + 1 To height.Length - 1<br>                    Dim rise As Double = height(j) - height(i)<br>                    Dim run As Double = xDist(j) - xDist(i)<br><br>                    Dim count As Integer = 0<br>                    valid = True<br>                    For k As Integer = 0 To height.Length - 1<br>                        y = rise * (xDist(k) - xDist(i)) / run + height(i)<br>                        y = Math.Round(y * 1000000) / 1000000<br>                        If y = height(k) Then<br>                            count += 1<br>                        ElseIf y &gt; height(k) Or y &lt; 0 Then<br>                            valid = False<br>                            Exit For<br>                        End If<br>                    Next<br><br>                    If valid AndAlso count &gt; bestCount Then<br>                        bestCount = count<br>                    End If<br>                Next<br>            Next<br><br>            Return height.Length - bestCount<br>        End Function<br>    End Class<br></td>