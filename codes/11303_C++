<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt; <br>#include &lt;list&gt; <br>#include &lt;map&gt; <br>#include &lt;set&gt; <br>#include &lt;deque&gt; <br>#include &lt;queue&gt; <br>#include &lt;stack&gt; <br>#include &lt;bitset&gt; <br>#include &lt;algorithm&gt; <br>#include &lt;functional&gt; <br>#include &lt;numeric&gt; <br>#include &lt;utility&gt; <br>#include &lt;complex&gt; <br>#include &lt;sstream&gt; <br>#include &lt;iostream&gt; <br>#include &lt;iomanip&gt; <br>#include &lt;cstdio&gt; <br>#include &lt;cmath&gt; <br>#include &lt;cstdlib&gt; <br>#include &lt;cstring&gt; <br>#include &lt;ctime&gt; <br>#include &lt;cassert&gt; <br>using namespace std;<br><br>#define ME(s,a) memset((s),(a),sizeof((s)))<br>#define MM(s) memset((s),-1,sizeof((s)))<br>#define MCP(s,a) memcpy((s), (a), sizeof(s))<br>#define LL long long<br>#define PII pair&lt;int, int&gt;<br>#define mkp(a,b) make_pair((a),(b))<br>#define x first<br>#define y second<br><br>int n;<br><br>int f[55][55][55][55];<br>bool v[55][55];<br><br>const int p[8]={0,0,1,1,1,-1,-1,-1};<br>const int q[8]={1,-1,1,0,-1,1,0,-1};<br><br>void add(int X1,int Y1,int X2,int Y2,int X3,int Y3){<br>  f[X1][Y1][X2][Y2]=f[X2][Y2][X1][Y1]=1;<br>  f[X1][Y1][X3][Y3]=f[X3][Y3][X1][Y1]=1;<br>  f[X3][Y3][X2][Y2]=f[X2][Y2][X3][Y3]=1;<br>}<br>int cnt;<br><br>void dfs(int x,int y){<br>  cnt++;v[x][y]=1;<br>  for (int i=0;i&lt;8;i++){<br>    int t1=x+q[i],t2=y+p[i];<br>    if (f[x][y][t1][t2]&amp;&amp;!v[t1][t2])<br>      dfs(t1,t2);<br>  }<br>  return;<br>}<br><br>class HexagonPuzzle{<br>public:<br>  int theCount(vector &lt;string&gt; a){<br>    memset(f,0,sizeof(f));<br>    n=a.size();<br>    for (int i=0;i&lt;n;i++)<br>      for (int j=0;j&lt;=i;j++)<br>        if (a[i][j]=='.'){<br>          if (i+1&lt;n)<br>            if (a[i+1][j]=='.'&amp;&amp;a[i+1][j+1]=='.')<br>              add(i,j,i+1,j,i+1,j+1);<br>          if (i+1&lt;n&amp;&amp;j+1&lt;=i)<br>            if (a[i+1][j+1]=='.'&amp;&amp;a[i][j+1]=='.')<br>              add(i,j,i,j+1,i+1,j+1);<br>        }<br>    memset(v,0,sizeof(v));<br>    long long ret=1;<br>    for (int i=0;i&lt;n;i++)<br>      for (int j=0;j&lt;=i;j++)<br>        if (a[i][j]=='.'&amp;&amp;!v[i][j]){<br>          cnt=0;<br>          dfs(i,j);<br>          for (int k=cnt;k&gt;2;k--)<br>            ret=(ret*(long long)(k))%1000000007ll;<br>        }<br>    return (int)(ret%1000000007ll);<br>    <br>  }<br><br>};<br><br><br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003]<br>// Powered by CodeProcessor<br></td>