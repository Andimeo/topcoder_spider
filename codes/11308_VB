<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Collections.Generic<br>Imports System.Text<br>Imports System.Math<br>Imports Weight = System.Int32<br>Public Class P8XGraphBuilder<br>    Public Scores As Integer()<br>    Public DP(100, 3, 100) As Integer<br>    Public Function rec(ByVal Remain As Integer, ByVal now As Integer, ByVal Count As Integer) As Integer<br>        Dim i As Integer, j As Integer<br>        If DP(Remain, now, Count) &gt;= 0 Then Return DP(Remain, now, Count)<br>        Dim Ans As Integer = 0<br>            If Count = 0 Then<br>                Return 0<br>            End If<br>            For i = 0 To Remain<br>                '[\u20309][\u20491][\u26032][\u35215][\u12395][\u32331][\u12368][\u12363]<br>                '[\u12371][\u12428][\u33258][\u36523][\u12399][\u26082][\u12395][\u20986][\u26469][\u12390][\u12356][\u12427]<br>                For j = 0 To Remain - i<br>                    '[\u12371][\u12398][\u19979][\u12398][\u26408][\u12395][\u20351][\u12358][\u20491][\u25968]<br>                    Ans = Max(Ans, Scores(i) + rec(j, 0, i) + rec(Remain - i - j, 0, Count - 1))<br>                Next<br>            Next<br>            'Console.WriteLine("{0},{1},{2}:{3}", Remain, now, Count, Ans)<br> <br>        DP(Remain, now, Count) = Ans<br>        rec = Ans<br>    End Function<br>    Public Function solve(ByVal scores_ As Integer()) As Integer<br>        Scores = scores_<br>        Dim i As Integer, j As Integer<br>        For i = 0 To 100<br>            For j = 0 To 100<br>                DP(i, 0, j) = -1<br>                DP(i, 1, j) = -1<br> <br>            Next<br>        Next<br>        '[\u27531][\u12426][\u12398][\u12494][\u12540][\u12489][\u12398][\u20491][\u25968]([\u29694][\u22312][\u12398][\u12494][\u12540][\u12489][\u12434][\u38500][\u12367])&lt;=50<br>        '[\u29694][\u22312][\u32331][\u12387][\u12390][\u12356][\u12427][\u20491][\u25968](1 or 0)<br>        '[\u20316][\u25104][\u20491][\u25968] &lt;=50<br>        Dim N As Integer = Scores.Length + 1<br>        solve = 0<br>        For i = 1 To N - 1<br>            solve = Max(solve, Scores(i - 1) + rec(N - i - 1, 1, i))<br>        Next<br>    End Function<br> <br>End Class<br></td>