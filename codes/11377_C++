<td class="problemText" colspan="8" valign="middle" align="left">
            // unfortunately I have no ideas for a good line here<br> <br>#include &lt;algorithm&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>#include &lt;stdio.h&gt;<br>using namespace std;<br> <br>typedef vector&lt;string&gt; vs;<br> <br>#define Size(x) (int(x.size()))<br> <br>#define INF 1000000000<br> <br>#line 3 "MonochromePuzzle.cpp"<br> <br>int morph[50];<br>bool fri[50];<br> <br>int tab[50][50];<br> <br>int N, QM = 0;<br> <br>int seq[50];<br> <br>int best = INF;<br> <br>vs oboard;<br> <br>void genmorph(int i) {<br>  if(i == N) {<br>    QM++;<br>    int gmorph[50];<br>    int here = 0;<br>    for(int i=0; i&lt;N; i++) gmorph[i] = morph[i];<br>    for(int i=0; i&lt;N; i++) while(gmorph[i] != i) swap(gmorph[i], gmorph[gmorph[i]]), here++;<br>    if(here &lt; best) best = here;<br>    if(0) { for(int k=0; k&lt;N; k++) printf("%3d", morph[k]); printf(" -&gt; %d\n", here); }<br>    return;<br>    }<br>  for(int k=0; k&lt;N; k++) if(fri[k]) {<br>    for(int t=0; t&lt;i; t++) if((oboard[seq[k]][seq[morph[t]]] == '#') != tab[seq[i]][seq[t]]) goto nextk;<br>    fri[k] = false; morph[i] = k;<br>    genmorph(i+1);<br>    fri[k] = true;<br>    nextk: ;<br>    }<br>  }<br> <br>class MonochromePuzzle {<br>  public:<br>  int getMinimum(vector &lt;string&gt; board) {<br>    // !FDI<br>    best = INF;<br>    N = Size(board);<br>    oboard = board;<br>    for(int y=0; y&lt;N; y++) if(board[y][y] == '#') return -1;<br>    for(int y=0; y&lt;N; y++) for(int x=0; x&lt;N; x++) <br>      if(board[y][x] != board[x][y]) return -1;<br>    for(int y=0; y&lt;N; y++) {<br>      int c = 0;<br>      for(int x=0; x&lt;N; x++) if(board[y][x] == '#') c++;<br>      if(c != 3) return -1;<br>      }<br>    <br>    for(int y=0; y&lt;N; y++) for(int x=0; x&lt;N; x++)<br>      if(x-y == 1 || y-x == 1 || x+y == N-1 || (x*y == 0 &amp;&amp; x+y == N/2-1) || (x*y == (N/2)*(N-1) &amp;&amp; x+y == N/2+N-1))<br>        tab[y][x] = 1;<br>      else tab[y][x] = 0;<br>    <br>    if(0) for(int y=0; y&lt;N; y++) {<br>      for(int x=0; x&lt;N; x++) printf("%d", tab[y][x]);<br>      printf("\n");<br>      }<br>    <br>    for(int k=0; k&lt;N; k++) fri[k] = true;<br>    <br>    int qs = 0;<br>    for(int k=0; k&lt;N/4; k++) {<br>      seq[qs++] = k;<br>      seq[qs++] = N/2-1-k;<br>      seq[qs++] = N-1-k;<br>      seq[qs++] = N/2+k;<br>      }<br>    if(N % 4 == 2) seq[qs++] = N/4, seq[qs++] = N-N/4-1;<br>    if(0) for(int k=0; k&lt;N; k++) printf("%d ", seq[k]); printf("\n");<br>    <br>    genmorph(0);<br>    //printf("QM = %d\n", QM);<br> <br>    if(best == INF) return -1;<br>    return best;<br>    }<br>  };<br> <br> <br> <br> <br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003]<br>// Powered by CodeProcessor<br></td>