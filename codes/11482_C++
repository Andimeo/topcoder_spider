<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;iostream&gt;<br>#include &lt;sstream&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>#include &lt;deque&gt;<br>#include &lt;queue&gt;<br>#include &lt;set&gt;<br>#include &lt;map&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;functional&gt;<br>#include &lt;utility&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;ctime&gt;<br><br>using namespace std;<br><br>#define REP(i,n) for((i)=0;(i)&lt;(int)(n);(i)++)<br><br>typedef long long ll;<br>#define MOD 1000000007ll<br><br>ll odd[20][20],even[20][20];<br>ll a[20][(1&lt;&lt;10)];<br>ll dp[20][(1&lt;&lt;10)];<br><br>class MagicalGirlLevelTwoDivOne{<br>  public:<br><br>  int theCount(vector &lt;string&gt; palette, int X, int Y){<br>    int H=palette.size(),W=palette[0].length(),mask,mask2,i,j;<br>    <br>    REP(i,X) REP(j,Y) odd[i][j] = even[i][j] = 1;<br>    REP(i,H) REP(j,W){<br>      if(palette[i][j] != '.'){<br>        int n = palette[i][j] - '0';<br>        if(n%2 == 0) odd[i%X][j%Y] = 0; else even[i%X][j%Y] = 0;<br>      } else {<br>        odd[i%X][j%Y] = odd[i%X][j%Y] * 5 % MOD;<br>        even[i%X][j%Y] = even[i%X][j%Y] * 4 % MOD;<br>      }<br>    }<br>    <br>    REP(j,Y) REP(mask,(1&lt;&lt;X)){<br>      int tmp = __builtin_popcount(mask);<br>      if(tmp%2 == 0) continue;<br>      a[j][mask] = 1;<br>      REP(i,X) if(mask&amp;(1&lt;&lt;i)){<br>        a[j][mask] = a[j][mask] * odd[i][j] % MOD;<br>      } else {<br>        a[j][mask] = a[j][mask] * even[i][j] % MOD;<br>      }<br>    }<br>    <br>    dp[0][0] = 1;<br>    REP(i,Y) REP(mask,(1&lt;&lt;X)) REP(mask2,(1&lt;&lt;X)) dp[i+1][mask^mask2] = (dp[i+1][mask^mask2] + dp[i][mask] * a[i][mask2]) % MOD;<br>    <br>    ll ans = dp[Y][(1&lt;&lt;X)-1];<br>    return (int)ans;<br>  }<br><br>};<br><br><br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003]<br>// Powered by CodeProcessor<br></td>