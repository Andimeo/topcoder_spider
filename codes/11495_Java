<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import static java.lang.Math.*;<br>import static java.util.Arrays.*;<br><br>public class SRMChallengePhase {<br>  <br>  long M = 1000000007;<br>  <br>  long pow(long a, long b) {<br>    long res = 1;<br>    while (b &gt; 0) {<br>      if ((b &amp; 1) != 0) res = (res * a) % M;<br>      a = (a * a) % M;<br>      b &gt;&gt;&gt;= 1;<br>    }<br>    return res;<br>  }<br>  <br>  long fact(long n) {<br>    long res = 1;<br>    while (n &gt; 1) {<br>      res = (res * n--) % M;<br>    }<br>    return res;<br>  }<br>  <br>  public int countWays(String[] codersAttempted, String[] codersChallenged) {<br>    StringBuilder sb = new StringBuilder();<br>    for (String s : codersAttempted) sb.append(s);<br>    char[] attempt = sb.toString().toCharArray();<br>    sb = new StringBuilder();<br>    for (String s : codersChallenged) sb.append(s);<br>    char[] challenged = sb.toString().toCharArray();<br>    int N = attempt.length;<br>    int at = 0, ch = 0, both = 0;<br>    for (int i = 0; i &lt; N; i++) {<br>      if (attempt[i] == 'Y') at++;<br>      if (challenged[i] == 'Y') ch++;<br>      if (attempt[i] == 'Y' &amp;&amp; challenged[i] == 'Y') both++;<br>    }<br>    long[][] dp = new long[2][both + 1];<br>    dp[0][0] = 1;<br>    for (int i = 1; i &lt;= at; i++) {<br>      int I = i &amp; 1;<br>      fill(dp[I], 0);<br>      dp[I][0] = 1;<br>      for (int j = 0; j &lt; both; j++) {<br>        dp[I][j + 1] = (dp[1 - I][j + 1] + dp[1 - I][j] * (i - 1 - j)) % M;<br>      }<br>    }<br>    long res = dp[at &amp; 1][both];<br>    res = (res * fact(both)) % M;<br>    res = (res * fact(at - both)) % M;<br>    for (int i = 0; i &lt; ch - both; i++) {<br>      res = (res * (at - both - i)) % M;<br>    }<br>    res = (res * pow(N - 1, at - ch)) % M;<br>    return (int)(res % M);<br>  }<br>  <br>  void debug(Object...os) {<br>    System.err.println(deepToString(os));<br>  }<br>  <br>}<br></td>