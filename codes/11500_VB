<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Collections.Generic<br>Imports System.Text<br>Imports System.Math<br>Imports Weight = System.Int32<br>Public Class PerfectMemory<br>    Public Shared P As Integer<br>    Public Shared DP(2500, 2500) As Double<br>    '[\u19968][\u33268][\u12375][\u12383][\u20491][\u25968]<br>    '[\u12414][\u12384][\u19968][\u33268][\u12375][\u12390][\u12356][\u12394][\u12356][\u20491][\u25968]<br> <br>    Public Shared Function Solve(ByVal M As Integer, ByVal N As Integer) As Double<br>        If M = P Then<br>            Return 0<br>        End If<br>        If M &lt; 0 Or N &lt; 0 Then<br>            Return 0<br>        End If<br>        If N &gt; P * 2 Then<br>            Return 0<br>        End If<br>        If DP(N, M) &gt;= 0 Then Return DP(N, M)<br>        Solve = 0<br> <br>        Dim Kinds As Integer = (P - M) / 2 - N '[\u12414][\u12384][\u25458][\u12387][\u12390][\u12356][\u12394][\u12356][\u31278][\u39006]<br>        Dim All As Double = 1<br>        Dim Count As Integer = Kinds * 2 + N '[\u27531][\u12426][\u12398][\u20491][\u25968]<br> <br>        '[\u27425][\u12395][\u12417][\u12367][\u12387][\u12383][\u12418][\u12398][\u12364][\u65292][\u20170][\u36804][\u12417][\u12367][\u12387][\u12383][\u12418][\u12398][\u12395][\u19968][\u33268][\u12377][\u12427][\u30906][\u29575]<br>        Dim Q As Double = N / Count<br>        If Count &gt; P Then Return 0<br>        If Q &gt; 0.00000001 Then Solve = Q * (Solve(M + 2, N - 1) + 1)<br>        All -= Q<br>        '[\u27425][\u12398][\u27425][\u12395][\u12417][\u12367][\u12387][\u12383][\u12418][\u12398][\u12364][\u20170][\u36804][\u12417][\u12367][\u12387][\u12383][\u12418][\u12398][\u12395][\u19968][\u33268][\u12377][\u12427][\u30906][\u29575]<br>        Q = N / (Count - 1) * (Kinds * 2 / Count)<br>        If Q &gt; 0.00000001 And Count &gt;= 1 Then Solve += Q * (Solve(M + 2, N) + 2)<br>        All -= Q<br>        '[\u27425][\u12398][\u27425][\u12395][\u12417][\u12367][\u12387][\u12383][\u12418][\u12398][\u12364][\u27425][\u12395][\u12417][\u12367][\u12387][\u12383][\u12418][\u12398][\u12392][\u19968][\u33268][\u12377][\u12427][\u30906][\u29575]<br>        Q = Kinds * 2 / Count * 1 / (Count - 1)<br>        If Q &gt; 0.00000001 AndAlso Count &gt; 1 Then Solve += Q * (Solve(M + 2, N) + 1)<br>        All -= Q<br> <br>        '[\u20840][\u12367][\u20309][\u12418][\u12362][\u12365][\u12394][\u12356][\u22580][\u21512]<br>        If All &gt; 0.00000001 Then Solve += All * (Solve(M, N + 2) + 1)<br>        DP(N, M) = Solve<br>    End Function<br>    Public Function getExpectation(ByVal N As Integer, ByVal M As Integer) As Double<br>        Dim i As Integer, j As Integer<br>        For i = 0 To 2500<br>            For j = 0 To 2500<br>                DP(i, j) = -1<br>            Next<br>        Next<br>        P = N * M '[\u12371][\u12428][\u12364][\u21839][\u38988]?<br>        Return Solve(0, 0)<br> <br>    End Function<br> <br>End Class<br></td>