<td class="problemText" colspan="8" valign="middle" align="left">
            Imports System.Collections<br>Imports System.Collections.Generic<br>Imports System.Text<br><br>'Middle<br>Public Class EllysFractions<br>    Public Function getCount(ByVal N As Integer) As Long<br><br>        Dim result As Long = 0<br><br>        Dim primes() As Long = get_primes(N)<br><br>        Dim primes_combination As New Dictionary(Of Integer, Long)<br>        For i As Integer = 0 To primes.Length - 1<br>            Dim prime As Integer = primes(i)<br>            primes_combination(prime) = Math.Pow(2, i)<br>        Next<br>        Dim last_prime As Long = 0<br><br>        For i As Integer = 2 To N<br><br>            If primes_combination.ContainsKey(i) Then<br>                last_prime = i<br>            End If<br>            result += primes_combination(last_prime)<br><br>        Next<br><br>        Return result<br><br>    End Function<br>    Public Function get_primes(ByVal N As Integer) As Long()<br><br>        Dim result As New List(Of Long)<br><br>        For i As Integer = 2 To N<br><br>            Dim is_prime As Boolean = True<br>            For Each num As Integer In result<br>                If i Mod num = 0 Then<br>                    is_prime = False<br>                    Exit For<br>                End If<br>            Next<br><br>            If is_prime Then<br>                result.Add(i)<br>            End If<br>        Next<br><br>        Return result.ToArray<br><br>    End Function<br><br>End Class<br></td>