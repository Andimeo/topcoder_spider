<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br> <br>Public Class EllysDirectoryListing<br> <br>    Dim n As Integer<br> <br>    Function ListOk(ByVal files As String()) As Boolean<br>        Dim l1 As String = files(n)<br>        Dim l2 As String = files(n - 1)<br> <br>        Return (l1 = "." And l2 = "..") OrElse (l1 = ".." And l2 = ".")<br>    End Function<br> <br>    Public Function getFiles(ByVal files As String()) As String()<br>        n = files.GetUpperBound(0)<br>        Dim temp As String<br> <br>        If ListOk(files) Then Return files<br> <br>        For i As Integer = 0 To n<br>            If files(i) = "." Or files(i) = ".." Then<br>                'Swap with last<br>                temp = files(i)<br>                files(i) = files(n)<br>                files(n) = temp<br>                Exit For<br>            End If<br>        Next<br>        If Not ListOk(files) Then<br>            For i As Integer = 0 To n<br>                If files(i) = "." Or files(i) = ".." Then<br>                    'Swap with one before last<br>                    temp = files(i)<br>                    files(i) = files(n - 1)<br>                    files(n - 1) = temp<br>                    Exit For<br>                End If<br>            Next<br>        End If<br> <br>        Return files<br>    End Function<br>End Class<br></td>