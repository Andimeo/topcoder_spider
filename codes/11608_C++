<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt; <br>#include &lt;list&gt; <br>#include &lt;map&gt; <br>#include &lt;set&gt; <br>#include &lt;deque&gt; <br>#include &lt;vector&gt; <br>#include &lt;list&gt; <br>#include &lt;map&gt; <br>#include &lt;set&gt; <br>#include &lt;deque&gt; <br>#include &lt;queue&gt; <br>#include &lt;stack&gt; <br>#include &lt;bitset&gt; <br>#include &lt;algorithm&gt; <br>#include &lt;functional&gt; <br>#include &lt;numeric&gt; <br>#include &lt;utility&gt; <br>#include &lt;sstream&gt; <br>#include &lt;iostream&gt; <br>#include &lt;iomanip&gt; <br>#include &lt;cstdio&gt; <br>#include &lt;cmath&gt; <br>#include &lt;cstdlib&gt; <br>#include &lt;cctype&gt; <br>#include &lt;string&gt; <br>#include &lt;cstring&gt; <br>#include &lt;ctime&gt; <br><br>using namespace std;<br><br>#define mo 1000000009<br>#define _int64 long long<br><br>int c[60][60];<br><br>class AxonometricProjection<br>{<br>public:<br>_int64 po(int x,int y)<br>{<br>  int i,m;<br>  int a[100];<br>  _int64 ans;<br>  m=0;<br>  while (y&gt;0)<br>  {<br>    a[m]=y%2;<br>    y/=2;<br>    m++;<br>  }<br>  ans=1;<br>  for (i=m-1;i&gt;=0;i--)<br>  {<br>    ans=ans*ans%mo;<br>    if (a[i]==1) ans=ans*x%mo;<br>  }<br>  return ans;<br>}<br><br>int howManyWays(vector &lt;int&gt; l, vector &lt;int&gt; f)<br>{<br>  int i,j,k,o,p,remain1,remain2,cnt1,cnt2,all,tmp1,tmp2;<br>  _int64 tmp,tt;<br>  _int64 ans;<br>  vector&lt;pair&lt;int,int&gt; &gt; a;<br>  for (i=0;i&lt;60;i++)<br>  {<br>    c[i][0]=1;c[i][i]=1;<br>    for (j=1;j&lt;i;j++)<br>    {<br>      c[i][j]=c[i-1][j]+c[i-1][j-1];<br>      if (c[i][j]&gt;=mo) c[i][j]-=mo;<br>    }<br>  }<br>  a.clear();<br>  for (i=0;i&lt;l.size();i++)<br>    a.push_back(make_pair(l[i],0));<br>  for (i=0;i&lt;f.size();i++)<br>    a.push_back(make_pair(f[i],1));<br>  sort(a.begin(),a.end());<br>  remain1=l.size();<br>  remain2=f.size();<br>  ans=1;<br>  for (i=0;i&lt;a.size();i++)<br>    if ((i==0)||(a[i].first!=a[i-1].first))<br>    {<br>      cnt1=0;cnt2=0;<br>      for (j=i;j&lt;a.size();j++)<br>      {<br>        if (a[j].first!=a[i].first) break;<br>        if (a[j].second==0) cnt1++;<br>        else cnt2++;<br>      }<br>      if (a[i].first&gt;0)<br>      {<br>        tt=0;<br>        all=cnt1*remain2+cnt2*remain1-cnt1*cnt2;<br>        for (o=0;o&lt;=cnt1;o++)<br>          for (p=0;p&lt;=cnt2;p++)<br>          {<br>            tmp1=o*remain2+p*remain1-o*p;<br>            tmp2=all-tmp1;<br>            tmp=po(a[i].first,tmp1)*po(a[i].first+1,tmp2)%mo;<br>            tmp=tmp*c[cnt1][o]%mo;<br>            tmp=tmp*c[cnt2][p]%mo;<br>            if ((o+p)%2==0) tt+=tmp;<br>            else tt-=tmp;<br>            tt=(tt%mo+mo)%mo;<br>          }<br>        ans*=tt;<br>        ans%=mo;<br>      }<br>      remain1-=cnt1;<br>      remain2-=cnt2;<br>    }<br>  return ans;<br>}<br>};<br></td>