<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Collections.Generic<br>Imports System.Text<br>Imports System.Math<br>Imports Weight = System.Int32<br>Public Class DengklekMakingChains<br>    Public Function Calc(ByVal S As String) As Integer<br>        Calc = 0<br>        If S(0) &lt;&gt; "."c Then<br>            Calc = Max(Calc, Integer.Parse(S.Substring(0, 1)))<br>        End If<br>        If S(1) &lt;&gt; "."c Then<br>            Calc = Max(Calc, Integer.Parse(S.Substring(1, 1)))<br>        End If<br>        If S(2) &lt;&gt; "."c Then<br>            Calc = Max(Calc, Integer.Parse(S.Substring(2, 1)))<br>        End If<br>        If S(1) = "."c Then<br>            Exit Function<br>        End If<br>        Calc = Max(Calc, Get_Val(S(0)) + Get_Val(S(1)))<br>        Calc = Max(Calc, Get_Val(S(2)) + Get_Val(S(1)))<br> <br>    End Function<br>    Public Function Get_Val(ByVal v As Char) As Integer<br>        If v = "."c Then Return 0<br>        Return Integer.Parse(v.ToString)<br>    End Function<br> <br>    Public Function maxBeauty(ByVal chains As String()) As Integer<br>        Dim i As Integer, j As Integer<br>        Dim Ans As Integer = 0<br>        Dim N As Integer = chains.Length<br>        maxBeauty = 0<br> <br>        For i = 0 To N - 1<br>            maxBeauty = Max(maxBeauty, Calc(chains(i)))<br>        Next<br>        For i = 0 To N - 1<br>            If chains(i)(0) &lt;&gt; "."c AndAlso chains(i)(1) &lt;&gt; "."c AndAlso chains(i)(2) &lt;&gt; "."c Then<br>                Ans += Integer.Parse(chains(i).Substring(0, 1))<br>                Ans += Integer.Parse(chains(i).Substring(1, 1))<br>                Ans += Integer.Parse(chains(i).Substring(2, 1))<br>            End If<br>        Next<br> <br>        Dim M As Integer = 0<br>        For i = 0 To N - 1<br>            For j = 0 To N - 1<br>                If i = j Then Continue For<br>                Dim Left As Integer = 0, Right As Integer = 0<br>                If chains(i)(0) = "."c And chains(i)(2) &lt;&gt; "."c Then<br>                    Left = Max(Left, Get_Val(chains(i)(1)) + Get_Val(chains(i)(2)))<br>                End If<br>                If chains(i)(1) = "."c And chains(i)(2) &lt;&gt; "."c Then<br>                    Left = Max(Left, Get_Val(chains(i)(1)) + Get_Val(chains(i)(2)))<br>                End If<br>                If chains(j)(2) = "."c And chains(j)(0) &lt;&gt; "."c Then<br>                    Right = Max(Right, Get_Val(chains(j)(1)) + Get_Val(chains(j)(0)))<br>                End If<br>                If chains(j)(1) = "."c And chains(j)(0) &lt;&gt; "."c Then<br>                    Right = Max(Right, Get_Val(chains(j)(0)))<br>                End If<br>                M = Max(Left + Right, M)<br>            Next<br>        Next<br> <br>        Ans += +M<br>        maxBeauty = Max(maxBeauty, Ans)<br> <br>    End Function<br> <br>End Class<br></td>