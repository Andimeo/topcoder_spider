<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import static java.lang.Math.*;<br>import static java.util.Arrays.*;<br><br>public class FoxAndGreed {<br>  <br>  int M = 10007;<br>  <br>  public int count(int H, int W, int S) {<br>    if (H == 1 &amp;&amp; W == 1) {<br>      if (S &gt; 0) return 0;<br>      return 1;<br>    }<br>    int res = 0;<br>    int n = max(W, H) + 1;<br>    int[] pow = new int[n + 1];<br>    pow[0] = 1;<br>    for (int i = 0; i &lt; n; i++) pow[i + 1] = pow[i] * (S + 1) % M;<br>    int[][] dp1 = new int[n + 1][S + 1];<br>    dp1[0][0] = 1;<br>    for (int h = 0; h &lt; n; h++) {<br>      for (int s = 0; s &lt;= S; s++) {<br>        dp1[h + 1][s] = dp1[h][s];<br>        if (s &gt; 0) {<br>          dp1[h + 1][s] += dp1[h + 1][s - 1];<br>          if (dp1[h + 1][s] &gt;= M) dp1[h + 1][s] -= M;<br>        }<br>      }<br>    }<br>    if (W == 1) return dp1[H - 1][S];<br>    int[][] crt = new int[W][S + 1];<br>    crt[0][S] = 1;<br>    for (int y = 0; y &lt;= S &amp;&amp; y &lt; H - 1; y++) {<br>      int[][] next = new int[W][S + 1];<br>      for (int x = 0; x &lt; W - 1; x++) {<br>        int sum = 0, sumi = 0;<br>        for (int s = S; s &gt;= 0; s--) {<br>          sum += crt[x][s];<br>          if (sum &gt;= M) sum -= M;<br>          sumi = (sumi + crt[x][s] * s) % M;<br>          int tmp = sumi - sum * s % M;<br>          if (tmp &lt; 0) tmp += M;<br>          next[x][s] = tmp * pow[W - x - 2] % M;<br>          crt[x + 1][s] = (crt[x + 1][s] + (tmp + sum) % M * pow[H - y - 2]) % M;<br>        }<br>      }<br>      for (int s = 0; s &lt;= S; s++) {<br>        res = (res + crt[W - 1][s] * dp1[H - y - 1][s]) % M;<br>      }<br>      crt = next;<br>    }<br>    for (int x = 0; x &lt; W - 1; x++) {<br>      for (int s = 0; s &lt;= S; s++) {<br>        res = (res + crt[x][s] * dp1[W - x - 1][s]) % M;<br>      }<br>    }<br>    debug(res);<br>    return res;<br>  }<br>  <br>  void debug(Object...os) {<br>    System.err.println(deepToString(os));<br>  }<br>  <br>}<br></td>