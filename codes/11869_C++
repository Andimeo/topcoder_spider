<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;deque&gt;<br>#include &lt;stack&gt;<br>#include &lt;bitset&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;sstream&gt;<br>#include &lt;iostream&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;queue&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;cstring&gt;<br>#include &lt;ctime&gt;<br>#include &lt;string&gt;<br>#include &lt;cassert&gt;<br><br>using namespace std;<br><br>//----------------------zjut_DD for Topcoder-------------------------------<br>typedef long long LL;<br>typedef pair&lt;int,int&gt; PII;<br>typedef vector&lt;int&gt; VI;<br>typedef vector&lt;string&gt; VS;<br>#define PB push_back<br>#define MP make_pair<br>#define ff first<br>#define ss second<br>#define two(w) (1&lt;&lt;(w))<br>#define test(x,w) (x&amp;two(w))<br>#define sz(v) (int)v.size()<br>#define all(c) c.begin(),c.end() <br>#define clr(buf,val) memset(buf,val,sizeof(buf))<br>#define rep(i,l,r) for(int i=(l);i&lt;(r);i++)<br>#define repv(i,v)  for(int i=0;i&lt;(int)v.size();i++)<br>#define repi(it,c) for(typeof(c.begin()) it=c.begin();it!=c.end();++it)<br>//------------------------------------------------------------------------<br><br><br>class KingdomAndPassword {<br>public:<br>  long long newPassword(long long oldPassword, vector &lt;int&gt; restrictedDigits);<br>};<br><br><br>map&lt;VI, LL&gt; mp;<br>LL old;<br>VI res;<br><br>bool better(LL x1, LL x2, LL old){<br>  //if( x2==-1 ) return true;<br>  if( abs(x1-old) != abs(x2-old) ) <br>    return abs(x1-old) &lt; abs(x2-old);<br>  return x1 &lt; x2;<br>}<br><br>LL dfs(VI v){<br>  if( mp.find(v)!=mp.end() ) return mp[v];<br>  <br>  int num=0;<br>  rep(i, 1, 10){<br>    num+=v[i];<br>  }<br>  if( num==0 ) return 0;<br>  LL mul=1;<br>  rep(i, 1, num) mul*=10;<br>  int w=old/mul%10;<br>  //v[0]=0 [\u31561][\u20110]<br>  //v[0]=1 [\u23567][\u20110]<br>  //v[0]=2 [\u22823][\u20110]<br>  LL ret=-1;<br>  rep(i, 1, 10)if( v[i] &amp;&amp; res[sz(res)-num]!=i ) {<br>    //if( sz(res)&lt;4 ) printf("num=%d i=%d\n", num, i);<br>    VI tmp=v;<br>    tmp[i]--;<br>    if( v[0]==0 ){<br>      if( i&lt;w ) tmp[0]=1;<br>      if( i&gt;w ) tmp[0]=2;<br>    }<br>    LL ans=dfs(tmp);<br>    if( ans!=-1 ) {<br>      ans+=mul*i;<br>      if( ret==-1 ) ret=ans;<br>      else if( v[0]==0 &amp;&amp; better(ans, ret, old%(mul*10)) ) ret=ans;<br>      else if( v[0]==1 &amp;&amp; ans&gt;ret ) ret=ans;<br>      else if( v[0]==2 &amp;&amp; ans&lt;ret ) ret=ans;<br>    }<br>  }<br>  return mp[v]=ret;<br>}<br><br>long long KingdomAndPassword::newPassword(long long old, vector &lt;int&gt; res) {<br>  mp.clear();<br>  ::old=old;<br>  ::res=res;<br>  VI v(10, 0);<br>  while( old ){<br>    v[old%10]++;<br>    old/=10;<br>  }<br>  return dfs(v);<br>}<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>// Powered by FileEdit<br>// Powered by moj 4.17 [modified TZTester]<br>// Powered by CodeProcessor<br></td>