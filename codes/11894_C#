<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Collections.Generic;<br>using System.Collections.Specialized;<br>using System.Text;<br>using System.Text.RegularExpressions;<br> <br> <br>public class SwitchesAndLamps<br>{<br>  public int theMin(string[] switches, string[] lamps)<br>  {<br>        Dictionary&lt;string, swlamp&gt; swCount = new Dictionary&lt;string, swlamp&gt;();<br>        for (int i = 0; i &lt; switches[0].Length; i++)<br>        {<br>            StringBuilder sb = new StringBuilder();<br>            for (int j = 0; j &lt; switches.Length; j++)<br>            {<br>                sb.Append(switches[j][i]);<br>            }<br>            string sres = sb.ToString();<br>            if (!swCount.ContainsKey(sres))<br>            {<br>                swCount.Add(sres,new swlamp());<br>            }<br>            swCount[sres].switchCount++;<br>        }<br> <br>        for (int i = 0; i &lt; switches[0].Length; i++)<br>        {<br>            StringBuilder sb = new StringBuilder();<br>            for (int j = 0; j &lt; switches.Length; j++)<br>            {<br>                sb.Append(lamps[j][i]);<br>            }<br>            string sres = sb.ToString();<br>            if (!swCount.ContainsKey(sres))<br>            {<br>                swCount.Add(sres, new swlamp());<br>            }<br>            swCount[sres].lampCount++;<br>        }<br> <br>        int max = 0;<br>        foreach (swlamp res in swCount.Values)<br>        {<br>            if (res.switchCount != res.lampCount)<br>            {<br>                return -1;<br>            }<br>            max = Math.Max(max, res.switchCount);<br>        }<br> <br>        if (max == 1) return 0;<br>        if (max &lt;= 2) return 1;<br>        if (max &lt;= 4) return 2;<br>        if (max &lt;= 8) return 3;<br>        if (max &lt;= 16) return 4;<br>        if (max &lt;= 32) return 5;<br>        return 6;<br>    }<br> <br>    private class swlamp<br>    {<br>        public int switchCount;<br>        public int lampCount;<br>    }<br> <br> <br>}<br>//Powered by KawigiEdit 2.1.4 (beta) modified by pivanof!<br></td>