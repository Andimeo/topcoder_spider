<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class PatrolRoute<br>    Private Const modulo as long = 1000000007<br>    Public Function countRoutes(ByVal X As Integer, ByVal Y As Integer, ByVal minT As Integer, ByVal maxT As Integer) As Integer<br>        Return _countRoutes(X, Y, minT, maxT)<br>    End Function<br> <br>    Private Function _countRoutes(ByVal X As Integer, ByVal Y As Integer, ByVal minT As Integer, ByVal maxT As Integer) As Long<br>        Dim x_dist As Long() = distdist(X)<br>        Dim y_dist As Long() = distdist(Y)<br>        For i As Integer = 0 To x_dist.GetUpperBound(0)<br>            For j As Integer = 0 To y_dist.GetUpperBound(0)<br>                If inrange(minT, (i + j) * 2, maxT) Then<br>                    _countRoutes = (_countRoutes + x_dist(i) * y_dist(j)) Mod modulo<br>                End If<br>            Next<br>        Next<br>        _countRoutes = _countRoutes * 6 Mod modulo<br>    End Function<br> <br>    Private Function inrange(ByVal min As Integer, ByVal val As Integer, ByVal max As Integer) As Boolean<br>        Return min &lt;= val AndAlso val &lt;= max<br>    End Function<br> <br>    Private Function distdist(ByVal n As Integer) As Long() ' (half) distance distribution. return(i) = number of choice <br>        Dim ret(n - 1) As Long<br>        For i As Integer = 2 To n - 1 ' distance of leftmost and rightmost<br>            ret(i) = (i - 1) * (n - i)<br>        Next<br>        Return ret<br>    End Function<br> <br>End Class<br></td>