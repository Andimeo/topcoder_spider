<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br>Imports System.Collections.Generic<br>Imports System.Math<br> <br>Public Class CheckerExpansion<br>    Public Function comb(ByVal n As Long, ByVal m As Long) As Long<br>        'wikipedia[\u12424][\u12426] [\u20598][\u22855][\u12398][\u12415][\u12434][\u36820][\u12377]<br>        Dim t As Long = 1L &lt;&lt; 60<br>        Do While t &gt; 0<br>            If t &lt;= m Then<br>                If t &lt;= n Then<br>                    n -= t<br>                    m -= t<br>                Else<br>                    Return 0<br>                End If<br>            Else<br>                If t &lt;= n Then<br>                    n -= t<br>                End If<br>            End If<br>            t = t &gt;&gt; 1<br>        Loop<br>        Return 1<br>    End Function<br>    Public Function Solve(ByVal t As Long, ByVal x As Long, ByVal y As Long) As Char<br>        Dim Par As Long = x + y<br>        If Par Mod 2 = 1 Then<br>            Return "."c<br>        End If<br>        Par \= 2<br>        If Par &gt; t Then<br>            Return "."c<br>        End If<br>        If y &gt; x Then<br>            Return "."c<br>        End If<br>        Dim m As Long = Par * 2 - x<br>        If comb(Par, m) = 1 Then<br>            If Par Mod 2 = 0 Then<br>                Return "A"c<br>            Else<br>                Return "B"c<br>            End If<br>        End If<br>        Return "."c<br>    End Function<br>    Public Function resultAfter(ByVal t As Long, ByVal x0 As Long, ByVal y0 As Long, ByVal w As Integer, ByVal h As Integer) As String()<br>        Dim i As Long, j As Long<br>        Dim Ret As String() = New String(h - 1) {}<br>        resultAfter = Ret<br>        t -= 1<br>        For i = 0 To h - 1<br>            Ret(i) = ""<br>            For j = 0 To w - 1<br>                Ret(i) += solve(t, x0 + j, y0 + h - i - 1)<br>            Next<br>        Next<br>    End Function<br>End Class<br></td>