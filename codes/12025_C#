<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Collections.Generic;<br>using System.Collections.Specialized;<br>using System.Text;<br>using System.Text.RegularExpressions;<br> <br> <br>public class StrIIRec<br>{<br>  public string recovstr(int n, int a, string s)<br>  {<br>    return f(n, a, s);<br>  }<br>  <br>  string f(int n, int a, string s)<br>  {<br>    bool[] b = new bool[n];<br>    int c = 0;<br>    for(int i=0; i&lt;s.Length; i++)<br>    {<br>      b[s[i] - 'a'] = true;<br>      for(int j=i+1; j&lt;s.Length; j++)<br>      {<br>        if(s[i] &gt; s[j])<br>          c++;<br>      }<br>    }<br>    int lack = 0;<br>    for(int i=0; i&lt;n; i++)<br>    {<br>      if(!b[i])<br>        lack++;<br>      else<br>      {<br>        c += lack;<br>      }<br>    }<br>    int max = c + (n - s.Length) * (n - s.Length - 1) / 2;<br>    if(c &gt;= a)<br>      return s + g(n, b, 0, n - s.Length);    <br>    if(a &lt;= max)<br>    {<br>      return s + g(n, b, a - c, n - s.Length);<br>    }<br>    if(s.Length &gt;= 1)<br>      return f(n, a, s.Substring(0, s.Length - 1));<br>    return "";<br>  }<br>  <br>  string g(int n, bool[] b, int a, int m)<br>  {<br>    if(m == 0)<br>      return "";<br>    int lack = 0;<br>    for(int i=0; i&lt;n; i++)<br>    {<br>      if(!b[i])<br>      {<br>        char c = (char)(i + 'a');<br>        if(m == 1)<br>          return c + "";<br>        if(lack &gt;= a)<br>        {<br>          b[i] = true;<br>          return c + g(n, b, 0, m - 1);<br>        }<br>        if(a &lt;= lack + (m - 1) * (m - 2) / 2)<br>        {<br>          b[i] = true;<br>          return c + g(n, b, a - lack, m - 1);<br>        }        <br>        lack ++;<br>      }<br>    }<br>    return "";<br>  }<br> <br> <br>}<br>//Powered by KawigiEdit 2.1.4 (beta) modified by pivanof!<br></td>