<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br>Imports System.Collections.Generic<br>Imports System.Math<br> <br>Public Class KleofasTail<br>    Public Function match(ByVal l1 As Long, ByVal r1 As Long, ByVal l2 As Long, ByVal r2 As Long) As Long<br>        If l1 &lt;= l2 AndAlso r2 &lt;= r1 Then<br>            Return r2 - l2<br>        End If<br>        If r2 &lt;= l1 OrElse r1 &lt;= l2 Then<br>            Return 0<br>        End If<br>        Return Min(r2, r1) - Max(l1, l2)<br>    End Function<br>    Public Function countGoodSequences(ByVal K As Long, ByVal A As Long, ByVal B As Long) As Long<br>        Dim i As Integer, j As Integer<br>        Dim l As Long, r As Long<br>        If K = 0 Then<br>            Return B - A + 1<br>        End If<br>        l = K<br>        r = K + 1<br>        If K Mod 2 = 0 Then<br>            r += 1<br>        End If<br>        countGoodSequences = 0<br>        Do Until (l &gt; B)<br>            countGoodSequences += match(l, r, A, B + 1)<br>            l *= 2<br>            r *= 2<br>        Loop<br> <br>    End Function<br>End Class<br></td>