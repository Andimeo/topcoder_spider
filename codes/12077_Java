<td class="problemText" colspan="8" valign="middle" align="left">
            /**<br> * Built using CHelper plug-in<br> * Actual solution is at the top<br> */<br>public class RectangularSum {<br>    long[] primes;<br>    int[] pows;<br>    long height;<br>    long width;<br>    int num;<br>    long s;<br>    <br>    public long minimalArea(int height, int width, long S) {<br>        long res = Long.MAX_VALUE;<br>        long prod = 2 * S;<br>        primes = new long[1000];<br>        pows = new int[1000];<br>        num = 0;<br>        s = S;<br>        this.height = height;<br>        this.width = width;<br>        for (long i = 2; i * i &lt;= prod; ++i) {<br>            if (prod % i == 0) {<br>                primes[num] = i;<br>                while (prod % i == 0) {<br>                    prod /= i;<br>                    ++pows[num];<br>                }<br>                ++num;<br>            }<br>        }<br>        if (prod &gt; 1) {<br>            primes[num] = prod;<br>            pows[num] = 1;<br>            ++num;<br>        }<br>        res = rec(0, 1L, 1L);<br>        if (res == Long.MAX_VALUE) res = -1;<br>        return res;<br>    }<br> <br>    private long rec(int at, long h, long w) {<br>        if (at &gt;= num) {<br>            return doit2(h, w);<br>        }<br>        int maxPow = pows[at];<br>        long what = primes[at];<br>        long nh = h;<br>        long res = Long.MAX_VALUE;<br>        for (int ph = 0; ph &lt;= maxPow; ++ph) {<br>            long nw = w;<br>            for (int pw = 0; pw + ph &lt;= maxPow; ++pw) {<br>                res = Math.min(res, rec(at + 1, nh, nw));<br>                nw *= what;<br>            }<br>            nh *= what;<br>        }<br>        return res;<br>    }<br> <br>    private long doit2(long h, long w) {<br>        long rem = s * 2 / h / w - (w - 1) - width * (h - 1);<br>        if (rem % 2 == 0 &amp;&amp; rem &gt;= 0) {<br>            long first = rem / 2;<br>            long row = first / width;<br>            long col = first % width;<br>            if (row + h &lt;= height &amp;&amp; col + w &lt;= width)<br>                return h * w;<br>        }<br>        return Long.MAX_VALUE;<br>    }<br>}<br> <br> <br> <br>// Powered by FileEdit<br>// Powered by moj 4.16 [modified TZTester]<br>// Powered by CodeProcessor<br></td>