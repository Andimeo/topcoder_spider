<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br>Imports System.Collections.Generic<br>Imports System.Math<br> <br>Public Class XorBoard<br> <br>    Public Shared Function Mod_Pow(ByVal a As Long, ByVal n As Long, ByVal M As Long) As Long<br>        If n = 0 Then Return 1 Mod M<br>        Dim Res As Long = Mod_Pow((a * a) Mod M, Int(n / 2), M)<br>        If N And 1 Then Res = (Res * a) Mod M<br>        Return Res<br>    End Function<br>    Public Const MOD_V As Long = 555555555<br>    Public H As Integer, W As Integer, RCount As Integer, CCount As Integer, S As Integer<br>    Public Function FlipedCount(ByVal r As Integer, ByVal c As Integer) As Integer<br>        Dim ret As Integer = r * W<br>        ret += c * H<br>        ret -= 2 * r * c<br>        Return ret<br>    End Function<br>    Public Comb(3502, 3502) As Integer<br> <br>    Public Function Solve(ByVal flipCount As Integer, ByVal Count As Integer, ByVal Size As Integer) As Long<br>        If flipCount &lt; Count Then<br>            Return 0<br>        End If<br>        Dim ret As Long = Comb(Size, Count)<br>        flipCount -= Count<br>        If (flipCount Mod 2) &lt;&gt; 0 Then<br>            Return 0<br>        End If<br>        flipCount = flipCount \ 2<br> <br>        Return (ret * Comb(Size + flipCount - 1, flipCount)) Mod MOD_V<br> <br>    End Function<br>    Public Function count(ByVal _H As Integer, ByVal _W As Integer, ByVal _Rcount As Integer, ByVal _Ccount As Integer, ByVal _S As Integer) As Integer<br>        Dim i As Integer, j As Integer, k As Integer<br> <br>        For i = 0 To 3502<br>            For j = 0 To 3502<br>                Comb(i, j) = 0<br>            Next<br>        Next<br> <br>        Comb(0, 0) = 1<br>        For i = 0 To 3500<br>            For j = 0 To i<br>                Comb(i + 1, j) = (Comb(i + 1, j) + Comb(i, j)) Mod MOD_V<br>                Comb(i + 1, j + 1) = (Comb(i + 1, j + 1) + Comb(i, j)) Mod MOD_V<br>            Next<br>        Next<br>        ' [\u23550][\u31216][\u24615][\u12434][\u29992][\u12356][\u12427]<br>        H = _H<br>        W = _W<br>        RCount = _Rcount<br>        CCount = _Ccount<br>        S = _S<br>        Dim res As Long = 0<br>        count = 0<br>        For r As Integer = 0 To H<br>            For c As Integer = 0 To W<br>                If FlipedCount(r, c) = S Then<br>                    res = (res + Solve(RCount, r, H) * Solve(CCount, c, W)) Mod MOD_V<br>                End If<br>                count = res<br>            Next<br>        Next<br>        Exit Function<br> <br>        Return Comb(H + W, H)<br>    End Function<br>End Class<br></td>