<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class UniqueTriangles<br>    Public Function howMany(ByVal x As Integer(), ByVal y As Integer()) As Integer<br>        Dim a, b, c As Integer<br>        Dim n As Integer = x.Length<br>        Dim buf(2) As Long<br>        Dim ret As New SortedList<br>        For a = 0 To n - 1<br>            For b = a + 1 To n - 1<br>                For c = b + 1 To n - 1<br>                    Dim l1, l2, l3 As Long<br>                    l1 = (x(a) - x(b)) * (x(a) - x(b)) + (y(a) - y(b)) * (y(a) - y(b))<br>                    l2 = (x(a) - x(c)) * (x(a) - x(c)) + (y(a) - y(c)) * (y(a) - y(c))<br>                    l3 = (x(c) - x(b)) * (x(c) - x(b)) + (y(c) - y(b)) * (y(c) - y(b))<br>                    'colinear test<br>                    Dim dx1 As Integer = x(b) - x(a)<br>                    Dim dy1 As Integer = y(b) - y(a)<br>                    Dim dx2 As Integer = x(c) - x(a)<br>                    Dim dy2 As Integer = y(c) - y(a)<br>                    Dim d As Long = dx1 * dy2 - dx2 * dy1<br>                    If d &lt;&gt; 0 Then<br>                        Dim g As Long = GCD(l1, l2)<br>                        g = GCD(g, l3)<br>                        buf(0) = l1 / g<br>                        buf(1) = l2 / g<br>                        buf(2) = l3 / g<br>                        Array.Sort(buf)<br>                        Dim str As String = buf(0).ToString &amp; "-" &amp; buf(1).ToString &amp; "-" &amp; buf(2).ToString<br>                        ret(str) = True<br>                    End If<br>                Next<br>            Next<br>        Next<br>        Return ret.Count<br>    End Function<br> <br>    Public Function GCD(ByVal a As Long, ByVal b As Long) As Long<br>        Dim c As Long = a Mod b<br>        While c &lt;&gt; 0<br>            a = b<br>            b = c<br>            c = a Mod b<br>        End While<br>        Return b<br>    End Function<br>End Class<br></td>