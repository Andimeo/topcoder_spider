<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt;<br>#include &lt;list&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;deque&gt;<br>#include &lt;stack&gt;<br>#include &lt;bitset&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;functional&gt;<br>#include &lt;numeric&gt;<br>#include &lt;utility&gt;<br>#include &lt;sstream&gt;<br>#include &lt;iostream&gt;<br>#include &lt;iomanip&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;ctime&gt;<br> <br>#define MOD 1000000009<br> <br>using namespace std;<br> <br>class CharacterBoard2 {<br>public:<br>  int countGenerators(vector &lt;string&gt;, int, int, int);<br>};<br> <br>typedef long long LL;<br> <br>int in[10005];<br>int R, C;<br> <br>int CharacterBoard2::countGenerators(vector &lt;string&gt; fragment, int W, int i0, int j0) {<br>  R = fragment.size();<br>  C = fragment[0].size();<br>  LL ans = 0;<br>  for(int i = 1; i &lt;= W; i++ ){<br>    for(int j = 0; j &lt; i; j++ )<br>      in[j] = 0;<br>    int good = 1;<br>    for(int p1 = 0; p1 &lt; R &amp;&amp; good; p1++ ){<br>      for(int p2 = 0; p2 &lt; C; p2++ ){<br>        int ii = p1 + i0;<br>        int jj = p2 + j0;<br>        int c = fragment[p1][p2];<br>        int ind = W * ii + jj;<br>        if(in[ind % i] == 0)<br>          in[ind % i] = c;<br>        else if(in[ind % i] != c){<br>          good = 0;<br>          break;<br>        }<br>      }<br>    }<br>    if(good == 0) continue;<br>    LL temp = 1;<br>    for(int j = 0; j &lt; i; j++ ){<br>      if(in[j] == 0){<br>        temp *= 26LL;<br>        temp %= MOD;<br>      }<br>    }<br>    ans = (ans + temp) % MOD;<br>  }<br>  return ans;<br>}<br> <br> <br>//Powered by [KawigiEdit] 2.0!<br></td>