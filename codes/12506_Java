<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.Arrays;<br> <br>/**<br> * Built using CHelper plug-in<br> * Actual solution is at the top<br> */<br>public class CharacterBoard2 {<br>    final long MOD = (long)(1e9 + 9);<br>    long mod(long n){ return (n % MOD + MOD) % MOD; }<br>    long modPow(long a, long b)<br>    {<br>        long ret = 1;<br> <br>        while ( b &gt; 0 )<br>        {<br>            if ((b &amp; 1) == 1) ret = mod(ret * a);<br>            a = mod(a * a);<br>            b &gt;&gt;= 1;<br>        }<br> <br>        return ret;<br>    }<br>    public int countGenerators(String[] fragment, int W, int i0, int j0) {<br>        long ans = 0;<br> <br>        int n = fragment.length;<br>        int m = fragment[0].length();<br> <br>        int[] S = new int[ W ];<br>        for (int k=1; k&lt;=W; k++)<br>        {<br>            Arrays.fill(S, 0, k, '?');<br>            boolean ok = true;<br>            long cnt = modPow( 26, k );<br>            long inv = modPow(26, MOD - 2);<br>            for (int i=0; i&lt;n; i++)<br>            {<br>                for (int j=0; j&lt;m; j++)<br>                {<br>                    int r = i0 + i;<br>                    int c = j0 + j;<br>                    int x = (r*W + c) % k;<br>                    if ( S[x] == '?' )<br>                    {<br>                        S[x] = fragment[i].charAt(j);<br>                        cnt = mod(cnt * inv);<br>                    }<br>                    else if ( S[x] != fragment[i].charAt(j) ) ok = false;<br>                }<br>            }<br>            if ( ok ) ans = mod(ans + cnt);<br>        }<br> <br>        return (int)ans;<br>    }<br>}<br></td>