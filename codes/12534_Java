<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.Comparator;<br>import java.util.Random;<br>import java.util.Map;<br>import java.util.List;<br>import java.util.Arrays;<br>import java.util.AbstractSet;<br>import java.util.ArrayList;<br>import java.util.Set;<br>import java.util.Iterator;<br>import java.util.AbstractMap;<br>import java.util.NoSuchElementException;<br>import java.math.BigInteger;<br> <br>/**<br> * Built using CHelper plug-in<br> * Actual solution is at the top<br> * @author Egor Kulikov (egor@egork.net)<br> */<br>public class WolfInZooDivOne {<br>  long[][] answer;<br>  int N;<br>  int[] left, right;<br>  static final long MOD = (long) (1e9 + 7);<br> <br>    public int count(int N, String[] L, String[] R) {<br>    this.N = N;<br>    left = process(L);<br>    right = process(R);<br>    answer = new long[N + 1][N + 1];<br>    ArrayUtils.fill(answer, -1);<br>    return (int) go(-1, -1);<br>    }<br> <br>  private long go(int current, int last) {<br>    if (answer[current + 1][last + 1] != -1)<br>      return answer[current + 1][last + 1];<br>    long result = 1;<br>    int next = current + 1;<br>    for (int i = 0; i &lt; left.length; i++) {<br>      if (left[i] &lt;= last &amp;&amp; right[i] &gt;= current)<br>        next = Math.max(next, right[i] + 1);<br>    }<br>    for (int i = next; i &lt; N; i++)<br>      result += go(i, current);<br>    return answer[current + 1][last + 1] = result % MOD;<br>  }<br> <br>  private int[] process(String[] strings) {<br>    String s = StringUtils.unite(strings);<br>    String[] tokens = s.split(" ");<br>    int[] result = new int[tokens.length];<br>    for (int i = 0; i &lt; tokens.length; i++)<br>      result[i] = Integer.parseInt(tokens[i]);<br>    return result;<br>  }<br>}<br> <br>class ArrayUtils {<br> <br>  public static void fill(long[][] array, long value) {<br>    for (long[] row : array)<br>      Arrays.fill(row, value);<br>  }<br> <br>  }<br> <br>class StringUtils {<br> <br>  public static String unite(String[] array) {<br>    StringBuilder result = new StringBuilder();<br>    for (String s : array) {<br>      result.append(s);<br>    }<br>    return result.toString();<br>  }<br> <br>  }<br> <br>interface IntComparator {<br>    public static final IntComparator DEFAULT = new IntComparator() {<br>        public int compare(int first, int second) {<br>            if (first &lt; second)<br>                return -1;<br>            if (first &gt; second)<br>                return 1;<br>            return 0;<br>        }<br>    };<br> <br>  public int compare(int first, int second);<br>}<br> <br>abstract class IntList extends IntCollection implements Comparable&lt;IntList&gt; {<br>  private static final int INSERTION_THRESHOLD = 8;<br> <br>  public abstract int get(int index);<br>  public abstract void set(int index, int value);<br> <br>  public IntIterator iterator() {<br>    return new IntIterator() {<br>      private int size = size();<br>      private int index = 0;<br> <br>      public int value() throws NoSuchElementException {<br>        if (!isValid())<br>          throw new NoSuchElementException();<br>        return get(index);<br>      }<br> <br>      public void advance() throws NoSuchElementException {<br>        if (!isValid())<br>          throw new NoSuchElementException();<br>        index++;<br>      }<br> <br>      public boolean isValid() {<br>        return index &lt; size;<br>      }<br>    };<br>  }<br> <br>  private void swap(int first, int second) {<br>    if (first == second)<br>      return;<br>    int temp = get(first);<br>    set(first, get(second));<br>    set(second, temp);<br>  }<br> <br>  public IntSortedList inPlaceSort(IntComparator comparator) {<br>    quickSort(0, size() - 1, size(), comparator);<br>    return new IntSortedArray(this, comparator);<br>  }<br> <br>  private void quickSort(int from, int to, int remaining, IntComparator comparator) {<br>    if (to - from &lt; INSERTION_THRESHOLD) {<br>      insertionSort(from, to, comparator);<br>      return;<br>    }<br>    if (remaining == 0) {<br>      heapSort(from, to, comparator);<br>      return;<br>    }<br>    remaining &gt;&gt;= 1;<br>    int pivotIndex = (from + to) &gt;&gt; 1;<br>    int pivot = get(pivotIndex);<br>    swap(pivotIndex, to);<br>    int storeIndex = from;<br>    int equalIndex = to;<br>    for (int i = from; i &lt; equalIndex; i++) {<br>      int value = comparator.compare(get(i), pivot);<br>      if (value &lt; 0)<br>        swap(storeIndex++, i);<br>      else if (value == 0)<br>        swap(--equalIndex, i--);<br>    }<br>    quickSort(from, storeIndex - 1, remaining, comparator);<br>    for (int i = equalIndex; i &lt;= to; i++)<br>      swap(storeIndex++, i);<br>    quickSort(storeIndex, to, remaining, comparator);<br>  }<br> <br>  private void heapSort(int from, int to, IntComparator comparator) {<br>    for (int i = (to + from - 1) &gt;&gt; 1; i &gt;= from; i--)<br>      siftDown(i, to, comparator, from);<br>    for (int i = to; i &gt; from; i--) {<br>      swap(from, i);<br>      siftDown(from, i - 1, comparator, from);<br>    }<br>  }<br> <br>  private void siftDown(int start, int end, IntComparator comparator, int delta) {<br>    int value = get(start);<br>    while (true) {<br>      int child = ((start - delta) &lt;&lt; 1) + 1 + delta;<br>      if (child &gt; end)<br>        return;<br>      int childValue = get(child);<br>      if (child + 1 &lt;= end) {<br>        int otherValue = get(child + 1);<br>        if (comparator.compare(otherValue, childValue) &gt; 0) {<br>          child++;<br>          childValue = otherValue;<br>        }<br>      }<br>      if (comparator.compare(value, childValue) &gt;= 0)<br>        return;<br>      swap(start, child);<br>      start = child;<br>    }<br>  }<br> <br>  private void insertionSort(int from, int to, IntComparator comparator) {<br>    for (int i = from + 1; i &lt;= to; i++) {<br>      int value = get(i);<br>      for (int j = i - 1; j &gt;= from; j--) {<br>        if (comparator.compare(get(j), value) &lt;= 0)<br>          break;<br>        swap(j, j + 1);<br>      }<br>    }<br>  }<br> <br>  public IntSortedList sort(IntComparator comparator) {<br>    return new IntArray(this).inPlaceSort(comparator);<br>  }<br> <br>  public int hashCode() {<br>    int hashCode = 1;<br>    for (IntIterator i = iterator(); i.isValid(); i.advance())<br>      hashCode = 31 * hashCode + i.value();<br>    return hashCode;<br>  }<br> <br>  public boolean equals(Object obj) {<br>    if (!(obj instanceof IntList))<br>      return false;<br>    IntList list = (IntList)obj;<br>    if (list.size() != size())<br>      return false;<br>    IntIterator i = iterator();<br>    IntIterator j = list.iterator();<br>    while (i.isValid()) {<br>      if (i.value() != j.value())<br>        return false;<br>      i.advance();<br>      j.advance();<br>    }<br>    return true;<br>  }<br> <br>  public int compareTo(IntList o) {<br>    IntIterator i = iterator();<br>    IntIterator j = o.iterator();<br>    while (true) {<br>      if (i.isValid()) {<br>        if (j.isValid()) {<br>          if (i.value() != j.value()) {<br>            if (i.value() &lt; j.value())<br>              return -1;<br>            else<br>              return 1;<br>          }<br>        } else<br>          return 1;<br>      } else {<br>        if (j.isValid())<br>          return -1;<br>        else<br>          return 0;<br>      }<br>      i.advance();<br>      j.advance();<br>    }<br>  }<br> <br>  }<br> <br>abstract class IntCollection {<br>  public abstract IntIterator iterator();<br>  public abstract int size();<br> <br>  }<br> <br>interface IntIterator {<br>  public int value() throws NoSuchElementException;<br>  /*<br>   * @throws NoSuchElementException only if iterator already invalid<br>   */<br>  public void advance() throws NoSuchElementException;<br>  public boolean isValid();<br>}<br> <br>abstract class IntSortedList extends IntList {<br>  protected final IntComparator comparator;<br> <br>  protected IntSortedList(IntComparator comparator) {<br>    this.comparator = comparator;<br>  }<br> <br>  public void set(int index, int value) {<br>    throw new UnsupportedOperationException();<br>  }<br> <br>  public IntSortedList inPlaceSort(IntComparator comparator) {<br>    if (comparator == this.comparator)<br>      return this;<br>    throw new UnsupportedOperationException();<br>  }<br> <br>  public IntSortedList sort(IntComparator comparator) {<br>    if (comparator == this.comparator)<br>      return this;<br>    return super.sort(comparator);<br>  }<br> <br>  protected void ensureSorted() {<br>    int size = size();<br>    if (size == 0)<br>      return;<br>    int last = get(0);<br>    for (int i = 1; i &lt; size; i++) {<br>      int current = get(i);<br>      if (comparator.compare(last, current) &gt; 0)<br>        throw new IllegalArgumentException();<br>      last = current;<br>    }<br>  }<br> <br>  }<br> <br>class IntSortedArray extends IntSortedList {<br>  private final int[] array;<br> <br>  public IntSortedArray(int[] array) {<br>    this(array, IntComparator.DEFAULT);<br>  }<br> <br>  public IntSortedArray(IntCollection collection) {<br>    this(collection, IntComparator.DEFAULT);<br>  }<br> <br>  public IntSortedArray(int[] array, IntComparator comparator) {<br>    super(comparator);<br>    this.array = array;<br>    ensureSorted();<br>  }<br> <br>  public IntSortedArray(IntCollection collection, IntComparator comparator) {<br>    super(comparator);<br>    array = new int[collection.size()];<br>    int i = 0;<br>    for (IntIterator iterator = collection.iterator(); iterator.isValid(); iterator.advance())<br>      array[i++] = iterator.value();<br>    ensureSorted();<br>  }<br> <br>  public int get(int index) {<br>    return array[index];<br>  }<br> <br>  public int size() {<br>    return array.length;<br>  }<br>}<br> <br>class IntArray extends IntList {<br>  private final int[] array;<br> <br>  public IntArray(int[] array) {<br>    this.array = array;<br>  }<br> <br>  public IntArray(IntCollection collection) {<br>    array = new int[collection.size()];<br>    int i = 0;<br>    for (IntIterator iterator = collection.iterator(); iterator.isValid(); iterator.advance())<br>      array[i++] = iterator.value();<br>  }<br> <br>  public int get(int index) {<br>    return array[index];<br>  }<br> <br>  public void set(int index, int value) {<br>    array[index] = value;<br>  }<br> <br>  public int size() {<br>    return array.length;<br>  }<br> <br>  }<br></td>