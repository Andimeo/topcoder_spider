<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.util.regex.*;<br>import java.text.*;<br>import java.math.*;<br>import java.awt.geom.*;<br> <br>public class YetAnotherBoardGame<br>{<br>  int n;<br>  int m;<br>  int ret;<br>  int[][] a;<br>  int[] ex;<br>  int[] ey;<br>  void toggle(int x, int y, int type)<br>  {<br>    if (x &gt; 0)<br>      a[x - 1][y] ^= 1;<br>    if (x &lt; n - 1)<br>      a[x + 1][y] ^= 1;<br>    if (y &gt; 0)<br>      a[x][y - 1] ^= 1;<br>    if (y &lt; m - 1)<br>      a[x][y + 1] ^= 1;<br>    if (type == 1) a[x][y] ^= 1;<br>  }<br>  void brute_force(int used)<br>  {<br>    if (ret &gt;= 0 &amp;&amp; used &gt;= ret)<br>      return;<br>    for (int x = 0; x &lt; n; ++x)<br>      for (int y = 0; y &lt; m; ++y)<br>        if (a[x][y] == 1)<br>        {<br>          x++;<br>          if (x &gt;= n) return;<br>          int old_ex = ex[x];<br>          int old_ey = ey[y];<br>          if (ex[x] &lt; 0 &amp;&amp; ey[y] &lt; 0)<br>            for (int type = 0; type &lt; 2; ++type)<br>            {<br>              toggle(x, y, type);<br>              ex[x] = ey[y] = type;<br>              brute_force(used + 1);<br>              toggle(x, y, type);            <br>            }<br>          else<br>          {<br>            if (ex[x] &gt;= 0 &amp;&amp; ey[y] &gt;= 0 &amp;&amp; ex[x] != ey[y])<br>              return;<br>            int type = ex[x] &lt; 0 ? ey[y] : ex[x];<br>            toggle(x, y, type);<br>            ex[x] = ey[y] = type;<br>            brute_force(used + 1);<br>            toggle(x, y, type);<br>          }<br>          ex[x] = old_ex;<br>          ey[y] = old_ey;<br>          return;<br>        }<br>    if (ret &lt; 0 || used &lt; ret)<br>      ret = used;<br>  }<br>  public int minimumMoves(String[] board)<br>  {<br>    n = board.length;<br>    m = board[0].length();<br>    ret = -1;<br>    a = new int[n][m];<br>    for (int i = 0; i &lt; n; ++i)<br>      for (int j = 0; j &lt; m; ++j)<br>        a[i][j] = board[i].charAt(j) == 'W' ? 1 : 0;<br>    ex = new int[n];<br>    ey = new int[m];<br>    Arrays.fill(ex, -1);<br>    Arrays.fill(ey, -1);<br>    for (int type = 0; type &lt; 2; ++type)<br>      for (int mask = 0; mask &lt; (1 &lt;&lt; m); ++mask)<br>      {<br>        int used = 0;<br>        for (int i = 0; i &lt; m; ++i)<br>          if ((mask &amp; (1 &lt;&lt; i)) &gt; 0)<br>          {<br>            ex[0] = ey[i] = type;<br>            toggle(0, i, type);<br>            ++used;<br>          }<br>        brute_force(used);<br>        for (int i = 0; i &lt; m; ++i)<br>          if ((mask &amp; (1 &lt;&lt; i)) &gt; 0)<br>          {<br>            ex[0] = ey[i] = -1;<br>            toggle(0, i, type);<br>          }<br>      }<br>    return ret;<br>  }<br>}<br></td>