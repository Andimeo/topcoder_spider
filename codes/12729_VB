<td class="problemText" colspan="8" valign="middle" align="left">
            Option Infer On<br>Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections.Generic<br>Imports System.Text<br> <br>Public Class GearsDiv1<br>    Dim g As Long()<br>    Dim mis As Long<br>    Dim n As Integer<br>    Dim table(63) As Integer<br>    Public Function pcnt(ByVal v As Long) As Integer<br>        pcnt = 0<br>        While v &gt; 0<br>            v = v And (v - 1)<br>            pcnt += 1<br>        End While<br>    End Function<br>    Public Function ctz(ByVal v As Long) As Integer<br>        For i = 0 To 63<br>            If (v &gt;&gt; i) And 1 Then<br>                Return i<br>            End If<br>        Next<br>        return 64<br>    End Function<br>    Public Sub dfs(ByVal choosed As Long, ByVal removed As Long)<br>        Dim k = -1<br>        Dim remained As Long = (Not removed) And ((1L &lt;&lt; n) - 1)<br>        While remained &lt;&gt; 0<br>            Dim i = ctz(remained)<br>            If pcnt(g(i) And (Not removed)) &lt;= 1 Then<br>                k = i<br>                Exit While<br>            End If<br>            If k = -1 OrElse (pcnt(g(i) And (Not removed)) &gt; pcnt(g(k) And (Not removed))) Then<br>                k = i<br>            End If<br>            remained = remained And (remained - 1)<br>        End While<br>        If k = -1 Then<br>            mis = Math.Min(mis, n - pcnt(choosed))<br>            Return<br>        End If<br>        If pcnt(g(k) And (Not removed)) &gt;= 2 Then<br>            dfs(choosed, removed Or (1L &lt;&lt; k))<br>        End If<br>        dfs(choosed Or (1L &lt;&lt; k), removed Or (1L &lt;&lt; k) Or g(k))<br>    End Sub<br>    Public Function getmin(ByVal color As String, ByVal graph As String()) As Integer<br>        ' [\u22855][\u38281][\u36335][\u12434][\u21547][\u12414][\u12394][\u12356][\u8594]2[\u37096][\u12464][\u12521][\u12501][\u12391][\u12354][\u12427]<br>        ' [\u20108][\u37096][\u12464][\u12521][\u12501][\u12398][\u20316][\u12426][\u26041][\u12399]3[\u36890][\u12426]<br>        ' [\u12381][\u12428][\u12382][\u12428][\u12395][\u12388][\u12356][\u12390][\u29420][\u31435][\u38598][\u21512][\u12434][\u27714][\u12417][\u12427]<br>        Dim LC As String() = New String() {"RG", "RB", "GB"}<br>        getmin = color.Length<br> <br>        Dim hash As ULong = &amp;H3F566ED27179461UL<br>        For i = 0 To 63<br>            table(hash &gt;&gt; 58) = i<br>            hash &lt;&lt;= 1<br>        Next<br> <br>        For Each L In LC<br>            Dim v As New List(Of Integer)<br>            Dim t As New List(Of Integer)<br> <br>            For i = 0 To color.Length - 1<br>                If L.Contains(color(i)) Then<br>                    t.Add(v.Count)<br>                    v.Add(i)<br>                End If<br>            Next<br>            n = t.Count<br>            g = New Long(n) {}<br>            mis = 999<br>            For i = 0 To v.Count - 1<br>                For j = 0 To v.Count - 1<br>                    If graph(v(i))(v(j)) = "Y"c Then<br>                        g(i) = g(i) Or (1L &lt;&lt; j)<br>                    End If<br>                Next<br>                g(i) = g(i) Or (1L &lt;&lt; i)<br>            Next<br> <br>            dfs(0, 0)<br>            getmin = Math.Min(getmin, mis)<br>        Next<br>    End Function<br> <br>End Class<br></td>