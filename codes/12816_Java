<td class="problemText" colspan="8" valign="middle" align="left">
            /**<br> * Built using CHelper plug-in<br> * Actual solution is at the top<br> */<br>public class GoodNumbers {<br>    int N;<br> <br>    public int count(int[] a, int[] b, int N) {<br>        int[] all = new int[a.length + b.length];<br>        this.N = N;<br>        System.arraycopy(a, 0, all, 0, a.length);<br>        System.arraycopy(b, 0, all, a.length, b.length);<br>        int[] count = new int[1 &lt;&lt; all.length];<br>        recFill(count, all, 0, 0, 1);<br>        for (int what = 0; what &lt; all.length; ++what) {<br>            for (int set = 0; set &lt; count.length; ++set)<br>                if ((set &amp; (1 &lt;&lt; what)) == 0)<br>                    count[set] -= count[set | (1 &lt;&lt; what)];<br>        }<br>        int res = 0;<br>        for (int set = 0; set &lt; count.length; ++set) {<br>            for (int i = 0; i &lt; a.length; ++i) {<br>                if ((set &amp; (1 &lt;&lt; i)) != 0 &amp;&amp; (set &amp; (1 &lt;&lt; (i + a.length))) == 0) {<br>                    res += count[set];<br>                    break;<br>                }<br>            }<br>        }<br>        return res;<br>    }<br> <br>    private void recFill(int[] count, int[] all, int mask, int at, int lcm) {<br>        if (lcm &gt; N) return;<br>        if (at &gt;= all.length) {<br>            count[mask] = (N / lcm);<br>            return;<br>        }<br>        recFill(count, all, mask, at + 1, lcm);<br>        long g = gcd(lcm, all[at]);<br>        long nlcm = (lcm / g) * all[at];<br>        if (nlcm &gt; N) return;<br>        recFill(count, all, mask | (1 &lt;&lt; at), at + 1, (int) nlcm);<br>    }<br> <br>    private int gcd(int a, int b) {<br>        while (b &gt; 0) {<br>            int t = a % b;<br>            a = b;<br>            b = t;<br>        }<br>        return a;<br>    }<br>}<br></td>