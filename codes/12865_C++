<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;iostream&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;vector&gt;<br>#include &lt;cmath&gt;<br>#include &lt;memory.h&gt;<br>#include &lt;string&gt;<br>#include &lt;set&gt;<br>#include &lt;queue&gt;<br>#include &lt;map&gt;<br>#include &lt;iomanip&gt;<br>#include &lt;sstream&gt;<br>#include &lt;stack&gt;<br>#include &lt;ctime&gt;<br>using namespace std;<br>#define forn(i,n) for(int i=0;i&lt;(n);++i)<br>#define forv(i,v) forn(i,(int)(v).size())<br>#define INF 1000000000<br>#define LINF 1000000000000000000LL<br>#define DINF 1e200<br>#define all(v) (v).begin(),(v).end()<br>#define pb push_back<br>#define mp make_pair<br>#define lng long long<br>#define sqr(a) ((a)*(a))<br>#define PI 3.14159265359<br>#define PII pair&lt;int,int&gt; <br>#define PLL pair&lt;lng,lng&gt; <br>#define PDD pair&lt;double,double&gt; <br>#define X first<br>#define Y second<br>#define sz(v) ((int)(v).size())<br>#define clr(ar,val) memset(ar, val, sizeof(ar))<br>typedef unsigned int uint;<br>typedef unsigned lng ulng;<br> <br>class WinterAndShopping{public:int getNumber(vector &lt;int&gt; first, vector &lt;int&gt; red, vector &lt;int&gt; green, vector &lt;int&gt; blue);};<br> <br>const lng mod=INF+7;<br>lng C[600][600];<br>lng dp[55][110][110];<br> <br>struct seg{<br>  int p,a,b,c;<br>  bool operator&lt;(const seg &amp;s)const{<br>    return p&lt;s.p;<br>  }<br>  bool in(const seg &amp;s)const{<br>    return p&gt;=s.p &amp;&amp; p+a+b+c&lt;=s.p+s.a+s.b+s.c;<br>  }<br>  bool sub(const seg &amp;s){<br>    a-=s.a;<br>    b-=s.b;<br>    c-=s.c;<br>    return a&gt;=0 &amp;&amp; b&gt;=0 &amp;&amp; c&gt;=0;<br>  }<br>  lng ans()const{<br>    return C[a+b+c][a+b]*C[a+b][a]%mod;<br>  }<br>  int end()const{<br>    return p+a+b+c;<br>  }<br>};<br> <br>int WinterAndShopping::getNumber(vector &lt;int&gt; PP, vector &lt;int&gt; AA, vector &lt;int&gt; BB, vector &lt;int&gt; CC) {<br>  forn(i,600){<br>    C[i][0]=C[i][i]=1;<br>    for(int j=1;j&lt;i;++j)<br>      C[i][j]=(C[i-1][j-1]+C[i-1][j])%mod;<br>  }<br>  vector&lt;seg&gt; V;<br>  forv(i,PP){<br>    V.pb((seg){PP[i],AA[i],BB[i],CC[i]});<br>  }<br>  lng ans=1;<br>  while(true){<br>    bool found=false;<br>    forv(i,V){<br>      forv(j,V){<br>        if(i==j)<br>          continue;<br>        if(V[j].in(V[i])){<br>          if(!V[i].sub(V[j]))<br>            return 0;<br>          forv(k,V){<br>            if(V[k].p&gt;V[j].p)<br>              V[k].p-=V[j].a+V[j].b+V[j].c;<br>          }<br>          (ans*=V[j].ans())%=mod;<br>          V.erase(V.begin()+j);<br>          found=true;<br>          break;<br>        }<br>      }<br>      if(found)<br>        break;<br>    }<br>    if(!found)<br>      break;<br>  }<br>  V.pb((seg){-1000,0,0,0});<br>  V.pb((seg){1000,0,0,0});<br>  sort(all(V));<br>  clr(dp,0);<br>  dp[1][0][0]=1;<br>  for(int i=1;i+1&lt;sz(V);++i){<br>    int d1=max(0,V[i-1].end()-V[i].p);<br>    int d2=max(0,V[i].end()-V[i+1].p);<br>    for(int a1=0;a1&lt;=d1 &amp;&amp; a1&lt;=V[i-1].a &amp;&amp; a1&lt;=V[i].a;++a1){<br>      for(int b1=0;a1+b1&lt;=d1 &amp;&amp; b1&lt;=V[i-1].b &amp;&amp; b1&lt;=V[i].b;++b1){<br>        if(!dp[i][a1][b1])<br>          continue;<br>        int c1=d1-a1-b1;<br>        if(c1&gt;V[i-1].c || c1&gt;V[i].c)<br>          continue;<br>        for(int a2=0;a2&lt;=d2 &amp;&amp; a1+a2&lt;=V[i].a &amp;&amp; a2&lt;=V[i+1].a;++a2){<br>          for(int b2=0;a2+b2&lt;=d2 &amp;&amp; b1+b2&lt;=V[i].b &amp;&amp; b2&lt;=V[i+1].b;++b2){<br>            int c2=d2-a2-b2;<br>            if(c1+c2&gt;V[i].c || c2&gt;V[i+1].c)<br>              continue;<br>            (dp[i+1][a2][b2]+=dp[i][a1][b1]*((seg){0,a2,b2,c2}).ans()%mod*((seg){0,V[i].a-a1-a2,V[i].b-b1-b2,V[i].c-c1-c2}).ans())%=mod;<br>          }<br>        }<br>      }<br>    }<br>  }<br>  return ans*dp[sz(V)-1][0][0]%mod;<br>}<br> <br> <br> <br> <br> <br> <br>// Powered by FileEdit<br>// Powered by moj 4.17 [modified TZTester]<br>// Powered by CodeProcessor<br></td>