<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Collections.Generic;<br>using System.Collections.Specialized;<br>using System.Text;<br>using System.Text.RegularExpressions;<br> <br>public class SimilarNames2<br>{<br> private long[,] matr;<br>    private long n;<br>    private bool[] isUsed;<br>    private string[] Names;<br>    private int l;<br> <br> <br>    public String[] SortList(String[] names)<br>    {<br>        for (var i = 0; i &lt; names.Length; i++)<br>        {<br>            for (var j=i+1;j&lt;names.Length;j++)<br>            {<br>                if (names[i].StartsWith(names[j]))<br>                {<br>                    var t = names[i];<br>                    names[i] = names[j];<br>                    names[j] = t;<br>                }<br>            }<br>        }<br>        return names;<br>    }<br>  public int count(string[] names, int L)<br>  {<br>      l = L;<br>      var nList = new List&lt;String&gt;(names);<br>      Names = SortList(names);<br>      n = names.Length;<br>      isUsed = new bool[n];<br>        matr = new long[n,n];<br>    for(var i=0;i&lt;n;i++)<br>    {<br>        matr[i, 0] = 1;<br>    }<br> <br>        for(var i=0;i&lt;n;i++)<br>        {<br>            if (isUsed[i])<br>            {<br>                continue;<br>            }<br>            isUsed[i] = true;<br>            GoRec(i);<br>        }<br> <br>      long sum = 0;<br>        for(var i=0;i&lt;n;i++)<br>        {<br>            sum += matr[i, l - 1];<br>        }<br>      sum %= divR;<br> <br>      long tt = 1;<br>      for (var j = l; j &lt; n; j++)<br>      {<br>          tt *= (long)(n - j );<br>          tt %= divR;<br>      }<br>      return (int)((sum*tt)%divR);<br>  }<br> <br>    private long divR = 1000000007;<br>    private void GoRec(int i)<br>    {<br>        for (var k = 1; k &lt; l; k++)<br>        {<br>            matr[i, k] = 0;<br>            for (var j = 0; j &lt; i; j++)<br>            {<br>                if (Names[i].StartsWith(Names[j]))<br>                {<br>                    matr[i, k] = (matr[i,k]+matr[j, k - 1])%divR;<br>                }<br>            }<br>        }<br>    }<br> <br> <br>}<br>//Powered by [KawigiEdit] 2.0!<br></td>