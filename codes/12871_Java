<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br> <br>public class SimilarNames2 {<br>    public final long MODULO = 1000000007l;<br>    // TODO MODULO<br>    long[][] prod(long[][] a, long[][] b) {<br>        int n = a.length;<br>        long[][] res = new long[n][n];<br>        for (int i = 0; i &lt; n; i++) {<br>            for (int j = 0; j &lt; n; j++) {<br>                for (int k = 0; k &lt; n; k++) {<br>                    res[i][j] += a[i][k] * b[k][j];<br>                    res[i][j] %= MODULO;<br>                }<br>            }<br>        }<br>        return res;<br>    }<br> <br>  public int count(String[] names, int L) {<br>        int n = names.length;<br>        long[][] g = new long[n][n];<br>        for (int i = 0; i &lt; n; i++) {<br>            for (int j = 0; j &lt; n; j++) {<br>                if (i != j) {<br>                    if (names[i].startsWith(names[j])) {<br>                        g[j][i] = 1;<br>                    }<br>                }<br>            }<br>        }<br> <br>        long[][] cur = new long[n][n];<br>        for (int i = 0; i &lt; n; i++) {<br>            cur[i][i] = 1;<br>        }<br>        int len = L - 1;  // TODO<br>        for (int i = 0; i &lt; len; i++) {<br>            cur = prod(cur, g);<br>        }<br>        int left = n - (len + 1);<br>        long ans = 0;<br>        for (int i = 0; i &lt; n; i++) {<br>            for (int j = 0; j &lt; n; j++) {<br>                ans += cur[i][j];<br>                ans %= MODULO;<br>            }<br>        }<br>        for (int i = 1; i &lt;= left; i++) {<br>            ans *= i;<br>            ans %= MODULO;<br>        }<br>    return (int)ans;<br>  }<br>}<br></td>