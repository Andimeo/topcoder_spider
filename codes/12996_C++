<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;algorithm&gt;  <br>#include &lt;string&gt;  <br>#include &lt;set&gt;  <br>#include &lt;map&gt;  <br>#include &lt;vector&gt;  <br>#include &lt;queue&gt;   <br>#include &lt;iostream&gt;  <br>#include &lt;iterator&gt;  <br>#include &lt;math.h&gt;  <br>#include &lt;cstdio&gt;  <br>#include &lt;cstdlib&gt;  <br>#include &lt;sstream&gt;  <br>#include &lt;ctime&gt;<br>#include &lt;cfloat&gt;<br>#include &lt;memory.h&gt;<br><br>#pragma comment(linker, "/STACK:60777216")  <br><br>using namespace std;  <br><br>typedef pair&lt;int,int&gt; pii;  <br>typedef long long ll;  <br>typedef vector&lt;int&gt; vi;  <br>typedef pair&lt;double,double&gt; pdd;<br><br>#define UN(v) SORT(v),v.erase(unique(v.begin(),v.end()),v.end())  <br>#define SORT(c) sort((c).begin(),(c).end())  <br>#define FOR(i,a,b) for (int  i=(a); i &lt; (b); i++)   <br>#define REP(i,n) FOR(i,0,n)   <br>#define CL(a,b) memset(a,b,sizeof(a))  <br>#define pb push_back  <br><br>const int mod = 1000000007;<br><br>ll d[222][55][55];<br>ll t[55][55];<br>ll cnk[222][222];<br>ll f[222];<br><br>void addV(ll &amp;x, ll y){x=(x+y)%mod;}<br><br>class TaroCheckers {<br>public:<br>  int getNumber(vector &lt;int&gt; l, vector &lt;int&gt; r, int m) {<br>    REP(i,222){<br>      cnk[i][i]=cnk[i][0]=1;<br>      FOR(j,1,i){<br>        cnk[i][j]=(cnk[i-1][j]+cnk[i-1][j-1])%mod;<br>      }<br>    }<br>    f[0]=1;<br>    FOR(i,1,222)f[i]=f[i-1]*i%mod;<br>    int n = l.size();<br>    CL(d,0);<br>    d[0][0][0]=1;<br>    for(int i=0;i&lt;m;i++){<br>      CL(t,0);<br>      for(int a1=0;a1&lt;=n;a1++){<br>        for(int a2=0;a2&lt;=n;a2++){<br>          ll c = d[i][a1][a2];<br>          if(!c) continue;<br>          // t1<br>          addV(t[a1+1][a2], d[i][a1][a2]);<br>          // t2<br>          int num2 = 0;<br>          REP(k,n)if(i&gt;=m-r[k]) num2++;<br>          addV(t[a1][a2+1], d[i][a1][a2]*(num2-a2));<br>          // t3<br>          int num3 = 0;<br>          REP(k,n)if(i&gt;=l[k] &amp;&amp; i&lt;m-r[k])num3++;<br>          addV(t[a1][a2], d[i][a1][a2]*(num3+1));<br>        }<br>      }<br>      for(int a1=0;a1&lt;=n;a1++){<br>        for(int a2=0;a2&lt;=n;a2++){<br>          int num1 = 0;<br>          REP(k,n)if(i+1==l[k])num1++;<br>          if(a1&gt;=num1){<br>            addV(d[i+1][a1-num1][a2],t[a1][a2]*cnk[a1][num1]%mod*f[num1]%mod);<br>          }<br>        }<br>      }<br>    }<br>    return d[m][0][n]%mod;<br>  }<br>};<br><br><br><br>// Powered by FileEdit<br>// Powered by moj 4.17 [modified TZTester]<br>// Powered by CodeProcessor<br></td>