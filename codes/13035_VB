<td class="problemText" colspan="8" valign="middle" align="left">
            Imports System.Collections.Generic<br>Imports System.Math<br> <br>Public Class TheMatrix<br>    Public Function MaxArea(ByVal board As String()) As Integer<br>        Return Max(getMaxArea(IndefiniteSum(board, True)), getmaxarea(IndefiniteSum(board, False)))<br>    End Function<br> <br>    Private Function getMaxArea(sum As Integer(,))<br>        Dim h As Integer = sum.GetLength(0) - 1<br>        Dim w As Integer = sum.GetLength(1) - 1<br>        getMaxArea = 0<br>        For x0 As Integer = 0 To h<br>            For x1 As Integer = x0 To h<br>                For y0 As Integer = 0 To w<br>                    For y1 As Integer = y0 To w<br>                        Dim area = (x1 - x0) * (y1 - y0)<br>                        If area &lt; getMaxArea Then Continue For<br>                        If DefiniteSum(sum, x0, x1, y0, y1) &lt; area Then exit For<br>                        getMaxArea = area<br>                    Next<br>                Next<br>            Next<br>        Next<br>    End Function<br> <br>    Private Function match(cell As Char, x As Integer, y As Integer, parity As Boolean)<br>        If (cell = "1"c) Xor CBool((x + y) And 1) Xor parity Then Return 1 Else Return 0<br>    End Function<br> <br>    Private Function IndefiniteSum(ByVal board As String(), parity As Boolean) As Integer(,)<br>        Dim sum(board.Length, board(0).Length) As Integer<br>        For i = 0 To board.Length - 1<br>            For j = 0 To board(i).Length - 1<br>                sum(i + 1, j + 1) = sum(i, j + 1) + match(board(i)(j), i, j, parity)<br>            Next<br>        Next<br>        For i As Integer = 0 To board.Length - 1<br>            For j = 0 To board(i).Length - 1<br>                sum(i + 1, j + 1) = sum(i + 1, j + 1) + sum(i + 1, j)<br>            Next<br>        Next<br> <br>        Return sum<br>    End Function<br> <br>    Private Function DefiniteSum(sum As Integer(,), x0 As Integer, x1 As Integer, y0 As Integer, y1 As Integer) As Integer<br>        'System.Console.WriteLine("definitesum({0}, {1}, {2}, {3}) = {4}", x0, x1, y0, y1, sum(x0, y0) + sum(x1, y1) - sum(x0, y1) - sum(x1, y0))<br>        Return sum(x0, y0) + sum(x1, y1) - sum(x0, y1) - sum(x1, y0)<br>    End Function<br> <br>End Class<br></td>