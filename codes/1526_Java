<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>public class Macros {<br>  String s;<br>  String[] r;<br>  <br>  String[][] table;<br>  <br>  String recurse(int left, int right) {<br>    if (left&gt;=right) System.out.println("huh?");<br>    if (table[left][right]==null) {<br>      if (right==left+1) {<br>        table[left][right]=""+s.charAt(left);<br>      } else {<br>        StringBuffer here = new StringBuffer();<br>        for (int mid=left+1; mid&lt;right; mid++) {<br>          String pleft = recurse(left,mid);<br>          String pright = recurse(mid, right);<br>          <br>          for (int i=0; i&lt;r.length; i++) {<br>            if ((pleft.indexOf(r[i].charAt(2))&gt;=0)&amp;&amp;(pright.indexOf(r[i].charAt(3))&gt;=0)) {<br>              if (here.indexOf(""+r[i].charAt(0))&lt;0)<br>                here.append(r[i].charAt(0));<br>            }<br>          }<br>        }<br>        table[left][right] = here.toString();<br>      }<br>    }<br>    <br>    return table[left][right];<br>  }<br>  <br>  public String[] whichOnes(String[] rules, String output) {<br>    s=output;<br>    r=rules;<br>    <br>    table = new String[s.length()+1][s.length()+1];<br>    <br>    String p = recurse(0, output.length());<br>    <br>    String res = "";<br>    for (char c='A'; c&lt;='Z'; c++) {<br>      if (p.indexOf(c)&gt;=0) res = res+c;<br>    }<br>    <br>    String[] r2 = new String[res.length()];<br>    for (int i=0; i&lt;res.length(); i++) r2[i]=""+res.charAt(i);<br>    return r2;<br>  }<br>}<br> <br>// Powered by PopsEdit<br></td>