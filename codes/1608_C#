<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br> <br>  public class Quilting<br>  {<br>    public Quilting()<br>    {<br>    }<br> <br>    int[] dX = {0,-1,0,1};<br>    int[] dY = {-1,0,1,0};<br>    int curX,curY,d,curD;<br> <br>    int minX,maxX,minY,maxY;<br>    int length, width;<br>    int[,] table = new int[400,400];<br>    int[] used;<br>    int count;<br> <br>    bool hasNext() <br>    {<br>      if(table[curX+dX[d],curY+dY[d]]==0) <br>      {<br>        curD = d;<br>        d++; if(d&gt;=dX.Length) d-=dX.Length;<br>      }<br>      curX += dX[curD];<br>      curY += dY[curD];<br>      minX = Math.Min(minX,curX);<br>      maxX = Math.Max(maxX,curX);<br>      minY = Math.Min(minY,curY);<br>      maxY = Math.Max(maxY,curY);<br>      if(maxX-minX &gt;=width) return false;<br>      if(maxY-minY &gt;=length) return false;<br>      return true;<br>    }<br> <br>    public int best() <br>    {<br>      int[] local = new int[count];<br>      for(int x=-1;x&lt;=1;x++) <br>        for(int y=-1;y&lt;=1;y++) <br>          local[table[curX+x,curY+y]]++;<br>      int b = 1;<br>      for(int c=1;c&lt;count;c++) <br>      {<br>        if(local[c]&lt;local[b]) <br>        {<br>          b = c;<br>        }<br>        if(local[c]==local[b] &amp;&amp; used[c]&lt;used[b]) <br>        {<br>          b = c;<br>        }<br>      }<br>      return b;<br>    }<br> <br>    public string lastPatch(int l, int w, string[] colorList) <br>    {<br>      count = colorList.Length+1;<br>      used = new int[count];<br>      for(int i=0;i&lt;used.Length;i++) used[i] = 0;<br>      for(int i=0;i&lt;table.GetLength(0);i++)<br>        for(int ii=0;ii&lt;table.GetLength(1);ii++)<br>          table[i,ii] = 0;<br>      length = l;<br>      width = w;<br>      maxX = 200;<br>      minX = 200;<br>      minY = 200;<br>      maxY = 200;<br>      curX = 200;<br>      curY = 200;<br>      curD = 0;<br>      int b = 0;<br>      do <br>      {<br>        b = best();<br>        used[b]++;<br>        table[curX,curY] = b;<br>        //Console.WriteLine("{0}:{1} = {2}",curX,curY,b);<br>      } while(hasNext());<br>      return colorList[b-1];<br>    }<br> <br>  }<br></td>