<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class TickTick<br>    Public Function count(ByVal events As String()) As Integer<br>        Dim diff(events.Length - 1) As Decimal<br>        Dim frac(events.Length - 1) As Decimal<br>        Dim off(events.Length) As Decimal<br>        Dim a As Integer<br>        For a = 0 To events.Length - 1<br>            diff(a) = events(a)<br>            frac(a) = diff(a) - Int(diff(a))<br>        Next<br>        Array.Sort(frac)<br>        off(0) = frac(0) / 2<br>        For a = 1 To events.Length - 1<br>            off(a) = frac(a - 1) + 0.5D * (frac(a) - frac(a - 1))<br>        Next<br>        off(events.Length) = frac(events.Length - 1) + 0.5D * (1D - frac(events.Length - 1))<br>        Dim ret As New ArrayList<br>        For a = 0 To events.Length<br>            Dim s As String = doit(diff, off(a))<br>            If Not ret.Contains(s) Then ret.Add(s)<br>        Next<br>        Return ret.Count<br>    End Function<br> <br>    Private Function doit(ByVal diff() As Decimal, ByVal off As Decimal) As String<br>        Dim c As Decimal = 0<br>        Dim a As Integer<br>        Dim ret As String<br>        For a = 0 To diff.Length - 1<br>            If Int(diff(a) - off) = Int(c - off) Then<br>                ret &amp;= "S"<br>            Else<br>                ret &amp;= "D"<br>            End If<br>            c = diff(a)<br>        Next<br>        Return ret<br>    End Function<br>End Class<br></td>