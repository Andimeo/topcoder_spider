<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br> <br>Public Class ContinuedFractions<br>    Private Structure pair<br>        Dim d, m As Integer<br>        Public Sub New(ByVal nd As Integer, ByVal nm As Integer)<br>            d = nd<br>            m = nm<br>        End Sub<br>    End Structure<br>    Public Function squareRoot(ByVal n As Integer) As Integer()<br>        Dim out As New ArrayList<br>        Dim used As New ArrayList<br>        Dim v As Integer<br>        Dim sn As Double = Sqrt(n)<br>        v = Floor(sn)<br>        out.Add(v)<br>        Dim c As pair<br>        c.d = v<br>        c.m = 1<br>        used.Add(c)<br>        Do<br>            Dim mm As Integer = (n - c.d * c.d) \ c.m<br>            v = Floor((sn + c.d) / mm)<br>            out.Add(v)<br>            c.d = -(c.d - v * mm)<br>            c.m = mm<br>            If used.Contains(c) Then Return out.ToArray(GetType(Integer))<br>        Loop<br>    End Function<br>End Class<br></td>