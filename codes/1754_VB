<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br> <br>Public Class UserId<br>    Public Function id(ByVal inUse As String(), ByVal first As String, ByVal middle As String, ByVal last As String) As String<br>        If Not modify(first) Then Return "BAD DATA"<br>        If Not modify(middle) Then Return "BAD DATA"<br>        If Not modify(last) Then Return "BAD DATA"<br>        If first.Length &lt; 2 Then Return "BAD DATA"<br>        If last.Length &lt; 2 Then Return "BAD DATA"<br>        Dim username As String<br>        Dim list As New ArrayList(inUse)<br>        username = (first.Chars(0) &amp; last)<br>        If username.Length &gt; 8 Then username = username.Substring(0, 8)<br>        If Not list.Contains(username) Then Return username<br>        If Not middle Is Nothing AndAlso middle.Length &gt; 0 Then<br>            username = (first.Chars(0) &amp; middle.Chars(0) &amp; last)<br>            If username.Length &gt; 8 Then username = username.Substring(0, 8)<br>            If Not list.Contains(username) Then Return username<br>        End If<br>        Dim a As Integer<br>        For a = 1 To 99<br>            username = (first.Chars(0) &amp; last)<br>            If username.Length &gt; 6 Then username = username.Substring(0, 6)<br>            username &amp;= a.ToString("00")<br>            If Not list.Contains(username) Then Return username<br>        Next<br>    End Function<br> <br>    Private Function modify(ByRef name As String) As Boolean<br>        name = name.Replace("'", "")<br>        name = name.Replace(" ", "")<br>        name = name.ToLower<br>        Dim a As Integer<br>        For a = 0 To name.Length - 1<br>            If Not (AscW(name.Chars(a)) &gt;= AscW("a"c) AndAlso AscW(name.Chars(a)) &lt;= AscW("z"c)) Then<br>                Return False<br>            End If<br>        Next<br>        Return True<br>    End Function<br>End Class<br></td>