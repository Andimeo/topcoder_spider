<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class HardDequeSort<br>        Dim aMin(,) As Integer<br>        Dim aMax(,) As Integer<br>        Public Function minDeques(ByVal data As Integer()) As Integer<br>            Dim i, j, k, l As Long<br> <br>            Dim aNodes As New System.Collections.SortedList<br> <br>            For i = 0 To data.GetUpperBound(0)<br>                If Not aNodes.ContainsKey(data(i)) Then aNodes.Add(data(i), Nothing)<br>            Next<br> <br>            ReDim aMin(aNodes.Count - 1, aNodes.Count - 1)<br>            ReDim aMax(aNodes.Count - 1, aNodes.Count - 1)<br> <br>            For i = 0 To aMin.GetUpperBound(0)<br>                For j = 0 To aMin.GetUpperBound(0)<br>                    aMin(i, j) = 1001<br>                    aMax(i, j) = -1001<br>                Next<br>            Next<br> <br>            Dim bGood As Boolean<br> <br>            For i = 0 To data.GetUpperBound(0)<br>                For j = 0 To aNodes.IndexOfKey(data(i))<br>                    For k = aNodes.IndexOfKey(data(i)) To aMax.GetUpperBound(0)<br>                        If aMin(j, k) &gt; -1001 Then<br>                            bGood = False<br>                            If data(i) &lt;= aMin(j, k) Then<br>                                bGood = True<br>                                aMin(j, k) = data(i)<br>                            End If<br>                            If data(i) &gt;= aMax(j, k) Then<br>                                bGood = True<br>                                aMax(j, k) = data(i)<br>                            End If<br>                            If Not bGood Then<br>                                aMin(j, k) = -1001<br>                                aMax(j, k) = 1001<br>                            End If<br>                        End If<br>                    Next<br>                Next<br>            Next<br> <br>            Dim aMinLen(aMin.GetUpperBound(0), aMin.GetUpperBound(0)) As Integer<br> <br>            For j = 0 To aMin.GetUpperBound(0)<br>                For i = 0 To aMin.GetUpperBound(0) - j<br>                    If aMin(i, i + j) &gt; -1001 Then<br>                        aMinLen(i, i + j) = 1<br>                    Else<br>                        aMinLen(i, i + j) = 9999<br>                        For k = i + 1 To i + j<br>                            aMinLen(i, i + j) = System.Math.Min(aMinLen(i, i + j), aMinLen(i, k - 1) + aMinLen(k, i + j))<br>                        Next<br>                    End If<br>                Next<br>            Next<br> <br>            Return aMinLen(0, aMin.GetUpperBound(0))<br> <br>        End Function<br>    End Class<br></td>