<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class Fifteen<br>    Dim mem(1000000) As Integer<br> <br>    Public Function outcome(ByVal moves As Integer()) As String<br>        Dim pl1, pl2, left As Integer<br>        left = 2 ^ 9 - 1<br>        Dim a As Integer<br>        For a = 0 To moves.Length - 1<br>            If a Mod 2 = 0 Then<br>                pl1 = pl1 Or (2 ^ (moves(a) - 1))<br>            Else<br>                pl2 = pl2 Or (2 ^ (moves(a) - 1))<br>            End If<br>            left = left And (Not (2 ^ (moves(a) - 1)))<br>        Next<br>        Dim rez As Integer = best(pl2, pl1, left)<br>        If rez = -1 Then<br>            Return "LOSE"<br>        Else<br>            Return "WIN " &amp; rez<br>        End If<br>    End Function<br> <br>    Private Function best(ByVal pl1 As Integer, ByVal pl2 As Integer, ByVal left As Integer) As Integer<br>        If mem(pl1 * 1000 + pl2) &lt;&gt; 0 Then Return mem(pl1 * 1000 + pl2)<br>        Dim a As Integer<br>        Dim bit As Integer = 1<br>        Dim rez As Integer = -1<br> <br>        If isok(pl2) Then<br>            rez = -1<br>        Else<br>            For a = 1 To 9<br>                If (left And bit) &gt; 0 Then<br>                    If best(pl2, (pl1 Or bit), left And (Not bit)) = -1 Then<br>                        rez = a<br>                        Exit For<br>                    End If<br>                End If<br>                bit *= 2<br>            Next<br>        End If<br> <br>        mem(pl1 * 1000 + pl2) = rez<br>        Return rez<br>    End Function<br> <br>    Private Function isok(ByVal pl As Integer) As Boolean<br>        Dim a, b, c As Integer<br>        Dim bit As Integer = 1<br>        Dim al As New ArrayList<br> <br>        For a = 1 To 9<br>            If (pl And bit) &gt; 0 Then<br>                al.Add(a)<br>            End If<br>            bit *= 2<br>        Next<br> <br>        For a = 0 To al.Count - 1<br>            For b = a + 1 To al.Count - 1<br>                For c = b + 1 To al.Count - 1<br>                    If al(a) + al(b) + al(c) = 15 Then Return True<br>                Next<br>            Next<br>        Next<br> <br>        Return False<br>    End Function<br>End Class<br></td>