<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br> <br>Public Class Animation<br>    Private Class Part<br>        Public pos As Integer<br>        Public dir As Integer<br>        Public Sub New(ByVal p As Integer, ByVal d As Integer)<br>            pos = p<br>            dir = d<br>        End Sub<br>    End Class<br> <br>    Private N As Integer<br> <br>    Public Function animate(ByVal speed As Integer, ByVal init As String) As String()<br>        Dim al As New ArrayList<br>        N = init.Length<br>        Dim a As Integer<br>        For a = 0 To N - 1<br>            Select Case init.Chars(a)<br>                Case "."c<br>                Case "R"c<br>                    al.Add(New Part(a, 1))<br>                Case "L"c<br>                    al.Add(New Part(a, -1))<br>            End Select<br>        Next<br>        Dim ret As New ArrayList<br>        ret.Add(ToStr(al))<br>        While al.Count &gt; 0<br>            Dim copy As New ArrayList(al)<br>            Dim p As Part<br>            For Each p In copy<br>                p.pos += p.dir * speed<br>                If p.pos &lt; 0 OrElse p.pos &gt;= N Then al.Remove(p)<br>            Next<br>            ret.Add(ToStr(al))<br>        End While<br>        Return ret.ToArray(GetType(String))<br>    End Function<br> <br>    Private Function ToStr(ByVal al As ArrayList) As String<br>        Dim p As Part<br>        Dim s As Char() = New String(".", N).ToCharArray<br>        For Each p In al<br>            s(p.pos) = "X"c<br>        Next<br>        Return New String(s)<br>    End Function<br>End Class<br></td>