<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class RockSkipping<br>    Private cache(,) As Double<br>    Private hit(,) As Double<br> <br>    Private N As Integer<br>    Private p() As Boolean<br> <br>    Public Function probability(ByVal pads As String, ByVal maxDist As Integer) As Double<br>        N = pads.Length<br>        ReDim p(N - 1)<br>        ReDim hit(N - 1, maxDist)<br>        ReDim cache(N - 1, maxDist)<br>        Dim a As Integer<br>        For a = 0 To N - 1<br>            p(a) = (pads.Chars(a) = "X"c)<br>        Next<br>        Return calc(0, maxDist) * 100<br>    End Function<br> <br>    Private Function calc(ByVal x As Integer, ByVal m As Integer) As Double<br>        If hit(x, m) Then Return cache(x, m)<br> <br>        Dim ret As Double<br>        Dim a As Integer<br>        If p(x) Then<br>            ret = 0<br>        ElseIf m = 0 Then<br>            ret = 1<br>        Else<br>            For a = 1 To m<br>                ret += calc((x + a) Mod N, m - 1)<br>            Next<br>            ret /= m<br>        End If<br> <br>        hit(x, m) = True<br>        cache(x, m) = ret<br>        Return ret<br>    End Function<br>End Class<br></td>