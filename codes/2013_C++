<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt;<br>#include &lt;string&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;algorithm&gt;<br>using namespace std;<br> <br>#define ll long long<br>#define vs vector&lt;string&gt;<br>#define vi vector&lt;int&gt;<br>#define vll vector&lt;ll&gt;<br>#define fo(x,y) for((x)=0;(x)&lt;(y);(x)++)<br>#define fi fo(i,n)<br>#define fj fo(j,n)<br>#define fk fo(k,n)<br>#define fr(x,y,z) for((x)=(y);(x)&lt;(z);(x)++)<br>#define pb push_back<br>#define sz size()<br>#define cs c_str()<br>#define ins(x) insert(x)<br>#define dub (double)<br> <br>int g[20];<br> <br>ll ncr(int n, int r) {<br>  ll ret=1;<br>  int i;<br>  if (r&gt;n) return 0;<br>  for(i=1;i&lt;=r;i++) ret*=(n+1-i),ret/=i;<br>  return ret;<br>}<br> <br>class Deranged { public: ll numDerangements(vi f) {<br>int n=f.size();<br>int i,j,r;<br>ll k,ret=0;<br>ll x;<br> <br>fo(i,1&lt;&lt;n) {<br>  fo(j,n) g[j]=0; k=1;<br>  r=n;<br>  fo(j,n) if(i&amp;(1&lt;&lt;j)) { k=-k; r--; } else { g[f[j]]++; }<br>  x=1;<br>  fo(j,n) x*=ncr(r,g[j]),r-=g[j];<br>  ret+=k*x;<br>}<br>return ret;<br>}};<br></td>