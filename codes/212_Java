<td class="problemText" colspan="8" valign="middle" align="left">
            public class LongCalc {<br>public String process(String a, String b, int op) {<br>  int[] aa = parse(a);<br>  int[] bb = parse(b);<br>  int[] cc = new int[200];<br>  switch (op) {<br>    case 1: cc = add(aa, bb); break;<br>    case 2: cc = add(aa, negate(bb)); break;<br>    case 3: cc = multiply(aa, bb); break;<br>    case 4: cc = divide(aa, bb); break;<br>  }<br>  return p(cc);<br>}<br> <br>int[] parse(String s) {<br>  if (s.startsWith("-")) {<br>    int[] r = parse(s.substring(1));<br>    return negate(r);<br>  }<br> <br>  int[] r = new int[200];<br>  for (int i = 0; i &lt; s.length(); ++i) r[s.length() - 1 - i] = s.charAt(i) - '0';<br> <br>  System.out.println("parse(" + s + ") = " + p(r));<br>  return r;<br>}<br> <br>int[] negate(int[] bb) {<br>  int[] rr = new int[200];<br>  for (int i = 0; i &lt; 200; ++i) {<br>    rr[i] = 9 - bb[i];<br>  }<br>  int[] x = new int[200];<br>  x[0] = 1;<br>  return add(rr, x);<br>}<br> <br>int[] divide(int[] top, int[] bot) {<br>  int[] hi = (int[]) top.clone();<br>  int[] lo = new int[200];<br>  while (cmp(lo, hi) != 0) {<br>    int[] x = add(hi, hi);<br>    x = add(x, x);<br>    int[] mid = add(x, hi);<br>    x = add(lo, lo);<br>    x = add(x, x);<br>    mid = add(mid, x);<br>    mid = add(mid, lo);<br>    x = new int[200];<br>    x[0] = 9;<br>    mid = add(mid, x);<br>    for (int i = 0; i &lt; 199; ++i) mid[i] = mid[i+1];<br>    //System.out.println("midpoint of " + p(hi) + " and " + p(lo) + " = " + p(mid));<br> <br>    int[] y = multiply(bot, mid);<br>    int c = cmp(top, y);<br>    if (c &gt;= 0) { lo = mid; } else {<br>      hi = mid;<br>      x = new int[200];<br>      x[0] = 1;<br>      hi = add(hi, negate(x));<br>    }<br>  }<br>  return lo;<br>}<br> <br>int cmp(int[] a, int[] b) {<br>  for (int i = 199; i &gt;= 0; --i) if (a[i] != b[i]) return a[i] - b[i];<br>  return 0;<br>}<br> <br>int[] add(int[] a, int[] b) {<br>  int[] r = new int[200];<br>  int carry = 0;<br>  for (int i = 0; i &lt; 200; ++i) {<br>    int x = a[i] + b[i] + carry;<br>    r[i] = x % 10;<br>    carry = x / 10;<br>  }<br>  //System.out.println("add(" + p(a) + ", " + p(b) + ") = " + p(r));<br>  return r;<br>}<br> <br>int[] mul10(int[] a) {<br>  int[] r = new int[200];<br>  for (int i = 1; i &lt; 200; ++i) r[i] = a[i-1];<br> <br>  //System.out.println("mul10(" + p(a) + ") = " + p(r));<br>  return r;<br>}<br> <br>int[] mulDigit(int[] a, int x) {<br>  if (x == 0) return new int[200];<br>  return add(a, mulDigit(a, x - 1));<br>}<br> <br>int[] multiply(int[] a, int[] b) {<br>  int[] r = new int[200];<br>  int[] p = (int[]) a.clone();<br>  for (int i = 0; i &lt; 200; ++i, p = mul10(p)) {<br>    if (b[i] == 0) continue;<br>    r = add(r, mulDigit(p, b[i]));<br>  }<br>  //System.out.println("multiply(" + p(a) + ", " + p(b) + ") = " + p(r));<br>  return r;<br>}<br> <br>String p(int[] a) {<br>  if (a[199] == 9) { return "-" + p(negate(a)); }<br> <br>  String x = "";<br>  int i = 199;<br>  while (i &gt; 0 &amp;&amp; a[i] == 0) --i;<br>  for (; i &gt;= 0; --i) x += a[i];<br>  return x;<br>}<br> <br>}<br></td>