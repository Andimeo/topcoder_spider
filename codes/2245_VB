<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class Piglets<br>        Dim iMove(1 &lt;&lt; 15) As Integer<br>        Dim iLen As Integer<br>        Public Function choose(ByVal trough As String) As Integer<br>            iLen = trough.Length<br> <br>            Dim i, j, k As Integer<br>            For i = 0 To 1 &lt;&lt; iLen<br>                iMove(i) = -1<br>            Next<br> <br>            Dim iMoves, iBest, iBestIdx As Integer<br>            iBest = -1<br>            iBestIdx = -1<br>            Dim iLeft, iRight, iCheck As Integer<br> <br>            For i = (1 &lt;&lt; iLen) - 1 To 0 Step -1<br>                If (i And 1) = 0 Then<br>                    iMove(i) = 0<br>                End If<br>                If (i And (1 &lt;&lt; (iLen - 1))) = 0 And iMove(i) = -1 Then<br>                    iMove(i) = iLen - 1<br>                End If<br>                If iMove(i) = -1 Then<br>                    iBest = -1<br>                    iBestIdx = -1<br>                    For j = 1 To iLen - 2<br>                        If (i And (1 &lt;&lt; j)) = 0 Then<br>                            iMoves = 0<br>                            k = i + (1 &lt;&lt; j)<br>                            iCheck = (1 &lt;&lt; j) + (1 &lt;&lt; (j - 1)) + (1 &lt;&lt; (j + 1))<br>                            Do While (k And iCheck) &lt; iCheck<br>                                k = k + (1 &lt;&lt; iMove(k))<br>                                iMoves += 1<br>                            Loop<br>                            If iMoves &gt; iBest Then<br>                                iBest = iMoves<br>                                iBestIdx = j<br>                            End If<br>                        End If<br>                    Next<br>                    iMove(i) = iBestIdx<br>                End If<br>            Next<br> <br>            j = 0<br>            For i = 0 To trough.Length - 1<br>                If trough.Substring(i, 1) = "p" Then j += (1 &lt;&lt; i)<br>            Next<br>            'If j = (1 &lt;&lt; iLen) - 1 Then Return -1<br>            Return iMove(j)<br> <br> <br> <br>        End Function<br> <br>    End Class<br></td>