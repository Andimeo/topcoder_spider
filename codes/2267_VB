<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class Measures<br>  Public Function beatsPerM(ByVal loudness As Integer()) As Integer<br>    Dim nBeats As Integer = loudness.GetUpperBound(0)<br>    Dim bpm As Integer, off As Integer<br>    Dim numMeas As Integer<br>    Dim goodMeas As Integer<br>    Dim I As Integer, J As Integer<br>    Dim firstBeat As Integer<br>    Dim Flag As Boolean<br>    For bpm = 2 to 10<br>      For off = 0 to bpm - 1<br>        numMeas = (nBeats + 1 - off)\bpm<br>        If numMeas &gt; 0 Then<br>          goodMeas = 0<br>          For I = 1 to numMeas<br>            firstBeat = loudness(off+(I-1)*bpm)<br>            Flag = True<br>            For J = 1 to bpm - 1  <br>              If loudness(off+(I-1)*bpm+J) &gt; firstBeat Then<br>                Flag = False<br>              End If<br>            Next J<br>            If Flag Then<br>              goodMeas += 1<br>            End If<br>          Next I<br>          If goodMeas &gt;= 0.8 * numMeas Then<br>            Return bpm<br>          End If<br>        End If<br>      Next off<br>    Next bpm  <br>    Return - 1<br>  End Function<br>End Class<br></td>