<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class TeXLeX<br>    Public Function getTokens(ByVal input As String) As Integer()<br>        Dim a As Integer<br>        While a &lt; input.Length<br>            If a + 3 &lt; input.Length AndAlso input.Chars(a) = "^"c AndAlso input.Chars(a + 1) = "^"c AndAlso ishexdigit(input.Chars(a + 2)) AndAlso ishexdigit(input.Chars(a + 3)) Then<br>                Dim c As Char = ChrW(16 * hexdigit(input.Chars(a + 2)) + hexdigit(input.Chars(a + 3)))<br>                input = input.Remove(a, 4)<br>                input = input.Insert(a, c)<br>            ElseIf a + 2 &lt; input.Length AndAlso input.Chars(a) = "^"c AndAlso input.Chars(a + 1) = "^"c AndAlso AscW(input.Chars(a + 2)) &gt; 63 Then<br>                Dim c As Char = ChrW(AscW(input.Chars(a + 2)) - 64)<br>                input = input.Remove(a, 3)<br>                input = input.Insert(a, c)<br>            ElseIf a + 2 &lt; input.Length AndAlso input.Chars(a) = "^"c AndAlso input.Chars(a + 1) = "^"c AndAlso AscW(input.Chars(a + 2)) &lt; 64 Then<br>                Dim c As Char = ChrW(AscW(input.Chars(a + 2)) + 64)<br>                input = input.Remove(a, 3)<br>                input = input.Insert(a, c)<br>            Else<br>                a += 1<br>            End If<br>        End While<br>        Dim ret(input.Length - 1) As Integer<br>        For a = 0 To input.Length - 1<br>            ret(a) = AscW(input.Chars(a))<br>        Next<br>        Return ret<br>    End Function<br> <br>    Private Function ishexdigit(ByVal c As Char) As Boolean<br>        If (AscW(c) &gt;= AscW("0"c) AndAlso AscW(c) &lt;= AscW("9"c)) OrElse (AscW(c) &gt;= AscW("a") AndAlso AscW(c) &lt;= AscW("f")) Then<br>            Return True<br>        Else<br>            Return False<br>        End If<br>    End Function<br> <br>    Private Function hexdigit(ByVal c As Char) As Integer<br>        If (AscW(c) &gt;= AscW("0"c) AndAlso AscW(c) &lt;= AscW("9"c)) Then<br>            Return AscW(c) - AscW("0"c)<br>        ElseIf (AscW(c) &gt;= AscW("a") AndAlso AscW(c) &lt;= AscW("f")) Then<br>            Return AscW(c) - AscW("a") + 10<br>        End If<br>    End Function<br>End Class<br></td>