<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class RandomFA<br>    Private Class Rule<br>        Public Prob(50) As Integer<br>        Public Sub New(ByVal rule As String)<br>            If rule Is Nothing OrElse rule.Length = 0 Then<br>                Prob(50) = 100<br>            Else<br>                Dim s() As String = rule.Split(" "c, ":"c)<br>                Dim sum As Integer<br>                Dim a As Integer<br>                For a = 0 To s.Length - 2 Step 2<br>                    Prob(s(a)) = s(a + 1)<br>                    sum += s(a + 1)<br>                Next<br>                Prob(50) = 100 - sum<br>            End If<br>        End Sub<br>    End Class<br> <br>    Public Function getProbability(ByVal rulesa As String(), ByVal rulesb As String(), ByVal rulesc As String(), ByVal finalState As Integer, ByVal maxLength As Integer) As Double<br>        Dim count(10) As Integer<br>        Dim prob(10, 50) As Double<br>        Dim r(2, rulesa.Length - 1) As Rule<br> <br>        Dim a, b, c As Integer<br>        For a = 0 To 10<br>            count(a) = 3 ^ a<br>        Next<br>        prob(0, 0) = 1<br>        For a = 0 To rulesa.Length - 1<br>            r(0, a) = New Rule(rulesa(a))<br>            r(1, a) = New Rule(rulesb(a))<br>            r(2, a) = New Rule(rulesc(a))<br>        Next<br> <br>        For a = 1 To 10<br>            Dim p As Double<br>            For b = 0 To rulesa.Length - 1<br>                p = 0<br>                For c = 0 To rulesa.Length - 1<br>                    p += prob(a - 1, c) * (r(0, c).Prob(b) + r(1, c).Prob(b) + r(2, c).Prob(b)) / 300<br>                Next<br>                prob(a, b) = p<br>            Next<br>            p = 0<br>            For c = 0 To rulesa.Length - 1<br>                p += prob(a - 1, c) * (r(0, c).Prob(50) + r(1, c).Prob(50) + r(2, c).Prob(50)) / 300<br>            Next<br>            p += prob(a - 1, 50)<br>            prob(a, 50) = p<br>        Next<br> <br>        If finalState = 999 Then finalState = 50<br> <br>        Dim w As Double<br>        Dim s As Double<br>        For a = 0 To maxLength<br>            w += count(a) * prob(a, finalState)<br>            s += count(a)<br>        Next<br>        Return w / s<br>    End Function<br>End Class<br></td>