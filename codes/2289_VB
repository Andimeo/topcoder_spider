<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System.Math<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br> <br>Public Class Fences<br>    Dim ba As New BitArray(1002 * 1002)<br>    Public Function fenceLength(ByVal x1 As Integer(), ByVal y1 As Integer(), ByVal x2 As Integer(), ByVal y2 As Integer()) As Integer<br>        Dim a, x, y As Integer<br>        Dim xx1, yy1, xx2, yy2, t As Integer<br>        For a = 0 To x1.Length - 1<br>            xx1 = Min(x1(a), x2(a))<br>            xx2 = Max(x1(a), x2(a))<br>            yy1 = Min(y1(a), y2(a))<br>            yy2 = Max(y1(a), y2(a))<br>            For x = xx1 To xx2 - 1<br>                For y = yy1 To yy2 - 1<br>                    ba(1002 * (y + 1) + x + 1) = True<br>                Next<br>            Next<br>        Next<br>        Dim ret As Integer<br>        For x = 1 To 1000<br>            For y = 1 To 1000<br>                If ba(1002 * y + x) = True Then<br>                    If ba(1002 * (y - 1) + (x)) = False Then ret += 1<br>                    If ba(1002 * (y + 1) + (x)) = False Then ret += 1<br>                    If ba(1002 * (y) + (x - 1)) = False Then ret += 1<br>                    If ba(1002 * (y) + (x + 1)) = False Then ret += 1<br>                End If<br>            Next<br>        Next<br>        Return ret<br>    End Function<br>End Class<br></td>