<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Collections.Generic;<br>using System.Collections.Specialized;<br>using System.Text;<br>using System.Text.RegularExpressions;<br> <br>public class QuickTableau<br>{<br>    int[] t;<br> <br>    int[] b;<br> <br>    int ans;<br> <br>    bool[] use;<br>    void search(int ii)<br>    {<br>        if (ii == 15)<br>        {<br>            int[] target = new int[16];<br>            bool[] mark = new bool[16];<br> <br>            for (int i = 0; i &lt; 16; i++)<br>                target[t[i]] = b[i];<br> <br>            int temp = 0;<br>            for (int i = 0; i &lt; 16; i++)<br>                if (!mark[i])<br>            {<br>                int cg = 0;<br>                mark[i] = true;<br>                int j = target[i];<br>                while (j != i) { cg++; mark[j] = true;  j = target[j]; }<br>                temp += cg;<br>            }<br> <br>        if (temp &lt; ans) ans = temp;<br>            return;<br>        }<br> <br>        int x = ii / 4; int y = ii % 4;<br>        if (y == 0)<br>        {<br>            for (int i = b[ii - 4] + 1; i &lt;= 14; i++)<br>                if (!use[i])<br>                {<br>                    use[i] = true;<br>                    b[ii] = i;<br>                    search(ii + 1);<br>                    use[i] = false;<br>                }<br>        }<br>        else<br>        {<br>            int low = b[ii - 1];<br>            if (ii &gt; 3) low = Math.Max(low, b[ii - 4]);<br>            for (int i = low + 1; i &lt;= 14; i++)<br>                if (!use[i])<br>                {<br>                    use[i] = true;<br>                    b[ii] = i;<br>                    search(ii + 1);<br>                    use[i] = false;<br>                }<br>        }<br>    }<br> <br>    public int numSwaps(int[] t0)<br>    {<br>        t = t0;<br>        int[] a = new int[16];<br>        for (int i = 0; i &lt; 16; i++) a[i] = t[i];<br>        Array.Sort(a);<br>        for (int i = 0; i &lt; 16; i++) t[i] = Array.IndexOf(a, t[i]);<br> <br>         ans = int.MaxValue;<br> <br>         use = new bool[16];<br>        b = new int[16];<br>        b[0] = 0;<br>        b[15] = 15;<br>        search(1);<br>        return ans;<br>    }<br>    }<br></td>