<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class ClapLight<br>    Public Function threshold(ByVal background As Integer()) As Integer<br> <br>        Dim bg(background.Length - 1) As Integer<br>        bg.Copy(background, bg, background.Length)<br>        bg.Sort(bg)        <br> <br>        Dim mid As Integer<br>        Dim numSmpls As Integer = background.Length<br> <br> <br>        Dim i As Integer<br>        If bg.Length Mod 2 = 1 Then<br>            i = CInt((numSmpls + 0.5) / 2) - 1<br>        Else<br>            i = CInt((numSmpls) / 2)<br>        End If<br>        mid = bg(i) + 1<br> <br>        Dim isTrigger As Boolean = False<br> <br>        Dim j As Integer<br>        Do While mid &lt;= bg(bg.Length - 1)<br>            isTrigger = False<br>            For j = 0 To (background.Length - 4)<br>                If (background(j) &lt; mid) And (background(j + 1) &gt;= mid) And (background(j + 2) &gt;= mid) And (background(j + 3) &lt; mid) Then<br>                    isTrigger = True<br>                    Exit For<br>                End If<br>            Next<br>            If Not isTrigger Then<br>                Return mid<br>            Else<br>                mid = mid + 1<br>            End If<br>        Loop<br> <br>        Return mid<br> <br>    End Function<br>End Class<br></td>