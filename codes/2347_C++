<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;string&gt;<br>#include &lt;vector&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;iostream&gt;<br>#include &lt;math.h&gt;<br> <br>using namespace std;<br> <br>#define VI vector &lt;int&gt;<br>#define VVI vector &lt;VI&gt;<br> <br>#define pb push_back<br>#define sz size()<br>#define FOR(i,m) for(i=0;i&lt;m;i++)<br> <br>class Rationalization {<br>  public:<br>  VI W1,W,S;<br>  VVI A,A1;<br>  int d,H;<br>  void Check(int q) {<br>    int i,j,ss;<br>    FOR(i,A.sz) if ((i != d) &amp;&amp; (S[i] &gt;= S[d])) {<br>      ss = S[i];<br>      FOR(j,A[i].sz) if ((ss &gt;= S[d]) &amp;&amp; (A[i][j] != 1)) { ss -= W[j]; q++; }<br>      if (ss &gt;= S[d]) return;<br>    }<br>    if (q &lt; H) H = q;<br>    return;<br>  }<br>  void Count(int w) {<br>    int i,j,k,l;<br>    W = W1;<br>    A = A1;<br>    FOR(i,W.sz-1) FOR(j,W.sz-1) if (W[j] &lt; W[j+1]) {<br>      W[j] += W[j+1]; W[j+1] = W[j] - W[j+1]; W[j] -= W[j+1];<br>      FOR(k,A.sz) { l = A[k][j+1]; A[k][j+1] = A[k][j]; A[k][j] = l; }<br>    }<br>    FOR(i,A.sz) {<br>      k = 0;<br>      FOR(j,A[i].sz) k += A[i][j]*W[j];<br>      S[i] = k;<br>    }<br>    k = 0;<br>    Check(w);<br>    FOR(i,A[d].sz) if (A[d][i] != 9) {<br>      k++;<br>      S[d] += W[i];<br>      Check(w+k);<br>    }<br>  }<br>  void Rec(int q,int w) {<br>    if (w &gt;= H) return;<br>    if (q == W1.sz) { Count(w); return; }<br>    Rec(q+1,w);<br>    W1[q]--;<br>    if (W1[q] != 0) Rec(q+1,w+1);<br>    W1[q]+=2;<br>    if (W1[q] != 10) Rec(q+1,w+1);<br>    W1[q]--;<br>  }<br>  int minTweaks(vector &lt;int&gt; weights, vector &lt;string&gt; scores, int desired) {<br>    W1 = weights;<br>    d = desired;<br>    H = 10000;<br>    int i,j;<br>    FOR(i,scores.sz) { VI AA; FOR(j,scores[i].sz) AA.pb(scores[i][j] - '0'); A.pb(AA); }<br>    FOR(i,A.sz) S.pb(0);<br>    A1 = A;<br>    Rec(0,0);<br>    if (H == 10000) H = -1;<br>    return H;<br>  }<br>};<br> <br>// Powered by PopsEdit<br></td>