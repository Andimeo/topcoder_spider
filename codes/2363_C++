<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;algorithm&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cstring&gt;<br>#include &lt;functional&gt;<br>#include &lt;iostream.h&gt;<br>#include &lt;math.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;string&gt;<br>#include &lt;string.h&gt;<br>#include &lt;time.h&gt;<br> <br> <br>#include &lt;vector&gt;<br>using namespace std;<br> <br> <br>class Homomorphism<br>{<br>  public:<br>  int count(string u, string v)<br>  {<br>    char c1[51];<br>    char c0[51];<br>    char cr[100];<br>    int r = 0;<br>    int i, j, z;<br>    int n1 = 0;<br>    int n0 = 0;<br>    int f1 = -1;<br>    int f0 = -1;<br>    int s = v.length();<br>    int us = u.length();<br> <br> <br>    for (i = 0; i &lt; u.length(); i++)<br>    {<br>      if (u[i] == '1')<br>      {<br>        if (f1 == -1)<br>          f1 = i;<br>        n1++;<br>      }<br>      else if (u[i] == '0')<br>      {<br>        if (f0 == -1)<br>          f0 = i;<br>        n0++;<br>      }<br>    }<br> <br>    if (n1 == 0 &amp;&amp; n0 != 0)<br>    {<br>      if (s % n0)<br>        return 0;<br>      else<br>        return -1;<br>    }<br>    if (n0 == 0 &amp;&amp; n1 != 0)<br>    {<br>      if (s % n1)<br>        return 0;<br>      else<br>        return -1;<br>    }<br> <br> <br>    for (i = 1; i &lt; s; i++)<br>    {<br>      for (j = 1; j &lt; s; j++)<br>      {<br>        int x = f1 * j;<br>        int y = f0 * i;<br> <br>        if (i * n1 + j * n0 != s)<br>          continue;<br> <br>        for ( z = 0; z &lt; i; z++)<br>        {<br>          c1[z] = v[x + z]; <br>        }<br>        c1[z] = '\0';<br> <br>        for ( z = 0; z &lt; j; z++)<br>        {<br>          c0[z] = v[y + z]; <br>        }<br>        c0[z] = '\0';<br> <br>        cr[0] = '\0';<br>        for ( z = 0; z&lt; us; z++)<br>        {<br>          if (u[z] == '0')<br>          {<br>            strcat(cr, c0);<br>          }<br>          else<br>            strcat(cr, c1);<br>        }<br> <br>        if (strcmp(cr, v.c_str()) == 0)<br>          r++;<br>      }<br>    }<br> <br>    return r;<br>  }<br>};<br></td>