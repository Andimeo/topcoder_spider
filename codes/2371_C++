<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt;<br>#include &lt;string&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;algorithm&gt;<br>using namespace std;<br> <br>#define ll long long<br>#define vs vector&lt;string&gt;<br>#define vi vector&lt;int&gt;<br>#define vd vector&lt;double&gt;<br>#define vll vector&lt;ll&gt;<br>#define fo(x,y) for((x)=0;(x)&lt;(y);(x)++)<br>#define fi fo(i,n)<br>#define fj fo(j,n)<br>#define fk fo(k,n)<br>#define fl fo(l,n)<br>#define fir(n) fo(i,n)<br>#define fjr(n) fo(j,n)<br>#define fkr(n) fo(k,n)<br>#define flr(n) fo(l,n)<br>#define fr(x,y,z) for((x)=(y);(x)&lt;(z);(x)++)<br>#define pb push_back<br>#define sz size()<br>#define cs c_str()<br>#define ins(x) insert(x)<br>#define dub (double)<br>#define df double<br>#define srt(f) sort(f.begin().f.end())<br> <br>int opt[27][27][27];<br>int n;<br> <br>int go(int h, int l, int ok, int b) {<br>int ret=999;<br> <br>//if (h+l+ok+b!=n) return 0;<br>if (h+l==1 &amp;&amp; b==0) { opt[h][l][ok]=0; return 0; }<br>if (h+l==0 &amp;&amp; b==1) { opt[h][l][ok]=1; return 1; }<br> <br> <br>if (opt[h][l][ok]==-2) return 99999;<br>if (opt[h][l][ok]!=-1) return opt[h][l][ok];<br>opt[h][l][ok]=-2;<br>//printf("%d %d %d %d\n",h,l,ok,b);<br> <br>int h1,h2,l1,l2,b1,b2,ok1,ok2;<br> <br>for(h1=0;h1&lt;=h;h1++) for(h2=0;h1+h2&lt;=h;h2++)<br>for(l1=0;l1&lt;=l;l1++) for(l2=0;l1+l2&lt;=l;l2++)<br>for(b1=0;b1&lt;=b;b1++) for(b2=0;b1+b2&lt;=b;b2++) {<br>  int ret2=0;<br> <br>  if (h1+h2+l1+l2+b1+b2==0) continue;<br> <br>  ok1=h2+l2+b2-h1-l1-b1; ok1&gt;?=0;<br>  ok2=h1+l1+b1-h2-l2-b2; ok2&gt;?=0;<br>  if (ok1+ok2&gt;ok) continue;<br> <br>//  printf("%d %d %d %d   %d %d %d %d--\n",h1,l1,b1,ok1,h2,l2,b2,ok2);<br> <br>  if (h1+l2+b1+b2) {   // left heavy<br>    ret2 &gt;?=1+go(h1+b1,l2+b2,n-(h1+b1)-(l2+b2),0);<br>  }<br>  if (l1+h2+b1+b2) {   // right heavy<br>    ret2 &gt;?=1+go(h2+b2,l1+b1,n-(h2+b2)-(l1+b1),0);<br>  }<br>  if ((l-l1-l2)+(h-h1-h2)+(b-b1-b2)) {<br>    ret2 &gt;?=1+go(h-h1-h2,l-l1-l2,n-(h-h1-h2)-(l-l1-l2)-(b-b1-b2),b-b1-b2);<br>  }<br>//  if (ret2==0) printf("! %d %d %d %d   %d %d %d %d--\n",h1,l1,b1,ok1,h2,l2,b2,ok2);<br> <br>  ret &lt;?=ret2;<br>}<br> <br>printf("%d %d %d = %d\n",h,l,ok,ret);<br>opt[h][l][ok]=ret;<br>return ret;<br>}<br> <br>int canh[26],canl[26];<br> <br>string best;<br> <br>string create1(int h1,int l1,int b1,int ok1,int h2,int l2,int b2,int ok2) {<br>  int i;<br>  string ret;<br>  int used[26]; fi used[i]=0;<br>  while(h1+l1+b1+ok1) {<br>    fi if (!used[i]) {<br>      if(canl[i] &amp;&amp; canh[i] &amp;&amp; b1) { ret+=(char) ('A'+i); b1--; used[i]=1; } else<br>      if(canl[i] &amp;&amp; !canh[i] &amp;&amp; l1) { ret+=(char) ('A'+i); l1--; used[i]=1; } else<br>      if(!canl[i] &amp;&amp; canh[i] &amp;&amp; h1) { ret+=(char) ('A'+i); h1--; used[i]=1; } else<br>      if(!canl[i] &amp;&amp; !canh[i] &amp;&amp; ok1) { ret+=(char) ('A'+i); ok1--; used[i]=1; }<br>    }<br>  }<br>  ret+="-";<br>  while(h2+l2+b2+ok2) {<br>    fi if (!used[i]) {<br>      if(canl[i] &amp;&amp; canh[i] &amp;&amp; b2) { ret+=(char) ('A'+i); b2--; used[i]=1; } else<br>      if(canl[i] &amp;&amp; !canh[i] &amp;&amp; l2) { ret+=(char) ('A'+i); l2--; used[i]=1; } else<br>      if(!canl[i] &amp;&amp; canh[i] &amp;&amp; h2) { ret+=(char) ('A'+i); h2--; used[i]=1; } else<br>      if(!canl[i] &amp;&amp; !canh[i] &amp;&amp; ok2) { ret+=(char) ('A'+i); ok2--; used[i]=1; }<br>    }<br>  }<br>  return ret;<br>}<br> <br> <br> <br>void go2(int h, int l, int ok, int b) {<br>int ret=999;<br>best="";<br>//if (h+l+ok+b!=n) return 0;<br>if (h+l==1 &amp;&amp; b==0) return;<br>//if (h+l==0 &amp;&amp; b==1) return 1;<br> <br>//if (opt[h][l][ok]==-2) return 99999;<br>//if (opt[h][l][ok]!=-1) return opt[h][l][ok];<br>//opt[h][l][ok]=-2;<br>//printf("%d %d %d %d\n",h,l,ok,b);<br> <br>int h1,h2,l1,l2,b1,b2,ok1,ok2;<br> <br>for(h1=0;h1&lt;=h;h1++) for(h2=0;h1+h2&lt;=h;h2++)<br>for(l1=0;l1&lt;=l;l1++) for(l2=0;l1+l2&lt;=l;l2++)<br>for(b1=0;b1&lt;=b;b1++) for(b2=0;b1+b2&lt;=b;b2++) {<br>  int ret2=0;<br> <br>  if (h1+h2+l1+l2+b1+b2==0) continue;<br> <br>  ok1=h2+l2+b2-h1-l1-b1; ok1&gt;?=0;<br>  ok2=h1+l1+b1-h2-l2-b2; ok2&gt;?=0;<br>  if (ok1+ok2&gt;ok) continue;<br> <br>//  printf("%d %d %d %d   %d %d %d %d--\n",h1,l1,b1,ok1,h2,l2,b2,ok2);<br> <br>  if (h1+l2+b1+b2) {   // left heavy<br>    ret2 &gt;?=1+go(h1+b1,l2+b2,n-(h1+b1)-(l2+b2),0);<br>  }<br>  if (l1+h2+b1+b2) {   // right heavy<br>    ret2 &gt;?=1+go(h2+b2,l1+b1,n-(h2+b2)-(l1+b1),0);<br>  }<br>  if ((l-l1-l2)+(h-h1-h2)+(b-b1-b2)) {<br>    ret2 &gt;?=1+go(h-h1-h2,l-l1-l2,n-(h-h1-h2)-(l-l1-l2)-(b-b1-b2),b-b1-b2);<br>  }<br> <br>//  printf("%d! %d %d %d %d   %d %d %d %d--\n",ret2,h1,l1,b1,ok1,h2,l2,b2,ok2);<br> <br>  if (ret2==opt[h][l][ok]) {<br> <br>  //   printf("opt %d %d %d %d   %d %d %d %d--\n",h1,l1,b1,ok1,h2,l2,b2,ok2);<br> <br> <br>    string temp=create1(h1,l1,b1,ok1,h2,l2,b2,ok2);<br>    if (best=="") best=temp;<br>    else if (temp.sz&lt;best.sz) best=temp;<br>    else if (temp.sz==best.sz &amp;&amp; temp&lt;best) best=temp;<br>  }<br>}<br> <br>//printf("%d %d %d = %d\n",h,l,ok,ret);<br>//opt[h][l][ok]=ret;<br>return;<br>}<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>class CounterfeitCoin { public: string nextWeighing(int N, vs left, vs righ, string res) {<br>n=N;<br>int i,j,k;<br>string ret;<br>fir(27) fjr(27) fkr(27) opt[i][j][k]=-1;<br>//go(0,0,0,26);<br> <br>fi canh[i]=canl[i]=1;<br>fir(left.sz) {<br>  if (res[i]=='E') {<br>    fjr(left[i].sz) canh[left[i][j]-'A']=canl[left[i][j]-'A']=0;<br>    fjr(righ[i].sz) canh[righ[i][j]-'A']=canl[righ[i][j]-'A']=0;<br>  }<br>  if (res[i]=='L') {<br>    int t[26]; fj t[j]=1; int ok=0;<br>    fjr(left[i].sz) canl[left[i][j]-'A']=0,t[left[i][j]-'A']=0;<br>    fjr(righ[i].sz) canh[righ[i][j]-'A']=0,t[righ[i][j]-'A']=0;<br> <br>    fjr(left[i].sz) if(canh[left[i][j]-'A']) ok=1;<br>    fjr(righ[i].sz) if(canl[righ[i][j]-'A']) ok=1;<br>    if (!ok) return "error";<br>    fj if(t[j]) canh[j]=canl[j]=0;<br>  }<br>  if (res[i]=='R') {<br>    int t[26]; fj t[j]=1; int ok=0;<br>    fjr(left[i].sz) canh[left[i][j]-'A']=0,t[left[i][j]-'A']=0;<br>    fjr(righ[i].sz) canl[righ[i][j]-'A']=0,t[righ[i][j]-'A']=0;;<br>    fjr(left[i].sz) if(canl[left[i][j]-'A']) ok=1;<br>    fjr(righ[i].sz) if(canh[righ[i][j]-'A']) ok=1;<br>    if (!ok) return "error";<br>    fj if(t[j]) canh[j]=canl[j]=0;<br>  }<br>}<br>int l=0,h=0,b=0;<br>fi if(canh[i] &amp;&amp; canl[i]) b++; else if (canh[i]) h++; else if (canl[i]) l++;<br> <br>if (l+h+b==0) return "error";<br> <br>j=go(h,l,n-h-l-b,b);<br> <br>printf("%d\n",j);<br>go2(h,l,n-h-l-b,b);<br>return best;<br>}};<br></td>