<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class GravityBomb<br>    Dim bb()() As Char<br>    Public Function aftermath(ByVal board As String()) As String()<br>        Dim i, j As Integer<br>        ReDim bb(board.Length - 1)<br>        For i = 0 To (board.Length - 1)<br>            ReDim bb(i)(board(0).Length - 1)<br>            For j = 0 To board(0).Length - 1<br>                bb(i)(j) = board(i).Chars(j)<br>            Next<br>        Next<br> <br>        drop()<br>        nuke()<br> <br> <br>        Dim ret(bb.Length - 1) As String<br>        Dim rs As String = String.Empty<br>        For i = 0 To bb.Length - 1<br>            rs = String.Empty<br>            For j = 0 To bb(0).Length - 1<br>                rs &amp;= bb(i)(j)<br>            Next<br>            ret(i) = rs<br>        Next<br> <br>        Return ret<br>    End Function<br> <br> <br>    Private Function rowFull(ByVal r() As Char) As Boolean<br>        Dim i As Integer<br>        For i = 0 To r.Length - 1<br>            If r(i) = ".".Chars(0) Then Return False<br>        Next<br>        Return True<br>    End Function<br> <br> <br> <br>    Private Sub nukeRow(ByVal r As Integer)<br>        Dim i As Integer<br>        For i = r To 1 Step -1<br>            bb(i) = bb(i - 1)<br>        Next<br> <br>        Dim j As Integer<br>        Dim ch(bb(0).Length - 1) As Char<br>        For j = 0 To bb(0).Length - 1<br>            ch(j) = ".".Chars(0)<br>        Next<br>        bb(0) = ch<br>    End Sub<br> <br>    Private Sub nuke()<br>        Dim none As Boolean = False<br>        Dim i As Integer<br>        For i = 0 To bb.Length - 1<br>            If rowFull(bb(i)) Then<br>                nukeRow(i)<br>            End If<br>        Next<br>    End Sub<br> <br> <br>    Private Sub drop()<br>        Dim none As Boolean = False<br> <br>        Do While none = False<br>            none = True<br>            Dim i, j As Integer<br>            For i = 0 To bb.Length - 2<br>                For j = 0 To bb(0).Length - 1<br>                    If bb(i)(j) = "X" Then<br>                        If bb(i + 1)(j) = "." Then<br>                            bb(i)(j) = ".".Chars(0)<br>                            bb(i + 1)(j) = "X".Chars(0)<br>                            none = False<br>                        End If<br>                    End If<br>                Next<br>            Next<br>        Loop<br>    End Sub<br> <br>End Class<br></td>