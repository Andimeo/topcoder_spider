<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.util.regex.*;<br>import java.text.*;<br>import java.math.*;<br>import java.awt.geom.*;<br> <br>public class Untypeset<br>{<br>  public int evaluate(String[] expression)<br>  {<br>    return eval(expression);<br>  }<br>  <br>  public int eval(String[] expression) {<br>    int res = 0;<br>    <br>    List exp = new ArrayList();<br>    // Remove empty rows<br>    for (int i = 0; i &lt; expression.length; i++) {<br>      if (!expression[i].trim().equals("")) {<br>        exp.add(expression[i]);<br>      }<br>    }<br> <br>    // Remove left spaces and right spaces<br>    int count = 0;<br>    for (int i = 0; i &lt; expression[0].length(); i++) {<br>      boolean ok = true;<br>      for (int j = 0; j &lt; expression.length; j++) {<br>        if (expression[j].charAt(i) != ' ') {<br>          ok = false;<br>        }<br>      }<br>      if (!ok) break;<br>      count++;<br>    }<br>    int count2 = 0;<br>    for (int i = expression[0].length() - 1; i &gt;= 0; i--) {<br>      boolean ok = true;<br>      for (int j = 0; j &lt; expression.length; j++) {<br>        if (expression[j].charAt(i) != ' ') {<br>          ok = false;<br>        }<br>      }<br>      if (!ok) break;<br>      count2++;<br>    }<br>    <br>    <br>    expression = (String[]) exp.toArray(new String[0]);<br>    exp = new ArrayList();<br>    for (int i = 0; i &lt; expression.length; i++) {<br>      String string = expression[i];<br>      exp.add(string.substring(count, string.length() - count2));<br>    }<br>    expression = (String[]) exp.toArray(new String[0]);<br>    <br>    <br>    int width = expression[0].length();<br>    int height = expression.length;<br>    <br>    // Search for addition<br>    boolean ok = false;<br>    for (int i = 0; i &lt; width - 2; i++) {<br>      for (int j = 0; j &lt; height; j++) {<br>        ok = false;<br>        if ((expression[j].charAt(i) == ' ') &amp;&amp; <br>            (expression[j].charAt(i + 2) == ' ')) {<br>          if (j == height / 2) {<br>            if (expression[j].charAt(i + 1) == '+')  {<br>              ok = true;<br>            }<br>            <br>          } else {<br>            if (expression[j].charAt(i + 1) == ' ')  {<br>              ok = true;<br>            }            <br>          }<br>        }<br>        if (!ok) {<br>          break;<br>        }<br>      }<br>      <br>      if (ok) {<br>        // Found addition<br>        List left = new ArrayList();<br>        List right = new ArrayList();<br>        for (int j = 0; j &lt; expression.length; j++) {<br>          String string = expression[j];<br>          left.add(string.substring(0, i));<br>          right.add(string.substring(i + 3));<br>        }<br>        return eval((String[]) left.toArray(new String[0])) + eval((String[]) right.toArray(new String[0]));<br>      }<br>      <br>      <br>    }<br>    <br>    <br>    // Search for division<br>    for (int j = 0; j &lt; height; j++) {<br>      ok = true;<br>      for (int i = 0; i &lt; width; i++) {<br>        if (expression[j].charAt(i) != '-') {<br>          ok = false;<br>          break;<br>        }<br>      }<br>      <br>      if (ok) {<br>        List up = new ArrayList();<br>        List down= new ArrayList();<br>        for (int k = 0; k &lt; expression.length; k++) {<br>          String string = expression[k];<br>          if ( k &lt; j) {<br>            up.add(string);<br>            <br>          } else if (k &gt; j ){<br>            down.add(string);<br>            <br>          }<br>          <br>        }<br>        return eval((String[]) up.toArray(new String[0])) / eval((String[]) down.toArray(new String[0]));<br>      }<br>    }<br>    // Otherwise is an integer<br>    String num = expression[0].trim();<br>    return Integer.parseInt(num);<br>    <br>  }<br>  <br>  public static void main(String[] args)<br>  {<br>    long time;<br>    int answer;<br>    boolean errors = false;<br>    String answerString, desiredAnswerString;<br>    <br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{ "2801" });<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "2801";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{ "  625       ",  "------------",  "        5   " });<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "125";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{ "       ",  "500    ",  "       ",  "    +  ",  "       ",  "       ",  "      1",  "       ",  "       " });<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "501";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{ "   120   ",  "  -----  ",  "    10   ",  "---------",  "    6    ",  "   ---   ",  "    2    " });<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "4";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{ "       24       ",  " 31 + ----      ",  "       12   + 16",  "-----------     ",  "   5 + 6        " });<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "19";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{"3 + 4 + 6"});<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "13";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{ " 1     4     9 ",  "--- + --- + ---",  " 1     2     3 " });<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "6";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    time = System.currentTimeMillis();<br>    answer = new Untypeset().evaluate(new String[]{ "34      ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "   +    ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "        ",  "     924" });<br>    System.out.println("Time: " + (System.currentTimeMillis()-time)/1000.0 + " seconds");<br>    System.out.println("Your answer:");<br>    answerString = "" + answer;<br>    System.out.println("\t" + answerString);<br>    desiredAnswerString = "958";<br>    System.out.println("Desired answer:\n\t" + desiredAnswerString);<br>    if (!answerString.equals(desiredAnswerString))<br>    {<br>      errors = true;<br>      System.out.println("DOESN'T MATCH!!!!");<br>    }<br>    else<br>      System.out.println("Match :-)");<br>    System.out.println();<br>    <br>    if (errors)<br>      System.out.println("Some of the test cases had errors :-(");<br>    else<br>      System.out.println("You're a stud (at least on the test data)! :-D ");<br>  }<br>}<br> <br>//Powered by [KawigiEdit]<br></td>