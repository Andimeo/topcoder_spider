<td class="problemText" colspan="8" valign="middle" align="left">
            imports system<br> <br>Public Class QueenInterference<br>    Private thisRnd As Integer = 1<br> <br>    Private Function rnd() As Integer<br>        Dim tmp As Int64<br>        Dim ret As Integer<br> <br>        ret = thisRnd<br> <br>        tmp = thisRnd<br>        tmp = tmp * 16807<br>        tmp = tmp Mod 2147483647<br>        thisRnd = tmp<br> <br>        Return ret<br>    End Function<br> <br>    Private Function isReachable(ByVal q1r As Integer, ByVal q1c As Integer, ByVal q2r As Integer, ByVal q2c As Integer) As Boolean<br>        If q1r = q2r Then<br>            Return True<br>        ElseIf q1r - q1c = q2r - q2c Then<br>            Return True<br>        ElseIf q1r + q1c = q2r + q2c Then<br>            Return True<br>        End If<br>    End Function<br> <br>    Private Function alterationStep(ByVal n As Integer, ByVal col() As Integer) As Boolean<br>        Dim i, j, countReach, selCol, posReach(n - 1), min, countTie, selRow As Integer<br>        Dim reach(n - 1) As Boolean<br> <br>        For i = 0 To n - 1<br>            For j = i + 1 To n - 1<br>                If isReachable(col(i) + 1, i + 1, col(j) + 1, j + 1) Then<br>                    reach(i) = True<br>                    reach(j) = True<br>                End If<br>            Next<br>        Next<br>        For i = 0 To n - 1<br>            If reach(i) Then<br>                countReach += 1<br>            End If<br>        Next<br>        If countReach = 0 Then Return True<br>        selCol = rnd() Mod countReach<br>        i = 0<br>        While selCol &gt;= 0<br>            If reach(i) Then<br>                selCol -= 1<br>            End If<br>            i += 1<br>        End While<br>        selCol = i - 1<br>        min = 1000<br>        For i = 0 To n - 1<br>            For j = 0 To n - 1<br>                If j &lt;&gt; selCol AndAlso isReachable(i + 1, selCol + 1, col(j) + 1, j + 1) Then<br>                    posReach(i) += 1<br>                End If<br>            Next<br>            min = Math.Min(min, posReach(i))<br>        Next<br>        For i = 0 To n - 1<br>            If posReach(i) = min Then countTie += 1<br>        Next<br>        If countTie &gt; 1 Then selRow = rnd() Mod countTie<br>        i = 0<br>        While selRow &gt;= 0<br>            If posReach(i) = min Then<br>                selRow -= 1<br>            End If<br>            i += 1<br>        End While<br>        selRow = i - 1<br>        col(selCol) = selRow<br>    End Function<br> <br>    Public Function numSteps(ByVal n As Integer) As Integer<br>        Dim col(n - 1), i, alteration As Integer<br> <br>        For i = 0 To n - 1<br>            col(i) = rnd() Mod n<br>        Next<br> <br>        Do<br>            If alterationStep(n, col) Then Exit Do<br>            alteration += 1<br>        Loop<br> <br>        Return alteration<br>    End Function<br>End Class<br></td>