<td class="problemText" colspan="8" valign="middle" align="left">
            Imports System.Math<br>Imports Microsoft.VisualBasic<br>Public Class PseudoPrimeTest<br>    Public Function firstFail(ByVal q As Integer) As Integer<br> <br>        Dim ret As Integer = 2<br>        Dim i As Integer<br> <br>        For i = 2 To q<br>            If LT(i, q) &lt;&gt; 1 Then<br>                Return i<br>            End If<br>        Next<br>        Return q<br> <br> <br>    End Function<br> <br> <br>    Private Function LT(ByVal b As Integer, ByVal q As Integer) As Integer<br>        Return LTs(b, q - 1, q)<br>    End Function<br> <br>    Private Function LTs(ByVal b As Integer, ByVal c As Integer, ByVal q As Integer) As Integer<br>        If c = 2 Then<br>            Return CInt((b ^ 2) Mod q)<br>        End If<br>        If c = 3 Then<br>            Return (LTs(b, 2, q) * (b Mod q)) Mod q<br>        End If<br> <br>        Dim half As Integer = CInt(Fix(c / 2))<br>        If c Mod 2 = 0 Then<br>            Return CInt((LTs(b, half, q) ^ 2) Mod q)<br>        Else<br>            Return (b * LTs(b, c - 1, q)) Mod q<br>        End If<br> <br> <br>    End Function<br> <br> <br>End Class<br></td>