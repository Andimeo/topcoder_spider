<td class="problemText" colspan="8" valign="middle" align="left">
            using System; using System.Collections; public class Volleyball<br>{<br>  public double win(int S, int R, double P) {<br>    double Q = 1-P;<br>    <br>    if (S&gt;14 || R&gt;14) { int m=Math.Min(R,S)-14; S-=m; R-=m; }<br>    <br>    // double[a,b,c] = probability of reaching score where team A has a and team B has b<br>    // Team a is serving if c==0<br>    double[,,] p = new double[17,17,2];<br>    p[S,R,0]=1;<br>    <br>    for (int i=0; i&lt;16; i++) for (int j=0; j&lt;16; j++) for (int k=0; k&lt;2; k++)<br>    {<br>      double cur = p[i,j,k];<br>      if (i&gt;=15) continue;<br>      if (j&gt;=15) continue;<br>      if (k==0)<br>      {<br>        p[i+1,j,k] += cur*P;<br>        p[i,j+1,1-k] += cur*Q;<br>      }<br>      else<br>      {<br>        p[i,j+1,k] += cur*P;<br>        p[i+1,j,1-k] += cur*Q;<br>      }<br>    }<br>    <br>    double sWin=0;<br>    for (int i=0; i&lt;=13; i++) sWin += p[15,i,0] + p[15,i,1];<br>    <br>    double I=p[14,15,1], J=p[15,14,0], K=p[15,15,0], L=p[15,15,1];<br>    for (int t=0; t&lt;1000000; t++)<br>    {<br>      sWin += J*P;<br>      double I2=K*Q + L*P;<br>      double J2=K*P + L*Q;<br>      double K2=I*Q;<br>      double L2=J*Q;<br>      I=I2; J=J2; K=K2; L=L2;<br>    }<br>    <br>    return sWin;<br>}<br> <br> <br>static ArrayList AR { get { return new ArrayList(); }}<br>static Hashtable MAP { get { return new Hashtable(); }}<br> <br>static int   [] IA(ArrayList ar) { return (int   []) ar.ToArray(typeof(int   )); }<br>static string[] SA(ArrayList ar) { return (string[]) ar.ToArray(typeof(string)); }<br> <br>int    INT   (Object x) { return Convert.ToInt32 (x.ToString()); }<br>long   LONG  (Object x) { return Convert.ToInt64 (x.ToString()); }<br>double DOUBLE(Object x) { return Convert.ToDouble(x.ToString()); }<br> <br>static void WR(Object x, params object[] p) { Console.Write(x.ToString(), p); }<br>static void WL(Object x, params object[] p) { Console.WriteLine(x.ToString(), p); }<br>static void WL() { WL(""); }<br>static void WS(params Object[] c) { foreach (Object x in c) WR(x.ToString() + " "); }<br>static void WSL(params Object[] c) { foreach (Object x in c) WR(x.ToString() + " "); WL(); }<br>static void WS(Array ar, int X) { for (int x=0; x&lt;X; x++) WS(ar.GetValue(x)); WL(); }<br>static void WS(Array ar, int X, int Y) { for (int y=0; y&lt;Y; y++) { for (int x=0; x&lt;X; x++) WS(ar.GetValue(x,y)); WL(); }}}<br> <br>// Powered by PopsEdit<br></td>