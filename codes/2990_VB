<td class="problemText" colspan="8" valign="middle" align="left">
            Option Explicit On <br>Option Strict On<br> <br>Imports System<br>Imports System.Collections<br> <br>Public Class Rank<br>    Public Function rank(ByVal scores As Integer()) As Double()<br>        Dim scc(scores.Length - 1) As Integer<br>        Dim tc As Integer<br>        Dim mc As Integer = scores.Length<br>        Dim rk(mc - 1) As Integer<br>        Dim els As New SortedList<br>        Dim last As elem<br>        Dim ret(mc - 1) As Double<br> <br>        Array.Copy(scores, scc, scores.Length)<br>        Array.Sort(scc)<br>        Array.Reverse(scc)<br>        last = New elem(scc(0), 1)<br>        els.Add(last.val, last)<br>        For tc = 1 To mc - 1<br>            If scc(tc) = last.val Then<br>                last.count += 1<br>            Else<br>                last = New elem(scc(tc), tc + 1)<br>                els.Add(last.val, last)<br>            End If<br>        Next<br>        For tc = 0 To mc - 1<br>            last = CType(els.Item(scores(tc)), elem)<br>            ret(tc) = last.Avg<br>        Next<br>        Return ret<br>    End Function<br>    Friend Class elem<br>        Public val As Integer<br>        Public pos As Integer<br>        Public count As Integer<br> <br>        Public Sub New(ByVal wv As Integer, ByVal wp As Integer)<br>            val = wv<br>            pos = wp<br>            count = 1<br>        End Sub<br>        Public Function Avg() As Double<br>            Dim tc As Integer<br>            Dim sum As Integer<br> <br>            For tc = 1 To count<br>                sum = sum + pos + tc - 1<br>            Next<br>            Return sum / count<br>        End Function<br>    End Class<br>End Class<br></td>