<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br> <br>public class grafixDither<br>{<br>  private int letter2int(char c)<br>  {<br>    if ('a' &lt;= c &amp;&amp; c &lt;= 'z') return 5 * ((int)c - (int)'a');<br>    else return 130 + 5 * ((int)c - (int)'A');<br>  }<br> <br>  int error = 0;<br>  char[,] r;<br>  string[] field;<br> <br>  private void go(int i, int j, int dir, int beg, int n)<br>  {<br>    n /= 2;<br>    if (n == 0)<br>    {<br>      int t1, t2, t3;<br>      t1 = letter2int(field[i][j]);<br>      t2 = t1 + error;<br>      if (t2 &lt; 0) t2 = 0;<br>      else if (t2 &gt; 255) t2 = 255;<br>      if (t2 &lt; 128){ t3 = 0; r[i,j] = 'B'; }<br>      else{ t3 = 255; r[i,j] = 'W'; }<br>      error = t2 - t3;<br>    }<br>    else if (beg == 0)<br>    {<br>      if (dir == 1)<br>      {<br>        go(i, j, 4, 1, n);<br>        go(i+n, j, 1, 0, n);<br>        go(i+n, j+n, 1, 0, n);<br>        go(i, j+n, 2, 1, n);<br>      }<br>      else if ( dir == 2)<br>      {<br>        go(i, j+n, 1, 1, n);<br>        go(i, j, 2, 0, n);<br>        go(i+n, j, 2, 0, n);<br>        go(i+n, j+n, 3, 1, n);<br>      }<br>      else if (dir == 3)<br>      {<br>        go(i+n, j+n, 2, 1, n);<br>        go(i, j+n, 3, 0, n);<br>        go(i, j, 3, 0, n);<br>        go(i+n, j, 4, 1, n);<br>      }<br>      else<br>      {<br>        go(i+n, j, 3, 1, n);<br>        go(i+n, j+n, 4, 0, n);<br>        go(i, j+n, 4, 0, n);<br>        go(i, j, 1, 1, n);<br>      }<br>    }<br>    else<br>    {<br>      if (dir == 1)<br>      {<br>        go(i, j+n, 2, 0, n);<br>        go(i+n, j+n, 1, 1, n);<br>        go(i+n, j, 1, 1, n);<br>        go(i, j, 4, 0, n);<br>      }<br>      else if ( dir == 2)<br>      {<br>        go(i+n, j+n, 3, 0, n);<br>        go(i+n, j, 2, 1, n);<br>        go(i, j, 2, 1, n);<br>        go(i, j+n, 1, 0, n);<br>      }<br>      else if (dir == 3)<br>      {<br>        go(i+n, j, 4, 0, n);<br>        go(i, j, 3, 1, n);<br>        go(i, j+n, 3, 1, n);<br>        go(i+n, j+n, 2, 0, n);<br>      }<br>      else<br>      {<br>        go(i, j, 1, 0, n);<br>        go(i, j+n, 4, 1, n);<br>        go(i+n, j+n, 4, 1, n);<br>        go(i+n, j, 3, 0, n);<br>      }<br>    }<br>  }<br> <br>  public string[] gray2bwRiemersma(string[] field2)<br>  {<br>    int n = field2.Length;<br>    int i, j;<br>    field = new String[n];<br>    for (i = 0; i &lt; n; i++) field[i] = field2[i];<br>    r = new char[n,n];<br>    go(0,0,1,0,n);<br>    string[] res = new string[n];<br>    for (i = 0; i &lt; n; i++)<br>    {<br>      res[i] = "";<br>      for (j = 0; j &lt; n; j++) res[i] += r[i,j];<br>    }<br>    return res;<br>  }<br>}<br></td>