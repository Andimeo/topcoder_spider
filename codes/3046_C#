<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br> <br>public class MultiReplacer<br>{<br> <br>  long[,] mulm(long[,] a, long[,] b, int m)<br>  {<br>    long[,] r = new long[3, 3];<br>    for (int i = 0; i &lt; 3; i++)<br>      for (int j = 0; j &lt; 3; j++)<br>        r[i, j] = 0;<br>        <br>    for (int i = 0; i &lt; 3; i++)<br>      for (int j = 0; j &lt; 3; j++)<br>        for (int k = 0; k &lt; 3; k++)<br>          r[i, k] = (r[i, k] + a[i, j] * b[j, k]) % m;<br>          <br>    return r;<br>  }<br> <br> <br>  public long length(string arep, string brep, string crep, int iter, int m)<br>  {<br>    long[,] a = new long[3, 3];<br>    for (int i = 0; i &lt; 3; i++)<br>      for (int j = 0; j &lt; 3; j++)<br>        a[i, j] = 0;<br>        <br>    for (int i = 0; i &lt; arep.Length; i++)<br>      a[(int)arep[i] - 'a', 0]++;<br>      <br>    for (int i = 0; i &lt; brep.Length; i++)<br>      a[(int)brep[i] - 'a', 1]++;<br>      <br>    for (int i = 0; i &lt; crep.Length; i++)<br>      a[(int)crep[i] - 'a', 2]++;<br>      <br>    <br>    long[,] r = new long[3,3];<br>    for (int i = 0; i &lt; 3; i++)<br>      for (int j = 0; j &lt; 3; j++)<br>        r[i, j] = 0;<br>    for (int i = 0; i &lt; 3; i++)<br>      r[i, i] = 1;<br>    <br>    long[,] t = new long[3,3];<br>    for (int i = 0; i &lt; 3; i++)<br>      for (int j = 0; j &lt; 3; j++)<br>        t[i, j] = a[i, j];<br>    <br>        <br>    while (iter &gt; 0) {<br>      if (iter % 2 == 1) {<br>        r = mulm(r, t, m);<br>      }<br>      <br>      iter = iter / 2;<br>      <br>      t = mulm(t, t, m);    <br>    }<br> <br>      <br>    return ((r[0, 0] + r[1, 0] + r[2, 0]) % m);<br>  }<br> <br>  [STAThread]<br>  static void Main(string[] args)<br>  {<br>    MultiReplacer obj = new MultiReplacer();<br>    obj.length("abc", "c", "ba", 3, 7);<br>  }<br>}<br></td>