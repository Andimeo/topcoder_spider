<td class="problemText" colspan="8" valign="middle" align="left">
            public class MultiReplacer {<br>    long MOD = 42;<br>    long[] count(String s) {<br>  long[] x = new long[3];<br>  for(int i=s.length();i--&gt;0;) x[s.charAt(i)-'a']++;<br>  return x;<br>    }<br>    long [][] mul(long A[][], long B[][]) {<br>  long M[][] = new long[3][3];<br>  for(int a=3;a--&gt;0;) <br>  for(int m=3;m--&gt;0;) <br>      for(int b=3;b--&gt;0;) {<br>    M[a][b] = (M[a][b] + A[a][m]*B[m][b]) % MOD;<br>      }<br>  return M;<br>    }<br>public long length(String arep, String brep, String crep, int iter, int m) {<br>    MOD = m;<br>    long mul[][] = new long[][] { <br>  count(arep),count(brep),count(crep)};<br>    long start[][] = new long[][] {{1,0,0},{0,1,0},{0,0,1}};<br>    long max = iter;<br>    long c = 1;<br>    for(long t = 1 ; t &lt;= max; t*=2) {<br>  if((t&amp;max)&gt;0) start = mul(start, mul);<br>  mul = mul(mul, mul);<br>    }<br>    return (start[0][0]+start[0][1]+start[0][2]) % MOD;<br>}<br>}<br></td>