<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class HeartsGame<br>        Private Enum aRules<br>            iPlayedScore = 0<br>            iPlayedSpade = 1<br>            iPlayedHeart = 2<br>            iPlayedDiamond = 3<br>            iPlayedClub = 4<br>            iBrokeHeart = 5<br>            iCheater = 6<br>        End Enum<br> <br>        Private aPlayerRules(3, 6) As Boolean<br>        Private iPlayerPoints(3) As Integer<br> <br>        Public Function score(ByVal tricks As String()) As String()<br>            Dim i, j, k As Integer<br> <br>            For i = 0 To 3<br>                iPlayerPoints(i) = 0<br>                For j = 0 To 6<br>                    aPlayerRules(i, j) = False<br>                Next<br>            Next<br> <br>            Dim iPlayerStart As Integer = 0<br> <br>            Dim sSuit As String<br>            Dim sTrick As String<br>            Dim iWinner As Integer<br>            Dim iWin As Integer<br>            Dim sHands() As String<br>            Dim bHeartBroke As Boolean = False<br>            Dim iHandPoint As Integer<br> <br>            For i = 0 To 12<br>                iHandPoint = 0<br>                sTrick = tricks(i)<br>                sHands = sTrick.Split(" ")<br>                iWinner = 0<br> <br>                For j = 0 To 3<br>                    sHands(j) = sHands(j).Substring(1, 1) &amp; sHands(j).Substring(0, 1)<br>                Next<br> <br>                iWin = iCardVal(sHands(0).Substring(0, 1))<br>                sSuit = sHands(0).Substring(1, 1)<br> <br>                For j = 0 To 3<br>                    If aPlayerRules((j + iPlayerStart) Mod 4, 0) Then<br>                        If sHands(j).Substring(1, 1) &lt;&gt; "H" And sHands(j) &lt;&gt; "QS" Then<br>                            aPlayerRules((j + iPlayerStart) Mod 4, 6) = True<br>                        End If<br>                    End If<br>                Next<br> <br>                For j = 0 To 3<br>                    If aPlayerRules((j + iPlayerStart) Mod 4, 5) Then<br>                        If sHands(j).Substring(1, 1) &lt;&gt; "H" Then<br>                            aPlayerRules((j + iPlayerStart) Mod 4, 6) = True<br>                        End If<br>                    End If<br>                Next<br> <br>                For j = 0 To 3<br>                    For k = 1 To 4<br>                        If aPlayerRules((j + iPlayerStart) Mod 4, iSuitNum(sHands(j).Substring(1, 1))) Then<br>                            aPlayerRules((j + iPlayerStart) Mod 4, 6) = True<br>                        End If<br>                    Next<br>                Next<br> <br>                If sHands(0).Substring(1, 1) = "H" And Not bHeartBroke Then<br>                    aPlayerRules(iPlayerStart, 5) = True<br>                End If<br> <br>                For j = 1 To 3<br>                    If sHands(j).Substring(1, 1) = "H" Then<br>                        bHeartBroke = True<br>                    End If<br>                Next<br> <br>                For j = 1 To 3<br>                    If sSuit = sHands(j).Substring(1, 1) Then<br>                        If iCardVal(sHands(j).Substring(0, 1)) &gt; iWin Then<br>                            iWinner = j<br>                            iWin = iCardVal(sHands(j).Substring(0, 1))<br>                        End If<br>                    End If<br>                Next<br> <br>                If i = 0 Then<br>                    For j = 0 To 3<br>                        If sHands(j).Substring(1, 1) = "H" Or sHands(j) = "QS" Then<br>                            aPlayerRules(j, 0) = True<br>                        End If<br>                    Next<br>                End If<br> <br>                For j = 1 To 3<br>                    If sHands(j).Substring(1, 1) &lt;&gt; sHands(0).Substring(1, 1) Then<br>                        aPlayerRules((iPlayerStart + j) Mod 4, iSuitNum(sHands(0).Substring(1, 1))) = True<br>                    End If<br>                Next<br> <br>                For j = 0 To 3<br>                    If sHands(j).Substring(1, 1) = "H" Then iHandPoint += 1<br>                    If sHands(j) = "QS" Then iHandPoint += 13<br>                Next<br> <br>                iPlayerStart = (iPlayerStart + iWinner) Mod 4<br> <br>                iPlayerPoints(iPlayerStart) += iHandPoint<br>            Next<br> <br>            Dim bShot As Boolean<br>            For j = 0 To 3<br>                If iPlayerPoints(j) = 26 Then<br>                    bshot = True<br>                End If<br>            Next<br> <br>            If bShot Then<br>                For j = 0 To 3<br>                    If iPlayerPoints(j) = 26 Then<br>                        iPlayerPoints(j) = 0<br>                    Else<br>                        iPlayerPoints(j) = 26<br>                    End If<br>                Next<br>            End If<br> <br>            Dim sRet(3) As String<br>            For j = 0 To 3<br>                sRet(j) = iPlayerPoints(j)<br>                If aPlayerRules(j, 6) Then<br>                    sRet(j) = "CHEATER!"<br>                End If<br>            Next<br> <br>            Return sRet<br>        End Function<br> <br>        Private Function iSuitNum(ByVal sSuit As String) As Integer<br>            Select Case sSuit<br>                Case "S"<br>                    Return 1<br>                Case "H"<br>                    Return 2<br>                Case "D"<br>                    Return 3<br>                Case "C"<br>                    Return 4<br>            End Select<br>        End Function<br> <br>        Private Function iCardVal(ByVal s As String) As Integer<br>            If s &gt;= "2" And s &lt;= "9" Then Return CInt(s)<br>            If s = "T" Then Return 10<br>            If s = "J" Then Return 11<br>            If s = "Q" Then Return 12<br>            If s = "K" Then Return 13<br>            If s = "A" Then Return 14<br>        End Function<br>    End Class<br></td>