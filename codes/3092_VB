<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br> <br>Public Class ParameterSubstitution<br>    Public Function processParams(ByVal code As String, ByVal params As String()) As String<br>        Dim i, paramNum, newParamNum As Integer<br>        Dim ret, tmp As String<br> <br>        ret = ""<br>        While i &lt; code.Length<br>            If code.Chars(i) = "$" Then<br>                tmp = "$"<br>                paramNum = 0<br>                While i + 1 &lt; code.Length AndAlso Char.IsDigit(code.Chars(i + 1))<br>                    newParamNum = paramNum * 10 + Val(code.Chars(i + 1))<br>                    If newParamNum &lt; 1 OrElse newParamNum &gt; params.Length Then Exit While<br>                    i += 1<br>                    paramNum = newParamNum<br>                    tmp &amp;= code.Chars(i)<br>                End While<br>                If paramNum &gt;= 1 AndAlso paramNum &lt;= params.Length Then ret &amp;= params(paramNum - 1) Else ret &amp;= tmp<br>            Else<br>                ret &amp;= code.Chars(i)<br>            End If<br>            i += 1<br>        End While<br> <br>        Return ret<br>    End Function<br>End Class<br></td>