<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br> <br>public class TurntableService<br>{<br>  private int n,k;<br>  private int[,] dp;<br>  private int[][] f;<br>  private int[] food;<br> <br>  private int getfood(int p)<br>  {<br>    int i,r;<br>    r=0;<br>    for (i=0; i&lt;n; i++)<br>    {<br>      if (Array.IndexOf(f[i],p)!=-1) r|=(1&lt;&lt;i);<br>      p=(p+1)%n;<br>    }<br>    return r;<br>  }<br> <br>  private void relax(int i,int j,int val)<br>  {<br>    if (dp[i,j]==-1) dp[i,j]=val;<br>    else dp[i,j]=Math.Min(dp[i,j],val);<br>  }<br> <br>  public int calculateTime(string[] fav)<br>  {<br>    n=fav.Length;<br>    f=new int[n][];<br>    int i,j,min;<br>    k=1&lt;&lt;n;<br>    dp=new int[n,k];<br>    for (i=0; i&lt;n; i++)<br>    {<br>      string[] ss=fav[i].Split(' ');<br>      f[i]=new int[ss.Length];<br>      for (j=0; j&lt;f[i].Length; j++)<br>        f[i][j]=int.Parse(ss[j]);<br>    }<br>    for (i=0; i&lt;n; i++)<br>      for (j=0; j&lt;k; j++) dp[i,j]=-1;<br>    food=new int[n];<br>    for (i=0; i&lt;n; i++) food[i]=getfood(i);<br> <br>    dp[0,0]=0;<br>    for (j=0; j&lt;k; j++)<br>      for (i=0; i&lt;n; i++)<br>        if (dp[i,j]!=-1)<br>        {<br>          int t=food[i]|j;<br>          if (t!=j) relax(i,t,dp[i,j]+15);<br>          for (int p=0; p&lt;n; p++)<br>          {<br>            int d=Math.Min((p-i+n)%n,(i-p+n)%n);<br>            if (d!=0)<br>            {<br>              t=food[p]|j;<br>              if (t!=j) relax(p,t,dp[i,j]+(d+1)+15);<br>            }<br>          }<br>        }<br> <br>    min=int.MaxValue;<br>    for (i=0; i&lt;n; i++)<br>      if (dp[i,k-1]!=-1)<br>        min=Math.Min(min,dp[i,k-1]);<br>    return min;<br>  }<br>}<br></td>