<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br><br>public class SantaClaus {<br>  public int[] exchange(string[] value) {<br>    int n = value.Length * 2;<br>    int[,] g = new int[n, n];<br>    for (int i = 0; i &lt; value.Length; ++i)<br>      for (int j = 0; j &lt; value.Length; ++j)<br>      {<br>        char c = value[i][j];<br><br>        if (i == j)<br>          g[j + value.Length, i] = -((c - 'A') + 1);<br>        else<br>          g[i, j + value.Length] = ((c - 'A') + 1);<br>      }<br><br>    int res = n + 1;<br>    int rbest = 0;<br><br>    for (int start = 0; start &lt; value.Length; ++start)<br>    {<br>      int[,] l = new int[2, n];<br>      for (int i = 0; i &lt; n; ++i)<br>        l[0, i] = int.MinValue;<br>      l[0, start] = 0;<br>      int cur = 0;<br>      for (int s = 1; s &lt;= n &amp;&amp; s &lt;= res; ++s)<br>      {<br>        int prev = cur;<br>        cur = 1 - cur;<br>        for (int i = 0; i &lt; n; ++i)<br>          l[cur, i] = int.MinValue;<br>        for (int i = 0; i &lt; n; ++i)<br>          if (l[prev, i] &gt; int.MinValue)<br>            for (int j = 0; j &lt; n; ++j)<br>              if (g[i, j] != 0)<br>              {<br>                if (l[prev, i] + g[i, j] &gt; l[cur, j])<br>                {<br>                  l[cur, j] = l[prev, i] + g[i, j];<br>                }<br>              }<br>        if (l[cur, start] &gt; 0)<br>        {<br>          if (res &gt; s)<br>            rbest = 0;<br>          res = s;<br>          if (l[cur, start] &gt; rbest)<br>            rbest = l[cur, start];<br><br>          break;<br>        }<br>      }<br>    }<br><br>    if (res &gt; n)<br>      return new int[]{0, 0};<br>    else<br>      return new int[]{res / 2, rbest};<br>  }<br><br>  <br><br>}<br><br><br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003] [modified for C# by Petr]<br>// Powered by CodeProcessor<br></td>