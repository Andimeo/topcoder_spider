<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class ChessTournament<br>    Public Function nextRound(ByVal score As Integer(), ByVal rating As Integer()) As Integer()<br>        Dim i, j, tmp, start, finish, mid As Integer<br>        Dim ret(score.Length - 1), map(score.Length - 1) As Integer<br> <br>        For i = 0 To map.Length - 1<br>            map(i) = i<br>        Next<br>        For i = 0 To score.Length - 2<br>            For j = score.Length - 2 To i Step -1<br>                If score(j) &lt; score(j + 1) Then<br>                    tmp = score(j) : score(j) = score(j + 1) : score(j + 1) = tmp<br>                    tmp = rating(j) : rating(j) = rating(j + 1) : rating(j + 1) = tmp<br>                    tmp = map(j) : map(j) = map(j + 1) : map(j + 1) = tmp<br>                ElseIf score(j) = score(j + 1) AndAlso rating(j) &lt; rating(j + 1) Then<br>                    tmp = score(j) : score(j) = score(j + 1) : score(j + 1) = tmp<br>                    tmp = rating(j) : rating(j) = rating(j + 1) : rating(j + 1) = tmp<br>                    tmp = map(j) : map(j) = map(j + 1) : map(j + 1) = tmp<br>                End If<br>            Next<br>        Next<br> <br>        start = 0<br>        While start &lt; score.Length<br>            While finish &lt; score.Length AndAlso score(start) = score(finish)<br>                finish += 1<br>            End While<br>            If (finish - start) Mod 2 = 1 Then finish += 1<br>            mid = (start + finish) \ 2<br>            For i = start To mid - 1<br>                ret(map(i)) = map(mid + i - start)<br>                ret(map(mid + i - start)) = map(i)<br>            Next<br>            start = finish<br>        End While<br>        Return ret<br>    End Function<br>End Class<br></td>