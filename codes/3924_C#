<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using math = System.Math;<br> <br>public class CommunicableDisease<br>{<br>  public string findSource(string[] contact, string results)<br>  {<br>    int nr,n;<br>    n = results.Length;<br>    nr = (contact[0].Split(' ')).Length;<br>    bool[,,] mix = new bool[nr+1,n,n];<br>    int[,] whom = new int[nr, n];<br> <br> <br>    int i,j;<br>    for(i=0;i&lt;n;i++)<br>    {<br>      string[] ss = contact[i].Split(' ');<br>      for(j=0;j&lt;nr;j++)<br>        whom[j,i] = int.Parse(ss[j]);<br> <br>    }<br>    for(i=0;i&lt;n;i++)<br>      for(j=0;j&lt;n;j++)<br>        mix[0,i,j] = i==j;<br>    for(int l=0;l&lt;nr;l++)<br>    {<br>      for(i=0;i&lt;n;i++)<br>        for(j=0;j&lt;n;j++)<br>          mix[l+1,i,j] = mix[l,i,j];<br>      for(i=0;i&lt;n;i++)<br>        for(j=0;j&lt;n;j++)<br>          mix[l+1, whom[l,i],j] |= mix[l,i,j];<br>    }<br> <br>    int[] has = new int[n];<br>    for(i=0;i&lt;n;i++)<br>      has[i] = 0;<br>    for(i=0;i&lt;n;i++)<br>      if (results[i] == 'N')<br>        for(j=0;j&lt;n;j++)<br>          if (mix[nr,i,j])<br>            has[j] = -1;<br>    for(i=0;i&lt;n;i++)<br>      if (results[i] == 'C')<br>      {<br>        int nok, nbad;<br>        int ii1=0;<br>        nok = nbad = 0;<br>        for(j=0;j&lt;n;j++)<br>          if (mix[nr, i,j])<br>          {<br>            if (has[j] &lt; 0) nbad++;<br>            else <br>            {<br>               ii1 = j;<br>              nok++;<br>            }<br>          }<br>        if (nok &lt; 1) return "INVALID";<br>        if (nok == 1) has[ii1] = 1;<br>      }<br>    string res = "";<br>    for(i=0;i&lt;n;i++)<br>    {<br>      if (has[i] &lt; 0)  res += "N";<br>      if (has[i] == 0) res += "I";<br>      if (has[i] &gt; 0)  res += "C";<br>    }<br>    return res;<br>  }<br>}<br></td>