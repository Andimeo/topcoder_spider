<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class CultureGrowth<br>        Dim x() As Integer<br>        Dim y() As Integer<br>        Dim g() As Double<br>        Dim c() As Double<br>        Dim xMin() As Integer<br>        Dim xMax() As Integer<br>        Dim iLineCount As Integer<br> <br>        Public Function finalTray(ByVal xs As Integer(), ByVal ys As Integer()) As Double<br>            Dim i, j, k As Integer<br> <br>            If xs.GetUpperBound(0) &lt;= 1 Then Return 0<br> <br>            Dim iTemp As Integer<br> <br>            For i = 0 To xs.GetUpperBound(0) - 1<br>                For j = i + 1 To xs.GetUpperBound(0)<br>                    If xs(j) &lt; xs(i) Then<br>                        iTemp = xs(j)<br>                        xs(j) = xs(i)<br>                        xs(i) = iTemp<br>                        iTemp = ys(j)<br>                        ys(j) = ys(i)<br>                        ys(i) = iTemp<br>                    End If<br> <br>                Next<br>            Next<br>            ReDim g((xs.GetUpperBound(0) + 1) ^ 2)<br>            ReDim c((xs.GetUpperBound(0) + 1) ^ 2)<br>            ReDim xMin((xs.GetUpperBound(0) + 1) ^ 2)<br>            ReDim xMax((xs.GetUpperBound(0) + 1) ^ 2)<br>            x = xs<br>            y = ys<br>            k = 0<br>            For i = 0 To xs.GetUpperBound(0) - 1<br>                For j = i + 1 To xs.GetUpperBound(0)<br>                    g(k) = CDbl((y(j) - y(i))) / (x(j) - x(i))<br>                    c(k) = y(i) - g(k) * x(i)<br>                    xMin(k) = System.Math.Min(x(j), x(i))<br>                    xMax(k) = System.Math.Max(x(j), x(i))<br>                    k += 1<br>                Next<br>            Next<br> <br>            iLineCount = k - 1<br>            Dim dTot As Double<br> <br>            For i = 0 To xs.GetUpperBound(0) - 1<br>                dTot += dArea(i)<br>            Next<br> <br>            Return dTot<br> <br> <br>        End Function<br> <br>        Private Function dArea(ByVal i As Integer) As Double<br>            Dim iHighest1, iHighest2 As Double<br>            Dim iLowest1, iLowest2 As Double<br> <br>            Dim j, k, l As Integer<br>            iHighest1 = -1<br>            iHighest2 = -1<br>            iLowest1 = 20000<br>            iLowest2 = 20000<br> <br>            For j = 0 To iLineCount<br>                If xMin(j) &lt;= x(i) And xMax(j) &gt;= x(i + 1) Then<br>                    If g(j) * x(i) + c(j) &gt; iHighest1 Then iHighest1 = g(j) * x(i) + c(j)<br>                    If g(j) * x(i + 1) + c(j) &gt; iHighest2 Then iHighest2 = g(j) * x(i + 1) + c(j)<br>                    If g(j) * x(i) + c(j) &lt; iLowest1 Then iLowest1 = g(j) * x(i) + c(j)<br>                    If g(j) * x(i + 1) + c(j) &lt; iLowest2 Then iLowest2 = g(j) * x(i + 1) + c(j)<br>                End If<br>            Next<br> <br>            Return (x(i + 1) - x(i)) * (iHighest1 - iLowest1 + iHighest2 - iLowest2) / 2<br> <br>        End Function<br>    End Class<br></td>