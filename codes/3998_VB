<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class WeirdRooks<br>        Private aPoss(,) As Boolean<br>        Private aCol() As Boolean<br>        Private aRow() As Boolean<br>        Private iRooks As Integer<br>        Private iBottomRook As Integer<br>        Private aCols() As Integer<br>        Private iSpecial As Integer<br>        Private iMin As Integer<br>        Private aBoard(,) As Integer<br> <br>        Public Function describe(ByVal cols As Integer()) As String<br>            Dim i, j As Integer<br>            Dim iMax As Integer = 0<br>            Dim iTot As Integer<br>            For i = 0 To cols.GetUpperBound(0)<br>                iMax = System.Math.Max(iMax, cols(i))<br>                iTot += cols(i)<br>            Next<br> <br>            aCols = cols<br> <br>            iMin = System.Math.Min(iMax - 1, cols.GetUpperBound(0))<br> <br>            ReDim aPoss(iMin + 1, iTot)<br>            ReDim aBoard(cols.GetUpperBound(0), iMax - 1)<br> <br>            For i = 0 To aBoard.GetUpperBound(0)<br>                For j = 0 To cols(i) - 1<br>                    aBoard(i, j) = 0<br>                Next<br>                For j = cols(i) To iMax - 1<br>                    aBoard(i, j) = -1<br>                Next<br>            Next<br> <br>            For i = 0 To aPoss.GetUpperBound(0)<br>                For j = 0 To aPoss.GetUpperBound(1)<br>                    aPoss(i, j) = False<br>                Next<br>            Next<br> <br>            aPoss(0, iTot) = True<br> <br>            ReDim aRow(cols.GetUpperBound(0))<br>            ReDim aCol(iMax - 1)<br>            For i = 0 To aRow.GetUpperBound(0)<br>                aRow(i) = False<br>            Next<br>            For i = 0 To aCol.GetUpperBound(0)<br>                aCol(i) = False<br>            Next<br> <br>            iBottomRook = -1<br>            iSpecial = iTot<br> <br>            AddNextRook()<br> <br>            Dim sRet As String<br> <br>            For i = 0 To aPoss.GetUpperBound(0)<br>                For j = 0 To aPoss.GetUpperBound(1)<br>                    If aPoss(i, j) Then sRet &amp;= i &amp; "," &amp; j &amp; " "<br>                Next<br>            Next<br> <br>            Return sRet.Trim<br> <br> <br>        End Function<br> <br>        Private Sub AddNextRook()<br>            'If iRooks = 1 And iBottomRook = 0 And aCol(2) = True Then Stop<br>            'If iRooks = 2 And iBottomRook = 1 And aCol(1) = True And iSpecial = 4 Then Stop<br>            Dim i As Integer<br>            Dim j As Integer<br>            Dim k As Integer<br>            Dim iSaveSpecial As Integer<br>            Dim iOldBottom As Integer<br>            iOldBottom = iBottomRook<br>            For i = iBottomRook + 1 To aRow.GetUpperBound(0)<br>                If Not aRow(i) Then<br>                    aRow(i) = True<br>                    iBottomRook = i<br>                    For j = 0 To aCols(i) - 1<br>                        If Not aCol(j) Then<br>                            aCol(j) = True<br>                            For k = 0 To j<br>                                aBoard(i, k) = 1<br>                            Next<br>                            iSaveSpecial = iSpecial<br>                            iSpecial -= 1<br>                            iSpecial -= j<br>                            For k = 0 To i - 1<br>                                If aBoard(k, j) = 0 Then iSpecial -= 1<br>                            Next<br>                            'iSpecial -= i<br>                            iRooks += 1<br>                            aPoss(iRooks, iSpecial) = True<br>                            If iRooks &lt;= iMin Then AddNextRook()<br>                            For k = 0 To j<br>                                aBoard(i, k) = 0<br>                            Next<br>                            iRooks -= 1<br>                            iSpecial = iSaveSpecial<br>                            aCol(j) = False<br>                        End If<br>                    Next<br>                    aRow(i) = False<br>                    iBottomRook = iOldBottom<br>                End If<br>            Next<br>        End Sub<br>    End Class<br></td>