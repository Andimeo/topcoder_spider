<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;string&gt;<br>#include &lt;sstream&gt;<br>#include &lt;iostream&gt;<br>#include &lt;vector&gt;<br>#include &lt;memory.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;limits.h&gt;<br> <br>using namespace std;<br> <br>class AcademicJournal {<br>public:<br>  #define MAX 100<br>  int len,n;<br>  vector &lt;string&gt; jname;<br>  vector &lt;int&gt;  jp[MAX];<br> <br>  int sjp[MAX];<br>  int  f[MAX];<br>  <br>  int v[MAX];<br>  bool a[MAX][MAX];<br> <br>  int addJname(string name)<br>  {<br>    int i;<br> <br>    for (i=0; i&lt;len; ++i)<br>    if (jname[i].compare(name)==0) <br>      return i;<br> <br>    jname.push_back(name);<br>    ++len;<br>    return len-1;<br>  }<br> <br> <br>  void step1(vector &lt;string&gt; papers)<br>  {<br>    int i,vt,x;<br>    string name;<br>    string str;<br> <br>    memset(a,false,sizeof(a));<br>    for (i=0; i&lt;papers.size(); ++i)<br>    {<br>      name = papers[i].substr(0,papers[i].find_first_of("."));<br>      str  = papers[i].substr(papers[i].find_first_of(".")+1);<br>    <br>      vt = addJname(name);<br>      jp[vt].push_back(i);<br> <br>      istringstream iss(str);<br>      while (iss &gt;&gt; x)<br>      {<br>        a[i][x] = true;<br>      }<br>    }<br>  }<br> <br>  int findj(int x)<br>  {<br>    int i,j;<br> <br>    for (i=0; i&lt;len; ++i)<br>    for (j=0; j&lt;jp[i].size(); ++j)<br>    if (jp[i][j] == x) return i;<br> <br>    return -1;<br>  }<br> <br>  void step2()<br>  {<br>    int i,j;<br> <br>    for (i=0; i&lt;n; ++i)<br>      v[i] = findj(i);<br> <br>    memset(f,0,sizeof(f));<br> <br>    for (i=0; i&lt;n; ++i)<br>    for (j=0; j&lt;n; ++j)<br>    if (a[i][j])<br>    {<br>      if (v[i] != v[j])<br>        ++ f[v[j]];<br>    }<br>  }<br> <br>  void step3()<br>  {<br>    int i,j,u,v;<br>    int z;<br> <br>    for (i=0; i&lt;len; ++i)<br>      sjp[i] = jp[i].size();<br> <br>    for (i=0; i&lt;len; ++i)<br>    for (j=i+1;j&lt;len;++j)<br>    {<br>      u = f[i]*sjp[j];<br>      v = f[j]*sjp[i];<br> <br>      if (u&lt;v || (u==v &amp;&amp; ( sjp[i]&lt;sjp[j] || (sjp[i]==sjp[j] &amp;&amp; jname[i].compare(jname[j])&gt;0))))<br>      {<br>        z = f[i];   f[i] = f[j];      f[j] = z;<br>        z = sjp[i]; sjp[i] = sjp[j];  sjp[j] = z;<br> <br>        jname[i].swap(jname[j]);<br>      }<br>    }<br>    <br>  }<br> <br>  vector &lt;string&gt; rankByImpact(vector &lt;string&gt; papers)<br>  {<br>    len = 0;<br>    n = papers.size();<br> <br>    step1(papers);<br>    step2();<br> <br>    // sort<br>    step3();<br> <br>    return jname;<br>  }<br>};<br></td>