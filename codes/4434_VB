<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class LongBlob<br>    Public Function maxLength(ByVal image As String()) As Double<br>        Dim i, j, k, l As Integer<br>        Dim N As Integer = image.GetUpperBound(0)<br>        Dim M As Integer = image(0).Length - 1<br> <br>        Dim aMap(N, M) As Boolean<br>        For i = 0 To N<br>            For j = 0 To M<br>                aMap(i, j) = image(i).Substring(j, 1) = "1"<br>            Next<br>        Next<br> <br>        Dim aBeen(N, M) As Integer<br>        Dim aQX(100000) As Integer<br>        Dim aQY(100000) As Integer<br>        Dim iQS As Integer<br>        Dim iQE As Integer<br>        Dim aDist(N, M) As Integer<br>        Dim lLongest As Integer = 0<br> <br>        Dim dX() As Integer = {1, 0, -1, 0}<br>        Dim dY() As Integer = {0, 1, 0, -1}<br> <br>        Dim a, b, p, q As Integer<br> <br>        For i = 0 To N<br>            For j = 0 To M<br>                For k = 0 To N<br>                    For l = 0 To M<br>                        aDist(k, l) = -1<br>                    Next<br>                Next<br> <br>                aDist(i, j) = 0<br>                If aMap(i, j) Then aDist(i, j) = 1<br>                aQX(50000) = i<br>                aQY(50000) = j<br>                iQE = 50001<br>                iQS = 50000<br> <br>                Do While iQE &gt; iQS<br>                    k = aQX(iQS)<br>                    l = aQY(iQS)<br>                    'If aDist(k, l) = -1 Then Stop<br>                    iQS += 1<br>                    lLongest = Max(lLongest, (i - k) * (i - k) + (j - l) * (j - l))<br>                    For p = 0 To 3<br>                        a = k + dX(p)<br>                        b = l + dY(p)<br>                        If a &gt;= 0 And a &lt;= N And b &gt;= 0 And b &lt;= M Then<br>                            If aDist(a, b) = -1 Then<br>                                If Not aMap(a, b) Then<br>                                    aDist(a, b) = aDist(k, l)<br>                                    'If aDist(a, b) = -1 Then Stop<br>                                    iQS -= 1<br>                                    aQX(iQS) = a<br>                                    aQY(iQS) = b<br>                                Else<br>                                    If aDist(k, l) &lt; 4 Then<br>                                        aDist(a, b) = aDist(k, l) + 1<br>                                        'If aDist(a, b) = -1 Then Stop<br>                                        aQX(iQE) = a<br>                                        aQY(iQE) = b<br>                                        iQE += 1<br>                                    End If<br>                                End If<br>                            End If<br>                        End If<br>                    Next<br>                Loop<br>            Next<br>        Next<br> <br>        Return Sqrt(lLongest)<br>    End Function<br>End Class<br></td>