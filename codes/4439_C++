<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;algorithm&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;cctype&gt;<br>#include &lt;cmath&gt;<br>#include &lt;iostream&gt;<br>#include &lt;sstream&gt;<br>#include &lt;string&gt;<br>#include &lt;utility&gt;<br>#include &lt;vector&gt;<br>using namespace std;<br>#define REP(i,n) for(int _n=n, i=0;i&lt;_n;++i)<br>#define FOR(i,a,b) for(int i=(a),_b=(b);i&lt;=_b;++i)<br>#define MAX(f,w) ({ int _mm=(1&lt;&lt;31); f _mm&gt;?=(w); _mm; })<br>template&lt;class T&gt; inline int size(const T&amp;c) { return c.size(); }<br> <br>const int MAX = 400;<br> <br>bool seg[MAX+1][MAX+1][8];<br>int ile[MAX+1][MAX+1][8];<br> <br>int dx[] = { 1,1,0,-1,-1,-1,0,1};<br>int dy[] = { 0,1,1,1,0,-1,-1,-1};<br> <br>inline int mysgn(int x) {<br>  if(x&gt;0) return 1;<br>  if(x==0) return 0;<br>  return -1;<br>}<br> <br>void mark(int x1,int y1,int x2,int y2) {<br>  int d=0;<br>  while(dx[d]!=mysgn(x2-x1) || dy[d]!=mysgn(y2-y1)) ++d;<br>  while(x1!=x2 || y1!=y2) {<br>    seg[x1][y1][d] = true;<br>    x1+=dx[d]; y1+=dy[d];<br>    seg[x1][y1][(d+4)%8] = true;<br>  }<br>}<br> <br>int calcIle2(int x,int y,int d) {<br>  if(ile[x][y][d]==-1) {<br>    if(seg[x][y][d]) ile[x][y][d] = 1+calcIle2(x+dx[d],y+dy[d],d);<br>    else ile[x][y][d] = 0;<br>  }<br>  return ile[x][y][d];<br>}<br> <br>void calcIle() {<br>  FOR(x,0,MAX) FOR(y,0,MAX) REP(d,8) ile[x][y][d] = -1;<br>  FOR(x,0,MAX) FOR(y,0,MAX) REP(d,8) calcIle2(x,y,d);<br>}<br> <br>int calc() {<br>  int res = 0;<br>  FOR(x,0,MAX) FOR(y,0,MAX) REP(d,8) {<br>    int d1 = (d+2)%8;<br>    int side = d%2==0 ? 1 : 2;<br>    for(int r=1;;++r) {<br>      if(ile[x][y][d] &lt; r || ile[x][y][d1] &lt; r) break;<br>      if(ile[x+r*dx[d]][y+r*dy[d]][(d+3)%8] &gt;= side*r) ++res;<br>    }<br>  }<br>  return res;<br>}<br> <br>struct HiddenTriangles {<br> <br>  // MAIN<br>  int howMany(vector &lt;int&gt; X1, vector &lt;int&gt; Y1, vector &lt;int&gt; X2, vector &lt;int&gt; Y2) {<br>    FOR(x,0,MAX) FOR(y,0,MAX) REP(i,8) seg[x][y][i] = false;<br>    REP(i,size(X1)) {<br>      mark(2*X1[i]+200,2*Y1[i]+200,2*X2[i]+200,2*Y2[i]+200);<br>    }<br>    calcIle();<br>    return calc();<br>  }<br> <br>};<br> <br>// Powered by FileEdit<br> <br>// Powered by TomekAI<br>// Powered by TZTester 1.01 [25-Feb-2003]<br> <br>// Powered by CodeProcessor<br></td>