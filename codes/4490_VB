<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class GuessCard<br>        Public Function whichRow(ByVal width As Integer, ByVal height As Integer, ByVal columns As Integer()) As Integer<br>            Dim bCards(width * height - 1) As Boolean<br>            Dim i, j, k As Integer<br>            For i = 0 To bCards.GetUpperBound(0)<br>                bCards(i) = True<br>            Next<br>            Dim iStep = 1<br>            Dim iConfig(height - 1, width - 1) As Integer<br>            Dim iLastConfig(height - 1, width - 1) As Integer<br> <br>            i = 0<br>            j = 0<br>            k = 0<br>            Dim iOld As Integer<br>            Dim jOld As Integer<br> <br> <br>            Do While j &lt; width<br>                iLastConfig(i, j) = k<br>                i += 1<br>                If i = height Then<br>                    i = 0<br>                    j += 1<br>                End If<br>                k += 1<br>            Loop<br> <br>            For k = 0 To columns.GetUpperBound(0)<br>                iOld = 0<br>                jOld = 0<br>                i = 0<br>                j = 0<br>                Do While i &lt; height<br>                    iConfig(i, j) = iLastConfig(iOld, jOld)<br>                    j += 1<br>                    iOld += 1<br>                    If iOld = height Then<br>                        iOld = 0<br>                        jOld += 1<br>                    End If<br>                    If j = width Then<br>                        j = 0<br>                        i += 1<br>                    End If<br>                Loop<br> <br>                For j = 0 To width - 1<br>                    If columns(k) &lt;&gt; j Then<br>                        For i = 0 To height - 1<br>                            bCards(iConfig(i, j)) = False<br>                        Next<br>                    End If<br>                Next<br> <br>                For i = 0 To height - 1<br>                    For j = 0 To width - 1<br>                        iLastConfig(i, j) = iConfig(i, j)<br>                    Next<br>                Next<br> <br>            Next<br> <br>            k = 0<br>            j = 0<br>            For i = 0 To bCards.GetUpperBound(0)<br>                If bCards(i) = True Then<br>                    k += 1<br>                    j = i<br>                End If<br>            Next<br> <br>            If k &gt; 1 Then Return -1<br>            k = j<br>            For i = 0 To height - 1<br>                For j = 0 To width - 1<br>                    If iConfig(i, j) = k Then Return i<br> <br>                Next<br>            Next<br>        End Function<br>    End Class<br></td>