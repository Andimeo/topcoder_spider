<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class TableSeating<br>        Dim aProbs() As Double<br>        Dim aSizeProbs() As Integer<br>        Dim iNumTables As Integer<br>        Public Function getExpected(ByVal numTables As Integer, ByVal probs As Integer()) As Double<br>            ReDim aProbs(1 &lt;&lt; numTables)<br>            Dim i As Integer<br>            For i = 0 To aProbs.GetUpperBound(0)<br>                aProbs(i) = -1<br>            Next<br> <br>            aSizeProbs = probs<br>            iNumTables = numTables<br> <br>            Return dFindProb(0)<br> <br>        End Function<br> <br>        Private Function dFindProb(ByVal iTableLayout As Integer) As Double<br>            If aProbs(iTableLayout) &gt;= 0 Then<br>                Return aProbs(iTableLayout)<br>            End If<br> <br>            Dim i As Integer<br>            Dim j, k As Integer<br>            Dim dTot As Double = 0<br>            Dim iPoss As Integer<br>            Dim dSubTot As Double<br>            Dim bOkay As Boolean<br>            Dim iTry As Integer<br> <br>            Dim iFilled As Integer<br>            For i = 0 To iNumTables<br>                If (iTableLayout And 1 &lt;&lt; i) &gt; 0 Then iFilled += 1<br>            Next<br> <br>            For i = 0 To aSizeProbs.GetUpperBound(0)<br>                iPoss = 0<br>                dSubTot = 0<br>                If aSizeProbs(i) &gt; 0 Then<br>                    For j = 0 To iNumTables - i - 1<br>                        bOkay = True<br>                        iTry = 0<br>                        For k = j To j + i<br>                            iTry += (1 &lt;&lt; k)<br>                        Next<br>                        If (iTableLayout And iTry) &gt; 0 Then bOkay = False<br>                        If bOkay Then<br>                            dSubTot += dFindProb(iTableLayout + iTry) + i + 1<br>                            iPoss += 1<br>                        End If<br>                    Next<br>                    If iPoss &gt; 0 Then<br>                        dTot += (dSubTot / iPoss) * (aSizeProbs(i) / 100)<br>                    End If<br>                End If<br>            Next<br> <br>            aProbs(iTableLayout) = dTot<br>            Return dTot<br> <br>        End Function<br>    End Class<br></td>