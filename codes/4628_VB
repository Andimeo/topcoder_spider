<td class="problemText" colspan="8" valign="middle" align="left">
            Imports System<br>Imports Microsoft.VisualBasic<br>Public Class TheCoderMan<br>    Public Function evaluateMovie(ByVal yourEvaluations As String, ByVal friendsEvaluations As String(), ByVal maximalDeviation As Integer) As Double<br>        Dim nf As Integer, nm As Integer<br>        nf = friendsEvaluations.GetUpperBound(0) + 1<br>        nm = friendsEvaluations(0).Length<br>        Dim maxDev(nf - 1) As Double<br>        Dim i As Integer<br>        Dim totr As Integer<br>        Dim c As Integer<br>        For i = 0 To nf - 1<br>            If friendsEvaluations(i).Chars(nm - 1) &lt;&gt; "X" Then<br>                If CalcMaxDev(yourEvaluations, friendsEvaluations(i)) &lt;= maximalDeviation Then<br>                    c = c + 1<br>                    totr = totr + Val(friendsEvaluations(i).Chars(nm - 1))<br>                    'Console.WriteLine("{0} {1}", c, totr)<br>                End If<br>            End If<br>        Next<br>        If c = 0 Then<br>            evaluateMovie = -1<br>        Else<br>            evaluateMovie = totr / c<br>        End If<br> <br>    End Function<br>    Function CalcMaxDev(ByVal p1 As String, ByVal p2 As String) As Double<br>        Dim i As Integer<br>        Dim c As Integer, tdev As Integer<br>        For i = 0 To p1.Length - 1<br>            If p1.Chars(i) = "X" Or p2.Chars(i) = "X" Then<br>                'skip<br>            Else<br>                c = c + 1<br>                tdev = tdev + Math.Abs(Val(p1.Chars(i)) - Val(p2.Chars(i)))<br>            End If<br>        Next<br>        If c = 0 Then<br>            CalcMaxDev = 100<br>        Else<br>            CalcMaxDev = tdev / c<br>        End If<br> <br>    End Function<br>End Class<br></td>