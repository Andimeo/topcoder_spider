<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;string&gt;<br>#include &lt;vector&gt;<br>using namespace std;<br> <br>struct GomokuBoardChecker<br>{<br>  int count[15][15][4], R, C;<br>  char b[15][15];<br> <br>  string check(vector &lt;string&gt; board)<br>  {<br>    const string no("INVALID");<br>    R = board.size();<br>    C = board[0].size();<br>    int i, j, k;<br>    for(i = 0; i &lt; R; ++i)<br>      for(j = 0; j &lt; C; ++j)<br>        b[i][j] = board[i][j];<br>    bool hasEmpty = false;<br>    int OCount = 0, XCount = 0;<br>    for(i = 0; i &lt; R; ++i)<br>      for(j = 0; j &lt; C; ++j)<br>        switch(b[i][j])<br>        {<br>        case 'O':<br>          ++OCount;<br>          break;<br>        case 'X':<br>          ++XCount;<br>          break;<br>        case '.':<br>          hasEmpty = true;<br>          break;<br>        default:<br>          return no;<br>        }<br>    if(OCount + 1 &lt; XCount || XCount + 1 &lt; OCount)<br>      return no;<br>    bool OWon, XWon;<br>    judge(OWon, XWon);<br>    if(XCount &lt; OCount &amp;&amp; XWon || OCount &lt; XCount &amp;&amp; OWon || XWon &amp;&amp; OWon)<br>      return no;<br>    if(OWon)<br>    {<br>      for(k = 0; k &lt; R * C; ++k)<br>        if(b[k / C][k % C] == 'O')<br>        {<br>          b[k / C][k % C] = '.';<br>          judge(OWon, XWon);<br>          b[k / C][k % C] = 'O';<br>          if(!OWon)<br>            break;<br>        }<br>      if(k == R * C)<br>        return no;<br>    }<br>    if(XWon)<br>    {<br>      for(k = 0; k &lt; R * C; ++k)<br>        if(b[k / C][k % C] == 'X')<br>        {<br>          b[k / C][k % C] = '.';<br>          judge(OWon, XWon);<br>          b[k / C][k % C] = 'X';<br>          if(!XWon)<br>            break;<br>        }<br>      if(k == R * C)<br>        return no;<br>    }<br>    judge(OWon, XWon);<br>    if(OWon)<br>      return string("O WON");<br>    if(XWon)<br>      return string("X WON");<br>    if(hasEmpty)<br>      return string("IN PROGRESS");<br>    else<br>      return string("DRAW");<br>  }<br> <br>  void judge(bool&amp; OWon, bool&amp; XWon)<br>  {<br>    int i, j, k;<br>    OWon = false;<br>    XWon = false;<br>    for(i = 0; i &lt; R; ++i)<br>      for(j = 0; j &lt; C; ++j)<br>      {<br>        for(k = 0; k &lt; 4; ++k)<br>          count[i][j][k] = 0;<br>        if(b[i][j] != '.')<br>        {<br>          if(j &gt; 0 &amp;&amp; b[i][j - 1] == b[i][j])<br>            count[i][j][0] = count[i][j - 1][0];<br>          if(i &gt; 0 &amp;&amp; b[i - 1][j] == b[i][j])<br>            count[i][j][1] = count[i - 1][j][1];<br>          if(i &gt; 0 &amp;&amp; j &gt; 0 &amp;&amp; b[i - 1][j - 1] == b[i][j])<br>            count[i][j][2] = count[i - 1][j - 1][2];<br>          if(i &gt; 0 &amp;&amp; j &lt; C - 1 &amp;&amp; b[i - 1][j + 1] == b[i][j])<br>            count[i][j][3] = count[i - 1][j + 1][3];<br>        }<br>        for(k = 0; k &lt; 4; ++k)<br>        {<br>          ++count[i][j][k];<br>          if(count[i][j][k] &gt;= 5)<br>            break;<br>        }<br>        if(k &lt; 4)<br>          if(b[i][j] == 'O')<br>            OWon = true;<br>          else<br>            XWon = true;<br>      }<br>  }<br>};<br></td>