<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Text;<br> <br>public class CompanyMessages<br>{<br>  int n;<br>  string[] m;<br>  int [] memo;<br>  int [] who;<br>  bool [] used;<br> <br>  int solve(int mask)<br>  {<br>    if (mask == 0) return 0;<br> <br>    if (used[mask]) return memo[mask];<br> <br>    int min = int.MaxValue;<br>    int w = 0;<br> <br> <br> <br>    for(int i = 0; i&lt;n; i++)<br>    {<br>      int x = 1&lt;&lt;i;<br>      if ((x&amp;mask)==0) continue;<br>      int cost = 0;<br> <br>      for(int j = 0; j&lt;n; j++)<br>      {<br>        int y = 1&lt;&lt;j;<br>        if ((y&amp;mask) != 0) cost += (int) (m[j][i]);<br>      }<br>      cost += solve(mask-x);<br>      if (cost &lt; min) <br>      {<br>        min = cost;<br>        w = i;<br>      }<br>    }<br>    used[mask] = true;<br>    memo[mask] = min;<br>    who[mask] = w;<br>    return min;<br> <br>  }<br> <br>  public int[] getRank(string[] messages)<br>  {<br>    m = messages;<br>    n = messages.Length;<br> <br>    used = new bool[ 1 &lt;&lt; n];<br>    memo = new int [ 1 &lt;&lt; n];<br>    who = new int[ 1 &lt;&lt; n];<br> <br>    solve((1&lt;&lt;n)-1);<br> <br>    int i = 0;<br>    int [] ret = new int[n];<br> <br>    for(int x = (1&lt;&lt;n)-1; x != 0; )<br>    {<br>      int y = who[x];<br>      ret[i++] = y;<br>      x -= (1&lt;&lt;y);<br>    }<br> <br> <br> <br> <br>    <br>    return ret;<br>  }<br>}<br></td>