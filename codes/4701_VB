<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class ChutesAndLadders<br>        Public Function winningChance(ByVal startLadder As Integer(), ByVal endLadder As Integer(), ByVal players As Integer()) As Double()<br>            Dim i, j, k, k2, l, l2, m As Long<br> <br>            Dim aOdds(100, players.GetUpperBound(0), 1) As Double<br>            Dim aDest(120) As Integer<br>            Dim dChances(players.GetUpperBound(0)) As Double<br> <br>            For i = 0 To 120<br>                aDest(i) = i<br>            Next<br> <br>            For i = 100 To 120<br>                aDest(i) = 99<br>            Next<br> <br>            For i = 0 To startLadder.GetUpperBound(0)<br>                aDest(startLadder(i)) = endLadder(i)<br>            Next<br> <br>            For i = 0 To players.GetUpperBound(0)<br>                aOdds(players(i), i, 0) = 1<br>            Next<br> <br>            l = 1<br>            Dim dSum As Double = 1<br>            Dim dTot As Double<br> <br>            For i = 0 To 2000<br>                l2 = 1 - l<br>                For j = 0 To players.GetUpperBound(0)<br>                    dTot = 0<br>                    For m = 0 To 98<br>                        aOdds(m, j, l) = 0<br>                        dTot += aOdds(m, j, l2)<br>                    Next<br>                    aOdds(99, j, l) = 0<br>                    If dTot &gt; 0 Then<br>                        For k = 1 To 6<br>                            For k2 = 1 To 6<br>                                For m = 0 To 98<br>                                    aOdds(aDest(m + k + k2), j, l) += aOdds(m, j, l2) / 36 / dTot<br>                                Next<br>                            Next<br>                        Next<br>                        dChances(j) += aOdds(99, j, l) * dSum<br>                        dSum *= 1 - aOdds(99, j, l)<br>                    End If<br>                Next<br>                'dSum = 1<br>                'For j = 0 To players.GetUpperBound(0)<br>                '    dSum -= dChances(j)<br>                'Next<br>                l = 1 - l<br>            Next<br> <br>            dSum = 0<br>            For j = 0 To players.GetUpperBound(0)<br>                dSum += dChances(j)<br>            Next<br> <br>            For j = 0 To players.GetUpperBound(0)<br>                dChances(j) /= dSum<br>            Next<br> <br>            Return dChances<br> <br> <br>        End Function<br>    End Class<br></td>