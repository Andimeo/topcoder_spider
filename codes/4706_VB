<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class StockQuotes<br>        Public Function report(ByVal quotes As String()) As String()<br>            Dim i, j, k, l As Long<br> <br>            Dim iBestBid, iBestAsk As Integer<br>            Dim aCount(10) As Integer<br>            Dim aTotSpread(10) As Integer<br>            Dim aBid(10) As Integer<br>            Dim aAsk(10) As Integer<br>            Dim s() As String<br>            Dim iBroker, iBid, iAsk As Integer<br> <br>            aBid(10) = -1<br>            aAsk(10) = 9999<br>            Dim bChanged As Boolean<br> <br>            For i = 0 To quotes.GetUpperBound(0)<br>                bChanged = False<br>                s = quotes(i).Split(" ")<br>                iBroker = CInt(s(0))<br>                iBid = CInt(s(1))<br>                iAsk = CInt(s(2))<br>                aCount(iBroker) += 1<br>                aTotSpread(iBroker) += iAsk - iBid<br>                aBid(iBroker) = iBid<br>                aAsk(iBroker) = iAsk<br>                iBestBid = -1<br>                iBestAsk = 9999<br>                For j = 0 To 9<br>                    If aCount(j) &gt; 0 Then<br>                        iBestBid = System.Math.Max(iBestBid, aBid(j))<br>                        iBestAsk = System.Math.Min(iBestAsk, aAsk(j))<br>                    End If<br>                Next<br>                If iBestBid &lt;&gt; aBid(10) Then bChanged = True<br>                If iBestAsk &lt;&gt; aAsk(10) Then bChanged = True<br>                If bChanged Then<br>                    aCount(10) += 1<br>                    aBid(10) = iBestBid<br>                    aAsk(10) = iBestAsk<br>                    aTotSpread(10) += iBestAsk - iBestBid<br>                End If<br>            Next<br> <br>            Dim oRet As New System.Collections.ArrayList<br>            Dim sRet As String<br> <br>            For i = 0 To 10<br>                If aCount(i) &gt; 0 Then<br>                    oRet.Add(i &amp; " " &amp; aCount(i) &amp; " " &amp; Microsoft.VisualBasic.Format(aTotSpread(i) / aCount(i), "0.00"))<br>                End If<br>            Next<br> <br>            Return oRet.ToArray(GetType(String))<br> <br> <br> <br>        End Function<br>    End Class<br></td>