<td class="problemText" colspan="8" valign="middle" align="left">
            // another fine solution by misof<br>#include &lt;algorithm&gt;<br> <br>#include &lt;iostream&gt;<br>#include &lt;sstream&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>#include &lt;queue&gt;<br>#include &lt;set&gt;<br>#include &lt;map&gt;<br> <br>#include &lt;cstdio&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;cctype&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cassert&gt;<br>using namespace std;<br> <br>#define REP(i,n) for(int i=0;i&lt;(n);++i)<br>#define FOREACH(it,c) for(typeof((c).begin()) it=(c).begin();it!=(c).end();++it)<br> <br> <br>/////////////////// CODE WRITTEN DURING THE COMPETITION FOLLOWS ////////////////////////////////<br> <br>void load(vector&lt;string&gt; &amp;zoz, map&lt;string, long long&gt; &amp;res, vector&lt;string&gt; &amp;res2) {<br>  int zs = zoz.size();<br>  res2.clear();<br>  REP(i,zs) { <br>    stringstream SS(zoz[i]);<br>    int poc;<br>    string typ,meno;<br>    SS &gt;&gt; poc &gt;&gt; typ &gt;&gt; meno; <br>    if (typ == "Tbsp") poc *= 3;<br>    if (typ == "cups") poc *= 3*16;<br>    res[meno] = poc;<br>    res2.push_back(meno);<br>  }<br>}<br> <br>class Recipe {<br>public:<br>  vector &lt;string&gt; fix(vector &lt;string&gt; recipe, vector &lt;string&gt; mixingBowl) {<br>    map&lt;string, long long&gt; mam, treba;<br>    vector&lt;string&gt; poradie;<br>    load(mixingBowl,mam,poradie);<br>    load(recipe,treba,poradie);<br> <br>    long long gcd = -1;<br>    FOREACH(it,treba) if (gcd==-1) gcd=it-&gt;second; else gcd = __gcd(gcd,it-&gt;second);<br>    FOREACH(it,treba) it-&gt;second /= gcd;<br> <br>    int mul = 1;<br>    int N = poradie.size();<br>    REP(i,N) {<br>      mul &gt;?= ( mam[poradie[i]] + treba[poradie[i]] - 1 ) / treba[poradie[i]];<br>    }<br>    if (mul &lt; gcd) mul = gcd;<br>    <br>    vector &lt;string&gt; res;<br>    REP(i,N) if (mul * treba[poradie[i]] &gt; mam[poradie[i]]) {<br>      int dodaj = mul * treba[poradie[i]] - mam[poradie[i]];<br>      int dc = dodaj / (3*16); dodaj %= (3*16);<br>      int dT = dodaj / 3; dodaj %= 3;<br>      int dt = dodaj;<br>      stringstream SS;<br>      if (dc) SS &lt;&lt; dc &lt;&lt; " cups ";<br>      if (dT) SS &lt;&lt; dT &lt;&lt; " Tbsp ";<br>      if (dt) SS &lt;&lt; dt &lt;&lt; " tsp ";<br>      SS &lt;&lt; poradie[i];<br>      res.push_back(SS.str());<br>    }<br>    <br>    return res;<br>  }<br> <br> <br>};<br>// Unused code automatically removed, but the UCR still sucks<br> <br> <br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003]<br>// Powered by CodeProcessor<br></td>