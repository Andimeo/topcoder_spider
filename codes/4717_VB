<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class PatternOptimizer<br>    Public Function optimize(ByVal pattern As String) As String<br>        Dim i, j, k, l As Long<br>        pattern &amp;= "z"<br> <br>        Dim sNewPat As String<br> <br>        Dim iQ, iX As Integer<br> <br>        iQ = 0<br>        iX = 0<br> <br>        For i = 0 To pattern.Length - 1<br>            If pattern.Substring(i, 1) = "*" Or pattern.Substring(i, 1) = "?" Then<br>                If pattern.Substring(i, 1) = "*" Then<br>                    iX += 1<br>                Else<br>                    iQ += 1<br>                End If<br>            Else<br>                If iX + iQ &gt; 0 Then<br>                    If iX &gt; 0 Then sNewPat &amp;= "*"<br>                    For j = 1 To iQ<br>                        sNewPat &amp;= "?"<br>                    Next<br>                    iX = 0<br>                    iQ = 0<br>                End If<br>                sNewPat &amp;= pattern.Substring(i, 1)<br>            End If<br>        Next<br> <br>        Return sNewPat.Substring(0, sNewPat.Length - 1)<br>    End Function<br>End Class<br></td>