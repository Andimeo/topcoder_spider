<td class="problemText" colspan="8" valign="middle" align="left">
            Imports System<br>Imports System.Math<br>Imports System.Array<br>Imports System.Collections<br> <br>Public Class IsingModel<br> <br>    Public Function energy(ByVal spins As String()) As Integer<br>        Dim totE As Integer = 0<br> <br>        For x As Integer = 0 To spins.Length - 1<br>            For y As Integer = 0 To spins(x).Length - 1<br>                Dim currSign As String = spins(x).Substring(y, 1)<br> <br>                If Not x + 1 &gt; spins.Length - 1 Then<br>                    If spins(x + 1).Substring(y, 1) = currSign Then<br>                        totE -= 1<br>                    Else<br>                        totE += 1<br>                    End If<br>                End If<br> <br>                If Not y + 1 &gt; spins(x).Length - 1 Then<br>                    If spins(x).Substring(y + 1, 1) = currSign Then<br>                        totE -= 1<br>                    Else<br>                        totE += 1<br>                    End If<br>                End If<br>            Next<br>        Next<br> <br>        Return totE<br> <br>    End Function<br> <br>End Class<br></td>