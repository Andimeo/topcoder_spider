<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Text;<br><br>public class NearBirthdays {<br>    int span;<br><br>    double[,] cache;<br>    double[,] pcache;<br><br>    int total = 0;<br><br>    double power(int a, int n) {<br>  return pcache[a, n];<br>    }<br><br>    double forSegment(int len, int num) {<br>  double res = 0;<br><br>  if (cache[len, num] &gt; -0.5)<br>      return cache[len, num];<br><br>  if (num == 0)<br>      return 1;<br><br>  if (len == 0)<br>      return 0;<br><br>  for (int a = 0; a &lt; len; ++a) {<br>      double pp = power(Math.Max(0, (len - 1 - a) - span), num - 1) * num;<br><br>//      Console.WriteLine(len + " " + num + " " + a + " " + pp);<br><br>      double cur = forSegment(Math.Max(0, (len - 1 - a) - span), num - 1) * pp;<br>      res += cur;<br>  }<br><br>  cache[len, num] = res / power(len, num);<br><br>//  Console.WriteLine(len + " " + num + " " + res);<br>  return cache[len, num];<br>    }<br><br>    public double probability(int noPeople, int withinDays, int daysInAYear) {<br>  span = withinDays;<br>  <br>  cache = new double[daysInAYear + 1, noPeople + 1];<br><br>  pcache = new double[1001, 101];<br><br>  for (int i = 0; i &lt;= 1000; ++i) {<br>      pcache[i, 0] = 1;<br>      for (int j = 1; j &lt;= 100; ++j)<br>    pcache[i, j] = pcache[i, j - 1] * i;<br>  }<br><br>  for (int i = 0; i &lt;= daysInAYear; ++i)<br>      for (int j = 0; j &lt;= noPeople; ++j)<br>    cache[i, j] = -1;<br><br>  int amount = daysInAYear - 1 - 2 * withinDays;<br><br>  if (amount &gt; 0) {<br>      double res = forSegment(amount, noPeople - 1);<br><br>//      Console.WriteLine(total);<br><br>      double koef = ((double) amount) / daysInAYear;<br><br>      for (int i = 0; i &lt; noPeople - 1; ++i)<br>    res *= koef;<br><br>      return 1 - res;<br>  } else<br>      return 1;<br>    }<br>}<br><br><br>// Powered by FileEdit<br></td>