<td class="problemText" colspan="8" valign="middle" align="left">
            imports System<br>imports Microsoft.VisualBasic<br>imports System.Collections<br> <br>Public Class BestYahtzeeScore<br> <br>    Dim mr(14) As Integer<br> <br>    Public Function bestScore(ByVal rolls As String) As Integer<br> <br>        Dim i As Integer<br>        For i = 0 To 14<br>            mr(i) = Val(rolls.Chars(i))<br>        Next<br> <br>        Dim iMask As Integer<br>        Dim iBest As Integer<br>        Dim iBestRoll As Integer<br>        Dim iRoll As Integer<br>        Dim sBest As String<br>        Dim sRoll As String<br>        iBest = 0<br>        iBestRoll = 0<br>        For iMask = 0 To ((2 ^ 10) - 1)<br>            iRoll = GetRoll(iMask, sRoll)<br>            If iRoll &gt; iBest Then<br>                iBest = iRoll<br>                iBestRoll = iMask<br>                sBest = sRoll<br>            End If<br>        Next<br> <br> <br>        Return iBest<br>    End Function<br> <br>    Private Function GetRoll(ByVal iMask As Integer, ByRef sRoll As String) As Integer<br>        Dim dice(4) As Integer<br>        Dim iNext As Integer<br>        iNext = 5<br> <br> <br>        dice(0) = mr(0)<br>        dice(1) = mr(1)<br>        dice(2) = mr(2)<br>        dice(3) = mr(3)<br>        dice(4) = mr(4)<br> <br>        Dim i As Integer<br>        For i = 0 To 4<br>            If (iMask And (2 ^ i)) = 0 Then<br>                dice(i) = mr(iNext)<br>                iNext = iNext + 1<br>            End If<br>        Next<br> <br>        For i = 0 To 4<br>            If (iMask And (2 ^ (i + 5))) = 0 Then<br>                dice(i) = mr(iNext)<br>                iNext = iNext + 1<br>            End If<br>        Next<br> <br>        Return ScoreRoll(dice, sRoll)<br> <br>    End Function<br> <br>    '4 of a kind - 4 or more dice the same, scores the face value of ALL the dice.<br>    'full house - 3 dice equal to each other with the other 2 dice equal to each other <br>    'as well. Scores 25 points.<br>    'small straight - Any 4 of the dice in consecutive order, scores 30 points.<br>    'large straight - All 5 dice in consecutive order, scores 40 points.<br>    'yahtzee - All 5 dice equal to each other, scores 50 points.<br> <br>    Private Function ScoreRoll(ByVal dice() As Integer, ByRef sRoll As String) As Integer<br>        Dim s As String<br>        s = dice(0) &amp; dice(1) &amp; dice(2) &amp; dice(3) &amp; dice(4)<br>        sRoll = s<br> <br>        If s = "23564" Then Stop<br> <br>        Array.Sort(dice)<br>        Dim itot As Integer<br>        itot = dice(0) + dice(1) + dice(2) + dice(3) + dice(4)<br> <br> <br> <br> <br>        'STRAIGHTS<br>        If InStr(s, "1") &lt;&gt; 0 And InStr(s, "2") &lt;&gt; 0 And InStr(s, "3") &lt;&gt; 0 And InStr(s, "4") &lt;&gt; 0 And InStr(s, "5") &lt;&gt; 0 Then<br>            Return 40<br>        End If<br>        If InStr(s, "6") &lt;&gt; 0 And InStr(s, "2") &lt;&gt; 0 And InStr(s, "3") &lt;&gt; 0 And InStr(s, "4") &lt;&gt; 0 And InStr(s, "5") &lt;&gt; 0 Then<br>            Return 40<br>        End If<br> <br>        If InStr(s, "1") &lt;&gt; 0 And InStr(s, "2") &lt;&gt; 0 And InStr(s, "3") &lt;&gt; 0 And InStr(s, "4") &lt;&gt; 0 Then<br>            Return 30<br>        End If<br>        If InStr(s, "2") &lt;&gt; 0 And InStr(s, "3") &lt;&gt; 0 And InStr(s, "4") &lt;&gt; 0 And InStr(s, "5") &lt;&gt; 0 Then<br>            Return 30<br>        End If<br>        If InStr(s, "3") &lt;&gt; 0 And InStr(s, "4") &lt;&gt; 0 And InStr(s, "5") &lt;&gt; 0 And InStr(s, "6") &lt;&gt; 0 Then<br>            Return 30<br>        End If<br> <br> <br> <br>        '5 of kind<br>        If dice(0) = dice(1) And dice(1) = dice(2) And dice(2) = dice(3) And dice(3) = dice(4) Then<br>            Return 50<br>        End If<br> <br>        '4 of kind<br>        If dice(0) = dice(1) And dice(1) = dice(2) And dice(2) = dice(3) Then<br>            Return itot<br>        End If<br>        If dice(1) = dice(2) And dice(2) = dice(3) And dice(3) = dice(4) Then<br>            Return itot<br>        End If<br> <br>        'FULL HOUSE<br>        If dice(0) = dice(1) And dice(2) = dice(3) And dice(3) = dice(4) Then<br>            Return 25<br>        End If<br>        If dice(0) = dice(1) And dice(1) = dice(2) And dice(3) = dice(4) Then<br>            Return 25<br>        End If<br> <br> <br>    End Function<br> <br>End Class<br></td>