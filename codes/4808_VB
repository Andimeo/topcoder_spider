<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class ZCurve<br>        Public Function zValue(ByVal N As Integer, ByVal r As Integer, ByVal c As Integer) As Integer<br>            If N = 0 Then Return 0<br>            Dim i, j, k, l As Long<br> <br>            Dim bLeft, bTop As Boolean<br>            bLeft = True<br>            bTop = True<br>            Dim iPerQuad As Integer = (1 &lt;&lt; 2 * (N - 1))<br> <br>            If r &gt; (1 &lt;&lt; (N - 1)) - 1 Then<br>                bTop = False<br>            End If<br> <br>            If c &gt; (1 &lt;&lt; (N - 1)) - 1 Then<br>                bLeft = False<br>            End If<br> <br>            Dim iOffset As Integer = 0<br>            If Not bLeft Then iOffset += 1<br>            If Not bTop Then iOffset += 2<br> <br>            Return iOffset * iPerQuad + zValue(N - 1, r Mod (1 &lt;&lt; (N - 1)), c Mod (1 &lt;&lt; (N - 1)))<br> <br>        End Function<br>    End Class<br></td>