<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections.Generic;<br>using System.Text;<br><br>public class ThirstyGroup {<br>    long enough(long time, long av, int[] c) {<br>  long total = 0;<br>  foreach (int x in c) {<br>      long cnt = (time + x) / (x + 1);<br>      total += cnt * x;<br>  }<br>  return av - total;<br>    }<br><br>    public int bestGlass(int availableWater, int[] capacities) {<br>  long left = 0;<br>  long right = availableWater * (long) 2 + 1;<br>  while (right - left &gt; 1) {<br>      long middle = (left + right) / 2;<br>      if (enough(middle, availableWater, capacities) &gt;= 0)<br>    left = middle;<br>      else<br>    right = middle;<br>  }<br>  long[] am = new long[capacities.Length];<br>  for (int i = 0; i &lt; capacities.Length; ++i) {<br>      int x = capacities[i];<br>      am[i] = (left + x) / (x + 1) * x;<br>  }<br>  long rest = enough(left, availableWater, capacities);<br>  for (int i = 0; i &lt; capacities.Length; ++i) {<br>      int x = capacities[i];<br>      if ((left + 1 + x) % (x + 1) == 0) {<br>    long need = Math.Min(rest, x);<br>    am[i] += need;<br>    rest -= need;<br>      }<br>  }<br>  int answer = 0;<br>  for (int i = 1; i &lt; capacities.Length; ++i)<br>      if (am[i] &gt; am[answer])<br>    answer = i;<br>  return answer;<br>    }<br>}<br><br><br>// Powered by FileEdit<br></td>