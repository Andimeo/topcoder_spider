<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class RegimentArming<br>    Public Function chooseGuns(ByVal counts As Integer(), ByVal powers As Integer(), ByVal N As Integer) As Integer<br>        Dim max As Integer = 0<br>        Dim i, j As Integer<br>        Dim c As Integer<br>        Dim finish As Boolean<br>        Dim b As Boolean<br>        Dim n1 As Integer<br> <br>        For i = 0 To counts.Length - 1<br> <br>            j = i<br>            finish = False<br>            b = True<br>            n1 = N<br>            c = 0<br>            Do<br>                If counts(j) &gt;= n1 Then<br>                    c += n1 * powers(j)<br>                    finish = True<br>                Else<br>                    c += counts(j) * powers(j)<br>                    n1 -= counts(j)<br>                    j += 1<br>                    If j &gt; counts.Length - 1 Then<br>                        finish = True<br>                        b = False<br>                    End If<br>                End If<br> <br>            Loop Until finish<br> <br>            If c &gt; max AndAlso b Then max = c<br>        Next<br> <br>        For i = counts.Length - 1 To 0 Step -1<br> <br>            j = i<br>            finish = False<br>            b = True<br>            n1 = N<br>            c = 0<br>            Do<br>                If counts(j) &gt;= n1 Then<br>                    c += n1 * powers(j)<br>                    finish = True<br>                Else<br>                    c += counts(j) * powers(j)<br>                    n1 -= counts(j)<br>                    j -= 1<br>                    If j = -1 Then<br>                        finish = True<br>                        b = False<br>                    End If<br>                End If<br> <br>            Loop Until finish<br> <br>            If c &gt; max AndAlso b Then max = c<br>        Next<br> <br>        Return max<br>    End Function<br>End Class<br></td>