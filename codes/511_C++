<td class="problemText" colspan="8" valign="middle" align="left">
            #ifdef WIN32<br>#pragma warning(disable:4786 4503 4018)<br>#endif<br>#include &lt;algorithm&gt;<br>#include &lt;functional&gt;<br>#include &lt;iostream&gt;<br>#include &lt;list&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;sstream&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;cstring&gt;<br>using namespace std;<br>#ifdef WIN32<br>#define i64 __int64<br>#define min _cpp_min<br>#define max _cpp_max<br>#else<br>#define i64 long long<br>#endif<br>#define all(x) (x).begin(), (x).end()<br>typedef vector&lt;int&gt; VI;<br>typedef vector&lt;VI&gt; VVI;<br>typedef vector&lt;string&gt; VS;<br>typedef vector&lt;VS&gt; VVS;<br>typedef set&lt;int&gt; SI;<br>typedef set&lt;string&gt; SS;<br>typedef set&lt;char&gt; SC;<br>typedef pair&lt;int,int&gt; PII;<br><br>long double mini=-2147483648.0,maxi=2147483647.0;<br><br>VVI add(VVI&amp; a,VVI&amp; b)<br>{<br>  int r=a.size(),c=a[0].size();<br>  if(r!=b.size() || c!=b[0].size())<br>    return VVI();<br>  VVI x(r,VI(c));<br>  for(int i=0;i&lt;r;i++)<br>    for(int j=0;j&lt;c;j++)<br>    {<br>      long double q=a[i][j];<br>      q+=b[i][j];<br>      if(q&lt;mini || q&gt;maxi)<br>        return VVI();<br>      x[i][j]=q;<br>    }<br>  return x;<br>}<br><br>VVI mult(VVI&amp; a,VVI&amp; b)<br>{<br>  if(a[0].size()!=b.size())<br>    return VVI();<br>  int r=a.size(),c=b[0].size(),n=a[0].size();<br>  VVI x(r,VI(c));<br>  for(int i=0;i&lt;r;i++)<br>    for(int j=0;j&lt;c;j++)<br>    {<br>      long double q=0;<br>      for(int k=0;k&lt;n;k++)<br>      {<br>        long double q2=a[i][k];<br>        q2*=b[k][j];<br>        q+=q2;<br>      }<br>      if(q&lt;mini || q&gt;maxi)<br>        return VVI();<br>      x[i][j]=q;<br>    }<br>  return x;<br>}<br><br>VS gettokens(string s,string sep,int returnsep=0,int groupsep=1)<br>{<br>  VS r;<br>  string token;<br>  for(int i=0;i&lt;=s.size();i++)<br>  {<br>    if(token!="" &amp;&amp; (i==s.size() || (sep.find(token[0])==-1)!=(sep.find(s[i])==-1)))<br>    {<br>      if(sep.find(token[0])==-1)<br>        r.push_back(token);<br>      else<br>        if(returnsep)<br>          if(groupsep)<br>            r.push_back(token);<br>          else<br>            for(int j=0;j&lt;token.size();j++)<br>              r.push_back(token.substr(j,1));<br>      token="";<br>    }<br>    if(i&lt;s.size())<br>      token+=s[i];<br>  }<br>  return r;<br>}<br><br>int string2int(const string&amp; s)<br>{<br>  int r;<br>  sscanf(s.c_str(),"%d",&amp;r);<br>  return r;<br>}<br><br>string int2string(int i)<br>{<br>  ostringstream s;<br>  s &lt;&lt; i;<br>  return s.str();<br>}<br><br>class MatArith<br>{<br>public:<br>  vector &lt;string&gt; calculate(vector &lt;string&gt; aa, vector &lt;string&gt; bb, vector &lt;string&gt; cc, string ex)<br>  {<br>    int i,j,k;<br>    VVI a(aa.size());<br>    for(i=0;i&lt;a.size();i++)<br>    {<br>      VS t=gettokens(aa[i]," ");<br>      a[i]=VI(t.size());<br>      for(j=0;j&lt;t.size();j++)<br>        a[i][j]=string2int(t[j]);<br>    }<br>    VVI b(bb.size());<br>    for(i=0;i&lt;b.size();i++)<br>    {<br>      VS t=gettokens(bb[i]," ");<br>      b[i]=VI(t.size());<br>      for(j=0;j&lt;t.size();j++)<br>        b[i][j]=string2int(t[j]);<br>    }<br>    VVI c(cc.size());<br>    for(i=0;i&lt;c.size();i++)<br>    {<br>      VS t=gettokens(cc[i]," ");<br>      c[i]=VI(t.size());<br>      for(j=0;j&lt;t.size();j++)<br>        c[i][j]=string2int(t[j]);<br>    }<br>    VS t=gettokens(ex,"+");<br>    VVI r;<br>    for(i=0;i&lt;t.size();i++)<br>    {<br>      VS t2=gettokens(t[i],"*");<br>#define mat(r,ch) if(ch=='A')r=a;else if(ch=='B')r=b;else if(ch=='C')r=c;<br>      VVI r2,r3;<br>      mat(r2,t2[0][0]);<br>      for(j=1;j&lt;t2.size();j++)<br>      {<br>        mat(r3,t2[j][0]);<br>        r2=mult(r2,r3);<br>        if(r2.size()==0)<br>          return VS();<br>      }<br>      if(i==0)<br>        r=r2;<br>      else<br>      {<br>        r=add(r,r2);<br>        if(r.size()==0)<br>          return VS();<br>      }<br>    }<br>    VS q(r.size());<br>    for(i=0;i&lt;r.size();i++)<br>      for(j=0;j&lt;r[0].size();j++)<br>      {<br>        if(j)<br>          q[i]+=" ";<br>        q[i]+=int2string(r[i][j]);<br>      }<br>    return q;<br>  }<br>};<br><br> <br>// Powered by CodeProcessor<br></td>