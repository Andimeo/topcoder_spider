<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class BallGift<br>    Private aChances(15, 15, 15, 45) As Double<br>    Private bFilled(15, 15, 15) As Boolean<br>    Private iTot As Integer<br>    Public Function bestPosition(ByVal players As Integer, ByVal green As Integer, ByVal red As Integer, ByVal black As Integer) As Integer<br>        Dim i, j, k, l As Integer<br>        iTot = players - black<br> <br>        For i = 0 To 15<br>            For j = 0 To 15<br>                For k = 0 To 15<br>                    bFilled(i, j, k) = False<br>                    For l = 0 To 45<br>                        aChances(i, j, k, l) = 0<br>                    Next<br>                Next<br>            Next<br>        Next<br>        aChances(0, 0, 0, 0) = 1<br>        bFilled(0, 0, 0) = True<br> <br>        Calc(green, red, black)<br> <br>        Dim dEps As Double = 0.00000000001<br>        Dim dMax As Double<br>        Dim iBest As Integer<br> <br>        For i = 0 To players - 1<br>            If aChances(green, red, black, i) &gt; dMax + dEps Then<br>                iBest = i<br>                dMax = aChances(green, red, black, i)<br>            End If<br>        Next<br>        Return iBest<br> <br>    End Function<br> <br>    Private Sub Calc(ByVal g As Integer, ByVal r As Integer, ByVal b As Integer)<br>        If bFilled(g, r, b) Then Exit Sub<br>        Dim dChance As Double<br>        Dim i, j, k, l As Integer<br>        If b &gt; 0 Then<br>            dChance = b / (g + r + b)<br>            Calc(g, r, b - 1)<br>            For i = 1 To iTot + b - 1<br>                aChances(g, r, b, i) += aChances(g, r, b - 1, i - 1) * dChance<br>            Next<br>        End If<br>        If g &gt; 0 Then<br>            dChance = g / (g + r + b)<br>            Calc(g - 1, r, b)<br>            For i = 1 To iTot + b - 1<br>                aChances(g, r, b, i) += aChances(g - 1, r, b, i - 1) * dChance<br>            Next<br>            aChances(g, r, b, 0) += aChances(g - 1, r, b, iTot + b - 1) * dChance<br>        End If<br>        If r &gt; 0 Then<br>            dChance = r / (g + r + b)<br>            Calc(g, r - 1, b)<br>            For i = 0 To iTot + b - 1<br>                aChances(g, r, b, i) += aChances(g, r - 1, b, iTot + b - 1 - i) * dChance<br>            Next<br>        End If<br>        bFilled(g, r, b) = True<br>    End Sub<br>End Class<br></td>