<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br> <br>public class CoinGame<br>{<br>  double test(string a, string b)<br>  {<br>    ArrayList l = new ArrayList();<br>    <br>    int i, j, k;<br>    <br>    for(i=0; i&lt;=a.Length; ++i)<br>    {<br>      string s = a.Substring(0, i);<br>      <br>      if(!l.Contains(s))<br>        l.Add(s);<br>    }<br> <br>    for(i=0; i&lt;=b.Length; ++i)<br>    {<br>      string s = b.Substring(0, i);<br>      <br>      if(!l.Contains(s))<br>        l.Add(s);<br>    }<br>    <br>    int n = l.Count;<br>    <br>    double[,] m = new double[n+2,n+2];<br>    <br>    for(i=0; i&lt;n; i++)<br>    {<br>      if((string)l[i]==a)<br>        m[i,n]=1;<br>       else<br>      if((string)l[i]==b)<br>        m[i,n+1]=1;<br>       else<br>      {<br>        string s = l[i]+"H";<br>        <br>        while(!l.Contains(s))<br>          s = s.Substring(1);<br>        <br>        m[i,l.IndexOf(s)]=0.5;<br> <br> <br>        s = l[i]+"T";<br>        <br>        while(!l.Contains(s))<br>          s = s.Substring(1);<br>        <br>        m[i,l.IndexOf(s)]=0.5;<br>      }<br>    }<br>    <br>    m[n,n]=1;<br>    m[n+1,n+1]=1;<br>    <br>    <br>    for(int q = 0; q&lt;15; ++q)<br>    {<br>      double[,] tmp = new double[n+2,n+2];<br>      <br>      for(k=0; k&lt;n+2; ++k)<br>        for(i=0; i&lt;n+2; ++i)<br>          for(j=0; j&lt;n+2; ++j)<br>            tmp[i,j]+=m[i,k]*m[k,j];<br>      <br>      m=tmp;<br>    }<br>    <br>    return m[0,n];<br>  }<br>  <br>  public double bestProbability(string[] sequences)<br>  {<br>    int i, j;<br>    double best=0;<br>    <br>    double[,] vyp = new double[sequences.Length, sequences.Length];<br>    <br>    for(i=0; i&lt;sequences.Length; ++i)<br>      for(j=0; j&lt;sequences.Length; ++j)<br>        vyp[i,j]=-1;<br>    <br>    bool[] mame = new bool[sequences.Length];<br>    <br>    Random r = new Random();<br>    <br>    for(i=0; i&lt;sequences.Length; ++i)<br>    {<br>      int ii = r.Next(sequences.Length);<br>      <br>      while(mame[ii])<br>        ii = r.Next(sequences.Length);<br>      <br>      mame[ii] = true;<br>      <br>      double prob=1;<br>      <br>      for(j=0; j&lt;sequences.Length; ++j)<br>       if(ii!=j)<br>      {<br>        double mam;<br>        <br>        if(vyp[ii,j] &gt; -0.5)<br>          mam=vyp[ii,j];<br>         else<br>        {<br>          mam=test(sequences[ii], sequences[j]);<br>          vyp[ii,j]=mam;<br>          vyp[j,ii]=1-mam;<br>        }<br>        <br>        if(mam&lt;prob)<br>          prob=mam;<br>        <br>        if(prob&lt;best)<br>          break;<br>      }<br>      <br>      if(prob&gt;best)<br>        best=prob;<br>    }<br>    <br>    return best;<br>  }<br>}<br> <br> <br>// Powered by FileEdit<br></td>