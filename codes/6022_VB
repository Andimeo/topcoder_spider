<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class DigitByDigit<br>    Public Function expectedScore(ByVal digits As String) As Double<br>        Dim i, j, k, l As Integer<br> <br> <br>        Dim dTry(50, 10) As Double<br>        Dim dWeights(50, 50) As Double<br>        Dim dThis As Double<br>        Dim dPwr(50) As Double<br>        dPwr(0) = 1<br>        For i = 1 To 50<br>            dPwr(i) = 10 * dPwr(i - 1)<br>        Next<br>        dWeights(0, 0) = 4.5<br>        Dim dBest As Double<br>        Dim dBestIDX As Integer<br>        For i = 1 To 50<br>            For k = 0 To 9<br>                dBest = 0<br>                For j = 0 To i<br>                    dThis = 0<br>                    For l = 0 To j - 1<br>                        dThis += dWeights(i - 1, l) * dPwr(l)<br>                    Next<br>                    dThis += k * dPwr(j)<br>                    For l = j + 1 To i<br>                        dThis += dWeights(i - 1, l - 1) * dPwr(l)<br>                    Next<br>                    If dThis &gt; dBest Then<br>                        dBestIDX = j<br>                        dBest = dThis<br>                    End If<br>                Next<br>                For l = 0 To dBestIDX - 1<br>                    dWeights(i, l) += dWeights(i - 1, l) / 10<br>                Next<br>                dWeights(i, dBestIDX) += k / 10<br>                For l = dBestIDX + 1 To i<br>                    dWeights(i, l) += dWeights(i - 1, l - 1) / 10<br>                Next<br>            Next<br>        Next<br> <br>        j = 0<br>        Dim dRet As Double<br>        Dim N As Integer = digits.Length<br>        Dim M As Integer = 0<br>        For i = 0 To N - 1<br>            If digits.Substring(N - 1 - i, 1) = "_" Then<br>                M += 1<br>            End If<br>        Next<br> <br>        For i = 0 To N - 1<br>            If digits.Substring(N - 1 - i, 1) = "_" Then<br>                dRet += dPwr(i) * dWeights(M - 1, j)<br>                j += 1<br>            Else<br>                dRet += CInt(digits.Substring(N - 1 - i, 1)) * dPwr(i)<br>            End If<br>        Next<br> <br>        Return dRet<br>    End Function<br>End Class<br></td>