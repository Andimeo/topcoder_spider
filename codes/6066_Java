<td class="problemText" colspan="8" valign="middle" align="left">
            public class PendingTasks<br>{<br>  int max;<br>  int[] size;<br>  int[] childs;<br>  int[] value1;<br>  int[] value2;<br>  public int latestProcess(int[] supertasks)<br>  {<br>    max = supertasks.length;<br>    size = new int[max];<br>    childs = new int[max];<br>    value1 =new int[max];<br>    value2 = new int[max];<br>    for(int n=0; n&lt;max; n++)<br>    {size[n] = 0; childs[n] = 0;}<br>    for(int n=0; n&lt;max; n++)<br>    {<br>      if(supertasks[n]&lt;0)<br>        continue;<br>      size[supertasks[n]]+=1+size[n];<br>      childs[supertasks[n]]+=1;<br>    }<br>    for(int n=0; n&lt;max; n++)<br>      dp(n, supertasks);<br><br>    return value2[max-1];<br>  }<br>  public void dp(int x, int[] supertasks)<br>  {<br>    int ans1 = 0;<br>    int ans2 = 0;<br>    int max1 = 0;<br>    if(childs[x]&gt;0)<br>    {<br>    for(int n=0; n&lt;x; n++)<br>      if(supertasks[n]==x)<br>        max1 = n;<br>    for(int n=1; n&lt;x; n++)<br>      if(supertasks[n]==x &amp;&amp; value2[n]-value1[n]&gt;value2[max1]-value1[max1]) max1 = n;<br>    for(int n=0; n&lt;x; n++)<br>      if(supertasks[n]==x)<br>      {<br>        if(n==max1)<br>          ans1+=1+size[n];<br>        else<br>          ans1+=value1[n];<br>      }<br>    }<br>    if(childs[x]&lt;2){<br>    for(int n=0; n&lt;x; n++)<br>    if(supertasks[n]==x)<br>      {<br>        ans2+=1+size[n];<br>      }}<br>    else<br>    {<br>    max1 = 0;<br>    int max2 = 1;<br>    for(int n=0; n&lt;x; n++)<br>      if(supertasks[n]==x)<br>        max1 = n;<br>    for(int n=0; n&lt;x; n++)<br>      if(supertasks[n]==x&amp;&amp;n!=max1)<br>        max2 = n;<br>    for(int m=0; m&lt;x; m++)<br>      for(int n=0; n&lt;x; n++)<br>      if(n!=m &amp;&amp; supertasks[n]==x &amp;&amp; supertasks[m]==x &amp;&amp; size[n]-value1[n]+value2[m]-value1[m]&gt;size[max1]-value1[max1]+value2[max2]-value1[max2]) {max1 = n; max2 = m;}<br>    for(int n=0; n&lt;x; n++)<br>      if(supertasks[n]==x)<br>      {<br>        if(n==max1)<br>          ans2+=1+size[n];<br>        else if(n==max2)<br>          ans2+=1+value2[n];<br>        else<br>          ans2+=value1[n];<br>      }<br>    }<br>    value1[x] = ans1;  <br>    value2[x] = ans2;<br>  }<br>}<br></td>