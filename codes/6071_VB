<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class CrazySwitches<br>    Private Structure CState<br>        Public iLights As Integer<br>        Public iRoom As Integer<br>    End Structure<br>    Public Function minimumActions(ByVal switches As Integer()) As Integer<br>        Dim i, j, k, l As Integer<br>        Dim aDist(70000, 15) As Integer<br>        For i = 0 To aDist.GetUpperBound(0)<br>            For j = 0 To 15<br>                aDist(i, j) = -1<br>            Next<br>        Next<br>        aDist(1, 0) = 0<br> <br>        Dim oQueue As New Queue<br>        Dim oState As New CState<br>        oState.iLights = 1<br>        oState.iRoom = 0<br>        oQueue.Enqueue(oState)<br>        Dim iNewState As Integer<br>        Dim oNewState As CState<br> <br>        Do While oQueue.Count &gt; 0<br>            oState = DirectCast(oQueue.Dequeue, CState)<br>            iNewState = oState.iLights<br>            iNewState = iNewState Xor (1 &lt;&lt; switches(oState.iRoom))<br>            If oState.iRoom = switches.GetUpperBound(0) And iNewState = (1 &lt;&lt; oState.iRoom) Then Return aDist(oState.iLights, oState.iRoom)<br>            If (iNewState And (1 &lt;&lt; oState.iRoom) &gt; 0) Then<br>                For i = 0 To switches.GetUpperBound(0)<br>                    If ((1 &lt;&lt; i) And iNewState) &gt; 0 And i &lt;&gt; oState.iRoom Then<br>                        oNewState = New CState<br>                        oNewState.iLights = iNewState<br>                        oNewState.iRoom = i<br>                        If aDist(oNewState.iLights, oNewState.iRoom) = -1 Then<br>                            aDist(oNewState.iLights, oNewState.iRoom) = aDist(oState.iLights, oState.iRoom) + 1<br>                            oQueue.Enqueue(oNewState)<br>                        End If<br>                    End If<br>                Next<br>            End If<br>        Loop<br>        Return -1<br>    End Function<br>End Class<br></td>