<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class TakeBus<br>    Public Function expectedTime(ByVal tripTime As Integer(), ByVal waitTime As Integer()) As Double<br>        Dim i, j, k, l As Integer<br> <br>        Dim dWait(100) As Double<br> <br>        j = 101<br>        k = 101<br> <br>        For i = 0 To tripTime.GetUpperBound(0)<br>            If tripTime(i) &lt;= j Then<br>                If waitTime(i) &lt; k Or tripTime(i) &lt; j Then<br>                    k = waitTime(i)<br>                End If<br>                j = tripTime(i)<br>            End If<br>        Next<br> <br>        dWait(k - 1) = j<br>        System.Array.Sort(tripTime, waitTime)<br> <br>        Dim d, dChance As Double<br>        Dim dTime As Double<br> <br>        For i = k - 2 To 0 Step -1<br>            d = 1<br>            dTime = 0<br>            For j = 0 To tripTime.GetUpperBound(0)<br>                If waitTime(j) &gt; i Then<br>                    l = waitTime(j) - i<br>                    dChance = 1 / l<br>                    dTime += Min(tripTime(j), dWait(i + 1) + 1) * d * dChance<br>                    d *= (1 - dChance)<br>                End If<br>            Next<br>            dTime += d * (dWait(i + 1) + 1)<br>            dWait(i) = dTime<br>        Next<br> <br>        Return dWait(0)<br>    End Function<br>End Class<br></td>