<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.util.regex.*;<br>import java.text.*;<br>import java.math.*;<br>import static java.lang.Math.*;<br>import static java.util.Arrays.*;<br>public class StringReplacements {<br>  public int[] substringCounter(String letter, int left, int right, int nSeconds) {<br>    return doit(letter.charAt(0), left, right, nSeconds);<br>  }<br>  int[] doit(char c, long left, long right, int sec){<br>    if(sec &lt; 0) return null;<br>    long max = getMax(sec);<br>    if(left &lt;= 0 &amp;&amp; right &gt;= max-1){<br>      return ans(c,sec);  <br>    }<br>    if(left &gt;= max) return new int[] {0,0,0};<br>    if(right &lt; 0) return new int[] {0,0,0};<br>    int[] ret = new int[3];<br>    char[] s = look[c-'a'];<br>    for(int i = 0; i &lt; 3; i++){<br>      int[] them = doit(s[i], left-i*max/3, right-i*max/3, sec-1);<br>      for(int j = 0; j &lt; ret.length; j++){<br>        ret[j] += them[j];<br>      }<br>    }<br>    return ret;<br>  }<br>  int[] ans(char c, int sec){<br>    int[] ret = new int[3];<br>    ret[c-'a'] = 1;<br>    for(int i = 0; i &lt; sec; i++){<br>      int[] tmp = new int[3];<br>      tmp[0] = ret[0]+2*ret[1];<br>      tmp[1] = ret[0]+ret[1]+2*ret[2];<br>      tmp[2] = ret[0]+ret[2];<br>      ret = tmp;<br>    }<br>    return ret;<br>  }<br>  char[][] look = new char[][] {{'a','c','b'},{'b','a','a'},{'b','c','b'}};<br>  long getMax(int sec){<br>    long mul = 1;<br>    for(int i = 0; i &lt; sec; i++){<br>      mul *= 3;<br>    }<br>    return mul;<br>  }<br> <br>}<br> <br>// Powered by PopsEdit<br>// Powered by CodeProcessor<br></td>