<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br> <br>public class TribbloTrouble<br>{<br>  string[] c;<br>  int yy, xx;<br>  int n;<br>  <br>  int[,] ww;<br>  int wws;<br>  <br>  int go (int dy, int dx, int y, int x)<br>  {<br>//    System.Console.WriteLine ("going...{0} {1} {2} {3}", dy, dx, y, x);<br>    <br>    y += dy;<br>    x += dx;<br>    <br>    if (x &lt; 0 || y &lt; 0 || x &gt;= xx || y &gt;= yy)<br>      return -1;<br>    <br>    if (c[y][x] == 'S')<br>      return -1;<br>    <br>    if (c[y][x] == 'T')<br>      return n - 1;<br>    <br>    if (c[y][x] == 'W')<br>      return 2*ww[y,x] + Math.Abs(dx);<br>    <br>    if (c[y][x] == '/')<br>      return go (-dx, -dy, y, x);<br>    <br>    if (c[y][x] == '\\')<br>      return go (dx, dy, y, x);<br>    <br>    return go (dy, dx, y, x);<br>  }<br>  <br>  public double terminates(string[] code)<br>  {<br>    c = code;<br>    yy = code.Length;<br>    xx = code[0].Length;<br>    <br>    ww = new int[yy,xx];<br>    wws = 0;<br>    <br>    for (int y = 0; y &lt; yy; ++y)<br>      for (int x = 0; x &lt; xx; ++x)<br>    {<br>      if (code[y][x] == 'W')<br>        ww[y,x] = wws++;<br>    }<br>    <br>    n = 2*wws + 2;<br>    <br>    double[,] m = new double[n, n];<br>    <br>    for (int i = 0; i &lt; n; ++i)<br>      for (int j = 0; j &lt; n; ++j)<br>        m[i,j] = 0;<br>    <br>    m[n-1,n-1] = 1;<br>    <br>    for (int y = 0; y &lt; yy; ++y)<br>      for (int x = 0; x &lt; xx; ++x)<br>    {<br>      int kam;<br>      <br>      if (code[y][x] == 'W')<br>      {<br>        kam = go (0, 1, y, x);<br>        if (kam != -1)<br>          m[2*ww[y,x], kam] += 0.5;<br>        <br>        kam = go (0, -1, y, x);<br>        if (kam != -1)<br>          m[2*ww[y,x], kam] += 0.5;<br>        <br>        kam = go (1, 0, y, x);<br>        if (kam != -1)<br>          m[2*ww[y,x]+1, kam] += 0.5;<br>        <br>        kam = go (-1, 0, y, x);<br>        if (kam != -1)<br>          m[2*ww[y,x]+1, kam] += 0.5;<br>      }<br>      <br>      if (code[y][x] == 'S')<br>      {<br>        kam = go (0, 1, y, x);<br>        if (kam != -1)<br>          m[n-2, kam] += 0.25;<br>        <br>        kam = go (0, -1, y, x);<br>        if (kam != -1)<br>          m[n-2, kam] += 0.25;<br>        <br>        kam = go (1, 0, y, x);<br>        if (kam != -1)<br>          m[n-2, kam] += 0.25;<br>        <br>        kam = go (-1, 0, y, x);<br>        if (kam != -1)<br>          m[n-2, kam] += 0.25;<br>      }<br>    }<br>    <br>    double[,] mm;<br>    <br>    for (int it = 0; it &lt; 100; ++it)<br>    {<br>      mm = new double[n, n];<br>      <br>      for (int k = 0; k &lt;n; ++k)<br>        for (int i = 0; i &lt; n; ++i)<br>          for (int j = 0; j &lt; n; ++j)<br>            mm[i,j] += m[i,k] * m[k,j];<br>      <br>      m = mm;<br>    }<br>    <br>    return m[n-2,n-1];<br>  }<br>}<br> <br> <br>// Powered by FileEdit<br></td>