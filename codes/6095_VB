<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class SeparateConnections<br>    Public Function howMany(ByVal mat As String()) As Integer<br>        Dim i, j, k, l As Integer<br>        Dim N As Integer = mat.GetUpperBound(0)<br>        Dim iMax As Integer = (1 &lt;&lt; (N + 1)) - 1<br>        Dim aMax(iMax) As Integer<br>        Dim aConn(N, N) As Boolean<br>        For i = 0 To N<br>            For j = 0 To N<br>                If mat(i).Substring(j, 1) = "Y" Then aConn(i, j) = True<br>            Next<br>        Next<br> <br>        For i = 1 To iMax<br>            For j = 0 To N<br>                If (1 &lt;&lt; j And i) &gt; 0 Then<br>                    aMax(i) = Max(aMax(i), aMax(i - (1 &lt;&lt; j)))<br>                    For k = 0 To N<br>                        If k &lt;&gt; j And aConn(j, k) Then<br>                            If (1 &lt;&lt; k And i) &gt; 0 Then<br>                                aMax(i) = Max(aMax(i), 1 + aMax(i - (1 &lt;&lt; j) - (1 &lt;&lt; k)))<br>                            End If<br>                        End If<br>                    Next<br>                End If<br>            Next<br>        Next<br>        Return 2 * aMax(iMax)<br>    End Function<br>End Class<br></td>