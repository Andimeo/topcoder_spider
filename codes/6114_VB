<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class Shuffling<br>    Public Function position(ByVal cards As Integer, ByVal shuffles As Integer()) As Integer<br>        Dim i, j, k, l As Integer<br>        Dim iAcePos As Integer = 0<br>        Dim iNewAce As Integer<br>        Dim bTop As Boolean<br>        Dim aMap(cards - 1) As Integer<br> <br>        For i = 0 To shuffles.GetUpperBound(0)<br>            bTop = False<br>            If iAcePos &gt;= cards \ 2 Then bTop = True<br>            If shuffles(i) &gt; 0 Then<br>                j = 0<br>                k = cards \ 2<br>                l = 0<br>                Do While l &lt; shuffles(i)<br>                    aMap(l) = j<br>                    l += 1<br>                    j += 1<br>                Loop<br>                Do While j &lt; cards \ 2<br>                    aMap(l) = k<br>                    aMap(l + 1) = j<br>                    j += 1<br>                    l += 2<br>                    k += 1<br>                Loop<br>                Do While l &lt; cards<br>                    aMap(l) = k<br>                    l += 1<br>                    k += 1<br>                Loop<br>            End If<br>            If shuffles(i) &lt; 0 Then<br>                j = 0<br>                k = cards \ 2<br>                l = 0<br>                Do While l &lt; Abs(shuffles(i))<br>                    aMap(l) = k<br>                    l += 1<br>                    k += 1<br>                Loop<br>                Do While k &lt; cards<br>                    aMap(l) = j<br>                    aMap(l + 1) = k<br>                    j += 1<br>                    k += 1<br>                    l += 2<br>                Loop<br>                Do While l &lt; cards<br>                    aMap(l) = j<br>                    l += 1<br>                    j += 1<br>                Loop<br>            End If<br> <br>            For j = 0 To cards - 1<br>                If aMap(j) = iAcePos Then iNewAce = j<br>            Next<br>            iAcePos = iNewAce<br>        Next<br>        Return iAcePos<br> <br>    End Function<br>End Class<br></td>