<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class ScrabbleBet<br>    Public Function estimate(ByVal trials As Integer, ByVal games As Integer, ByVal winsNeeded As Integer, ByVal winChance As Integer) As Double<br>        Dim i, j, k, l As Integer<br> <br>        Dim lFact(20) As Long<br>        lFact(0) = 1<br>        For i = 1 To 20<br>            lFact(i) = lFact(i - 1) * CLng(i)<br>        Next<br> <br>        Dim h As Long<br> <br>        Dim dTrialWin As Double<br>        Dim d As Double<br>        dTrialWin = 0<br>        For i = 0 To winsNeeded - 1<br>            d = 1<br>            For j = 1 To i<br>                d *= winChance / 100<br>            Next<br>            For j = i + 1 To games<br>                d *= (100 - winChance) / 100<br>            Next<br>            h = lFact(games)<br>            h /= lFact(i)<br>            h /= lFact(games - i)<br>            d *= h<br>            dTrialWin += d<br>        Next<br> <br>        Return 1 - (dTrialWin ^ trials)<br>    End Function<br> <br>End Class<br></td>