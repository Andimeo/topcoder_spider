<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Math<br> <br>Public Class OrderDoesMatter<br>    Public Function getOrder(ByVal N As Integer(), ByVal M As Integer()) As Integer<br>        Dim i, j, k, l As Integer<br> <br>        Dim aPaths(1000, 1000) As Integer<br> <br>        Dim aDis(1000) As Integer<br>        Dim aOut(1000) As Integer<br>        Dim aIn(1000) As Integer<br> <br>        For i = 0 To N.GetUpperBound(0)<br>            aPaths(N(i), M(i)) += 1<br>            aOut(N(i)) += 1<br>            aIn(M(i)) += 1<br>        Next<br> <br>        For i = 0 To 1000<br>            aDis(i) = -1<br>        Next<br>        aDis(N(0)) = 0<br> <br>        For i = 0 To N.GetUpperBound(0)<br>            For j = 0 To N.GetUpperBound(0)<br>                If aDis(N(j)) &gt;= 0 And aDis(M(j)) = -1 Then<br>                    aDis(M(j)) = 0<br>                End If<br>                If aDis(M(j)) &gt;= 0 And aDis(N(j)) = -1 Then<br>                    aDis(N(j)) = 0<br>                End If<br>            Next<br>        Next<br> <br>        Dim iIn, iOut As Integer<br>        iIn = -1<br>        iOut = -1<br> <br>        For i = 0 To 1000<br>            If aOut(i) &gt; aIn(i) Then<br>                If iOut &gt;= 0 Then Return -1<br>                If aOut(i) - 1 &gt; aIn(i) Then Return -1<br>                iOut = i<br>            End If<br>            If aOut(i) &lt; aIn(i) Then<br>                If iIn &gt;= 0 Then Return -1<br>                If aOut(i) + 1 &lt; aIn(i) Then Return -1<br>                iIn = i<br>            End If<br> <br>            If (aOut(i) &gt; 0 Or aIn(i) &gt; 0) And aDis(i) = -1 Then Return -1<br>        Next<br> <br>        If iIn = -1 Xor iOut = -1 Then Return -1<br> <br>        If iIn &gt;= 0 Then Return iIn * iOut<br>        For i = 1000 To 0 Step -1<br>            If aDis(i) &gt;= 0 Then Return i * i<br>        Next<br> <br>    End Function<br>End Class<br></td>