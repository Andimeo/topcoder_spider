<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br><br>public class CountingCommonSubsequences {<br>  string a,b,c;<br>  long[,,] memo = new long[51,51,51];<br>  int[,] nexta = new int[51,26];<br>  int[,] nextb = new int[51,26];<br>  int[,] nextc = new int[51,26];<br><br>  public void CalcNext(int[,] next, string s)<br>  {<br>    for (int i = 0; i &lt; 26; i++)<br>    {<br>      char c = (char) ('a' + i);<br>      for (int j = 0; j &lt; s.Length; j++)<br>      {<br>        int k=j;<br>        while (k &lt; s.Length &amp;&amp; s[k] != c) k++;<br>        if (k == s.Length) k = -1;<br>        next[j,i] = k;<br>      }<br>      next[s.Length, i] = -1;<br>    }<br>  }<br><br>  public long go(int x, int y, int z)<br>  {<br>    if (memo[x,y,z] &gt;= 0) return memo[x,y,z];<br>    long cnt = (x+y+z == 0) ? 0 : 1; <br>    for (int i = 0; i &lt; 26; i++)<br>    {<br>      if (nexta[x,i] &gt;= 0 &amp;&amp; nextb[y,i] &gt;= 0 &amp;&amp; nextc[z,i] &gt;= 0)<br>        cnt += go(nexta[x,i]+1, nextb[y,i]+1, nextc[z,i]+1);<br>    }<br>    memo[x,y,z] = cnt;<br>    return cnt;<br>  }<br><br>  public long countCommonSubsequences(string a, string b, string c) {<br>    this.a=a; this.b=b; this.c=c;<br>    for (int i = 0; i &lt;= 50; i++)<br>      for (int j = 0; j &lt;= 50; j++)<br>        for (int k = 0; k &lt;= 50; k++)<br>          memo[i,j,k] = -1;<br>    CalcNext(nexta, a);<br>    CalcNext(nextb, b);<br>    CalcNext(nextc, c);<br>    return go(0,0,0);<br>  }<br><br>}<br><br><br>// Powered by FileEdit<br></td>