<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;iostream&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;functional&gt;<br>#include &lt;numeric&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;cmath&gt;<br>#include &lt;queue&gt;<br> <br>using namespace std;<br> <br>int n,ll,po,best;<br>char s[100];<br>string sp,ru,bs;<br> <br>class Wizarding<br>{<br>public:<br>int cmp(char *s,string bs)<br>{<br>  int i;<br>  for (i=0;i&lt;bs.length();i++)<br>  {<br>    if (s[i]&gt;bs[i]) return 0;<br>    if (s[i]&lt;bs[i]) return 1;<br>  }<br>  return 0;<br>}<br> <br>void search(int x)<br>{<br>  int tmp;<br>  if (x==n)<br>  {<br>    if (ll==0) return;<br>    if ((po&gt;best)||((po==best)&amp;&amp;(ll&lt;bs.length()))||((po==best)&amp;&amp;(ll==bs.length())&amp;&amp;(cmp(s,bs)==1)))<br>    {<br>      s[ll]='\0';<br>      best=po;<br>      bs=s;<br>    }<br>    return;<br>  }<br>  tmp=po;<br>  search(x+1);<br>  s[ll]=sp[x];<br>  po*=(sp[x]-'A'+1);<br>  po%=77077;<br>  ll++;<br>  search(x+1);<br>  ll--;<br>  if (ru[sp[x]-'A']!='-')<br>  {<br>    s[ll]=ru[sp[x]-'A'];<br>    po=tmp*(s[ll]-'A'+1);<br>    po%=77077;<br>    ll++;<br>    search(x+1);<br>    ll--;<br>  }<br>  po=tmp;<br>}<br> <br>string counterspell(string spell, string rules)<br>{<br>  sp=spell;<br>  ru=rules;<br>  n=spell.size();<br>  ll=0;<br>  po=1;<br>  best=-1;<br>  search(0);<br>  return bs;<br>}<br>};<br></td>