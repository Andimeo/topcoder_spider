<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;iostream&gt;<br>#include &lt;queue&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cmath&gt;<br>using namespace std;<br>#define EPS 1e-8<br>#define INF 1100000000<br>#define F0(i, n) for (i = 0; i &lt; n; i++)<br>#define FR(i, j, n) for (i = j; i &lt; n; i++)<br>typedef long long LL;<br>int i, j, k, n, N;<br>LL m, ret;<br>LL a[75][75], b[75][75], c[75][75];<br> <br> <br>void setnam(LL a[75][75], LL b[75][75], LL c[75][75])<br>{<br>  int i, j, k;<br>  F0(i, N) F0(j, N) c[i][j] = 0;<br>  F0(i, N) F0(j, N) F0(k, N) c[i][j] = (c[i][j] + a[i][k] * b[k][j]) % m;<br>}<br> <br>void setxar(LL a[75][75], LL b[75][75], LL k)<br>{<br>  int i, j;<br>  if (k == 1)<br>  {<br>    F0(i, N) F0(j, N) b[i][j] = a[i][j];<br>    return;<br>  }<br>  LL c[75][75];<br>  if (k % 2 == 0)<br>  {<br>    setxar(a, c, k/2);<br>    setnam(c, c, b);<br>  }else<br>  {<br>    setxar(a, b, k/2);<br>    setnam(b, b, c);<br>    setnam(a, c, b);<br>  }<br>}<br> <br>class TourCounting {<br>public:<br>int countTours(vector &lt;string&gt; g, int k, int m1) <br>{<br>  m = m1;<br>  n = g.size();<br>  F0(i, n) F0(j, n) a[i][j] = (g[i][j] == 'Y') ? 1 : 0;<br>  F0(i, n) { a[i][n + i] = 1; a[n + i][n + i] = 1; }<br>  N = 2 * n;  <br>  setxar(a, b, k - 1);<br>  F0(i, n) F0(j, n) ret = (ret + b[i][j + n] * a[j][i]) % m;<br>  return ret;<br> <br>}<br>};<br> <br>// Powered by PopsEdit<br></td>