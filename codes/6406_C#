<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br>using System.Collections.Generic;<br><br>public class WebsiteRank {<br>    public long countVotes(string[] votes, string website) {<br><br><br>        int N = votes.Length;<br>        Dictionary&lt;string, int&gt; oSites = new Dictionary&lt;string, int&gt;();<br>        for (int i = 0; i &lt; N; i++) {<br>            oSites.Add(votes[i].Split(' ')[0],i);<br>        }<br>        if (!oSites.ContainsKey(website)) return 1;<br>        bool[,] bDirect = new bool[N, N];<br>        int[] iExternal = new int[N];<br>        for (int i = 0; i &lt; N; i++) {<br>            string[] sSites = votes[i].Split(' ');<br>            for (int j = 1; j &lt; sSites.Length; j++) {<br>                if (oSites.ContainsKey(sSites[j])) {<br>                    bDirect[oSites[sSites[j]],i]=true;<br>                } else {<br>                    iExternal[i]++;<br>                }<br>            }<br>        }<br><br>        bool[,] bIndirect = new bool[N, N];<br>        for (int i = 0; i &lt; N; i++) {<br>            for (int j = 0; j &lt; N; j++) {<br>                bIndirect[i, j] = bDirect[i, j];<br>            }<br>        }<br>        for (int i = 0; i &lt; N; i++) {<br>            for (int j = 0; j &lt; N; j++) {<br>                for (int k = 0; k &lt; N; k++) {<br>                    bIndirect[j, k] |= bIndirect[j, i] &amp;&amp; bIndirect[i, k];<br>                }<br>            }<br>        }<br><br>        long[] iVotes = new long[N];<br>        for (int i = 0; i &lt; N; i++) {<br>            for (int j = 0; j &lt; N; j++) {<br>                long iSub=0;<br>                for (int k = 0; k &lt; N; k++) {<br>                    if (bDirect[k, j] &amp;&amp; !bIndirect[j, k]) iSub += iVotes[k];<br>                }<br>                iVotes[j] = iSub + iExternal[j] + 1;<br>            }<br>        }<br>        return iVotes[oSites[website]];<br>    }<br>}<br></td>