<td class="problemText" colspan="8" valign="middle" align="left">
            imports System<br>imports Microsoft.VisualBasic<br>imports System.Collections<br>imports System.Text<br> <br> <br>Public Class PartSorting<br> <br>    Public Function process(ByVal data() As Integer, ByVal nSwaps As Integer) As Integer()<br>        Return p2(data, nSwaps, 0)<br>    End Function<br> <br>    Public Function p2(ByVal data() As Integer, ByVal nSwaps As Integer, ByVal process As Integer) As Integer()<br>        Dim i As Integer, iSmallest As Integer<br> <br>        If process = data.Length Then Return data<br> <br>        iSmallest = process<br>        For i = process + 1 To Math.Min(nSwaps + process, data.Length - 1)<br>            If data(i) &gt; data(iSmallest) Then<br>                iSmallest = i<br>            End If<br>        Next<br> <br>        Dim iTop As Integer<br>        If iSmallest &lt;&gt; process Then<br>            For iTop = iSmallest To process + 1 Step -1<br>                Swap(data(iTop), data(iTop - 1))<br>            Next<br>        End If<br> <br>        nSwaps = nSwaps - (iSmallest - process)<br>        Return p2(data, nSwaps, process + 1)<br> <br>    End Function<br> <br>    Private Sub Swap(ByRef i1 As Integer, ByRef i2 As Integer)<br>        Dim it As Integer<br>        it = i1<br>        i1 = i2<br>        i2 = it<br>    End Sub<br> <br>End Class<br></td>