<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections;<br> <br>public class BiggestRectangleHard<br>{<br>  int[] l;<br>  int n;<br>  int nn;<br>  <br>  bool[] ca;<br>  <br>  int gh (int m)<br>  {<br>    int max = 0;<br>    <br>    ca[0] = true;<br>    <br>    for (int i = 0; i &lt; n; ++i)<br>      if ((m &amp; (1 &lt;&lt; i)) != 0)<br>    {<br>      int aa = l[i];<br>      <br>      for (int j = 1; j &lt;= aa; ++j)<br>        ca[max + j] = false;<br>      <br>      for (int j = max; j &gt;= 0; --j)<br>        ca[j + aa] |= ca[j];<br>      <br>      max += aa;<br>    }<br>    <br>    if (max % 2 == 1)<br>      return 0;<br>    <br>    if (ca[max / 2])<br>      return max / 2;<br>    <br>    return 0;<br>  }<br>  <br>  <br>  public int findArea(int[] lengths)<br>  {<br>    n = lengths.Length;<br>    nn = 1 &lt;&lt; n;<br>    l = lengths;<br>    <br>    ca = new bool[161];<br>    <br>    int[] x = new int[nn];<br>    <br>    x[0] = 0;<br>    for (int i = 1; i &lt; nn; ++i)<br>    {<br>      x[i] = gh (i);<br>      <br>      for (int j = 0; j &lt; n; ++j)<br>        if ((i &amp; (1 &lt;&lt; j)) != 0)<br>          x[i] = Math.Max (x[i], x[i - (i &amp; (1 &lt;&lt; j))]);<br>    }<br>    <br>    int max = 0;<br>    <br>    for (int i = 0; i &lt; nn; ++i)<br>      max = Math.Max (max, x[i] * x[nn - 1 - i]);<br>    <br>    if (max == 0)<br>      return -1;<br>    <br>    return max;<br>  }<br>}<br> <br> <br>// Powered by FileEdit<br></td>