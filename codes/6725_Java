<td class="problemText" colspan="8" valign="middle" align="left">
            // Leafy tops of root vegetables strike back... :)<br>import java.util.*;<br>public class FactoryCounting {<br>  int[] gmask;<br>  long ans = 0;<br>  long[][] c;<br>  <br>  int oneCnt(int tmp) {<br>    int res = 0;<br>    while (tmp &gt; 0) {<br>      res++;<br>      tmp &amp;= tmp - 1;<br>    }<br>    return res;<br>  }<br>  <br>  void go(int left, int last, int mask, int n, int m) {<br>    if (oneCnt(mask) &lt; n) return;<br>    if (left == 0) {<br>      int cnt = oneCnt(mask);<br>      ans += c[cnt][n];<br>      return;<br>    }<br>    for (int i = last + 1; i &lt; k; i++) {<br>      go(left - 1, i, mask &amp; gmask[i], n,  m);<br>    }<br>  }<br>  int k;<br>    public long count(int n, int m, String[] county) {<br>        k = county.length;<br>        <br>        c = new long[40][40];<br>        c[0][0] = 1;<br>        for (int i = 1; i &lt; 40; i++) {<br>          c[i][0] = 1;<br>          for (int j = 1; j &lt; 40; j++) {<br>            c[i][j] = c[i - 1][j] + c[i - 1][j - 1];<br>          }<br>        }<br>        <br>        gmask = new int[k];<br>        for (int i = 0; i &lt; k; i++) {<br>          for (int j = 0; j &lt; k; j++) {<br>            if (county[i].charAt(j) == 'Y') gmask[i] += (1 &lt;&lt; j);<br>          }<br>        }<br>        <br>        go(m, -1, (1 &lt;&lt; k) - 1, n, m);<br>        <br>        return ans;<br>    }<br><br>}<br><br><br>// Powered by FileEdit<br>// Powered by CodeProcessor<br></td>