<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.util.regex.*;<br>import java.text.*;<br>import java.math.*;<br>import java.awt.geom.*;<br> <br>public class MatrixPainting<br>{<br>  static final int M = 1 &lt;&lt; 18;<br>  <br>  static final int INF = 1000;<br>  <br>  static final int MASK = (1 &lt;&lt; 9) - 1;<br>  <br>  int[] f, row, col, value;<br>  <br>  public int countRepaints(String[] matrix)<br>  {<br>    value = new int[1 &lt;&lt; 9];<br>    for (int i = 1; i &lt; (1 &lt;&lt; 9); ++i)<br>      value[i] = value[i &gt;&gt; 1] + (i &amp; 1);<br>    f = new int[M];<br>    row = new int[9];<br>    col = new int[9];<br>    for (int i = 0; i &lt; 9; ++i)<br>      for (int j = 0; j &lt; 9; ++j)<br>        if (matrix[i].charAt(j) == '1')<br>        {<br>          row[i] |= 1 &lt;&lt; j;<br>          col[j] |= 1 &lt;&lt; i;<br>        }<br>    for (int i = 1; i &lt; M; f[i++] = INF);<br>    for (int k = 0; k &lt; M; ++k)<br>      if (f[k] != INF)<br>      {<br>        for (int i = 0; i &lt; 9; ++i)<br>          if ((k &gt;&gt; i &amp; 1) == 0)<br>          {<br>            int mask = row[i] | (k &gt;&gt; 9 &amp; MASK);<br>            if (value[mask] &lt; 5)<br>              continue;<br>            int v = f[k] + (value[mask] == 9 ? 0 : 1);<br>            if (v &lt; f[k | 1 &lt;&lt; i])<br>              f[k | 1 &lt;&lt; i] = v;<br>          }<br>        for (int i = 0; i &lt; 9; ++i)<br>          if ((k &gt;&gt; i + 9 &amp; 1) == 0)<br>          {<br>            int mask = col[i] | (k &amp; MASK);<br>            if (value[mask] &lt; 5)<br>              continue;<br>            int v = f[k] + (value[mask] == 9 ? 0 : 1);<br>            if (v &lt; f[k | 1 &lt;&lt; i + 9])<br>              f[k | 1 &lt;&lt; i + 9] = v;<br>          }<br>      }<br>    return f[M - 1] == INF ? -1 : f[M - 1];<br>  }<br>  <br>  <br>}<br>//Powered by [KawigiEdit] 2.0!<br></td>