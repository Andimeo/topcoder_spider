<td class="problemText" colspan="8" valign="middle" align="left">
            imports System<br>imports Microsoft.VisualBasic<br>imports System.Collections<br>imports System.Text<br> <br> <br>'imports System<br>'imports Microsoft.VisualBasic<br>'imports System.Collections<br>'imports System.Text<br> <br>Public Class LongLongNim<br> <br>    Dim winner() As Integer<br> <br>    Public Function numberOfWins(ByVal maxN As Integer, ByVal moves() As Integer) As Integer<br>        FigureWinners(moves, Math.Min(30000, maxN))<br>        Dim i As Integer, r As Integer, sure As Integer<br> <br>        If maxN &lt; 30000 Then<br>            sure = 0<br>            For i = 1 To maxN<br>                If Not winner(i) Then sure += 1<br>            Next<br>            Return sure<br>        End If<br> <br>        'sure = 0<br>        'For i = 1 To maxN<br>        '    If Not winner(i) Then sure += 1<br>        'Next<br> <br>        For i = 1 To 20000<br>            If Not winner(i) Then r += 1<br>        Next<br> <br>        Dim replen As Integer, bGood As Boolean<br> <br>        For replen = 1000 To 1 Step -1<br>            bGood = True<br>            For i = 0 To replen - 1<br>                If winner(20000 - replen - i) &lt;&gt; winner(20000 - i) Then<br>                    bGood = False<br>                    Exit For<br>                End If<br>            Next<br> <br> <br>            If bGood Then<br> <br>                Dim cover As Integer<br>                Dim lastTime, reps As Integer<br>                cover = maxN - 20000<br>                reps = cover \ replen<br>                lastTime = cover Mod replen<br> <br>                For i = (20000 - replen + 1) To 20000<br>                    If Not winner(i) Then<br>                        If i - (20000 - replen + 1) &lt; lastTime Then<br>                            r += 1<br>                        End If<br>                        r += reps<br>                    End If<br>                Next<br> <br>                Return r<br>            End If<br>        Next<br> <br>        Return -1<br>    End Function<br> <br>    Private Sub FigureWinners(ByVal moves() As Integer, ByVal max As Integer)<br>        ReDim winner(max)<br> <br>        Dim r As Integer, im As Integer<br>        For r = 0 To max<br>            For im = 0 To moves.Length - 1<br>                If r &gt;= moves(im) Then<br>                    If Not winner(r - moves(im)) Then<br>                        winner(r) = True<br>                    End If<br>                End If<br>            Next<br>        Next<br>    End Sub<br> <br>End Class<br></td>