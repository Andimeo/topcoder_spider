<td class="problemText" colspan="8" valign="middle" align="left">
            import java.io.*;<br>import java.math.*;<br>import java.util.*;<br>import java.text.*;<br>public class Amazing{<br>  double[][] graph;<br>  int n;<br>  double[][] dyn1;<br>  double[][] dyn2;<br>  int[] degn; <br>  double[] factors;<br>  public double totalE(double factor,int numTrips,String[] effort)<br>  {<br>    n=effort.length;<br>    graph=new double[n+1][n+1];<br>    int i,j,k;<br>    for (i=0;i&lt;n;i++)<br>    {<br>      String[] ss=effort[i].split(" ");<br>      for (j=0;j&lt;n;j++)<br>        graph[i][j]=Double.parseDouble(ss[j]);<br>    }<br>    int l1=numTrips/2;<br>    int l2=numTrips-l1;<br>    degn=new int[10];<br>    degn[0]=1;<br>    for (i=1;i&lt;10;i++)<br>      degn[i]=degn[i-1]*n;<br>    dyn1=new double[n][degn[l1]];<br>    dyn2=new double[n][degn[l2]];<br>    factors=new double[numTrips];<br>    factors[0]=1;<br>    for (i=1;i&lt;numTrips;i++)<br>      factors[i]=factors[i-1]*factor;<br>    for (i=0;i&lt;n;i++)<br>    {<br>      for (j=0;j&lt;degn[l1];j++)<br>      {<br>        double sum=0;<br>        int cur=i;<br>        int jj=j;<br>        for (k=0;k&lt;l1;k++)<br>        {<br>          sum+=graph[jj%n][cur]*factors[l1-k-1];<br>          cur=jj%n;<br>          jj=jj/n;<br>        }<br>        dyn1[i][j]=sum;<br>      }<br>    }<br>    for (i=0;i&lt;n;i++)<br>    {<br>      for (j=0;j&lt;degn[l2];j++)<br>      {<br>        double sum=1000;<br>        int cur=i;<br>        int jj=j;<br>        for (k=0;k&lt;l2;k++)<br>        {<br>          sum-=graph[cur][jj%n]*factors[l1+k];<br>          cur=jj%n;<br>          jj=jj/n;<br>        }<br>        dyn2[i][j]=sum;<br>      }<br>    }<br>    double res=1e+100;<br>    for (i=0;i&lt;n;i++)<br>    {<br>      Arrays.sort(dyn1[i]);<br>      Arrays.sort(dyn2[i]);<br>      int i1=0;<br>      int i2=0;<br>      while (i1&lt;degn[l1] &amp;&amp; i2&lt;degn[l2])<br>      {<br>        res=Math.min(res,Math.abs(dyn1[i][i1]-dyn2[i][i2]));<br>        if (dyn1[i][i1]&lt;dyn2[i][i2])<br>          i1++;<br>        else<br>          i2++;<br>      }<br>    }<br>    return res;<br>  }<br>}<br></td>