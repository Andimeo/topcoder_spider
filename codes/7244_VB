<td class="problemText" colspan="8" valign="middle" align="left">
            imports System<br>imports Microsoft.VisualBasic<br>imports System.Collections<br>imports System.Text<br> <br> <br>'imports System<br>'imports Microsoft.VisualBasic<br>'imports System.Collections<br>'imports System.Text<br> <br>Public Class ExtendedHappyNumbers<br> <br>    Private k As Long<br>    Private sk(1000000) As Long<br>    Private memo(1000000) As Long<br>    Private p(10) As Long<br> <br>    Public Function calcTheSum(ByVal A As Integer, ByVal B As Integer, ByVal Kk As Integer) As Long<br>        k = Kk<br> <br>        Dim i As Integer, v As Long, sum As Long<br>        For i = 0 To 9<br>            p(i) = i ^ k<br>        Next<br>        For i = 0 To 1000000<br>            sk(i) = -1<br>            memo(i) = -1<br>        Next<br> <br>        For i = A To B<br>            v = happy(i, i)<br>            '            'debug.print(i &amp; ":" &amp; v)<br>            sum += v<br>        Next<br> <br>        Return sum<br>    End Function<br> <br>    Private Function happy(ByVal iSlow As Long, ByVal iFast As Long) As Long<br>        If iSlow &lt; 1000000 AndAlso memo(iSlow) &lt;&gt; -1 Then<br>            Return memo(iSlow)<br>        End If<br> <br>        Dim best As Long, org As Long<br>        org = iSlow<br> <br>        iSlow = skc(iSlow)<br>        iFast = skc(skc(iFast))<br> <br>        best = Math.Min(iSlow, org)<br> <br>        If iFast &lt;&gt; iSlow Then<br>            best = Math.Min(best, happy(iSlow, iFast))<br>        Else<br>            Dim iCur As Long<br> <br>            iCur = skc(iSlow)<br>            best = Math.Min(iCur, best)<br>            While iCur &lt;&gt; iFast<br>                iCur = skc(iCur)<br>                best = Math.Min(iCur, best)<br>            End While<br> <br>        End If<br> <br>        If org &lt; 1000000 Then memo(org) = best<br>        Return best<br>    End Function<br> <br>    Private Function skc(ByVal i As Long) As Long<br>        If i &lt; 1000000 AndAlso sk(i) &lt;&gt; -1 Then Return sk(i)<br>        Dim t As Long, ret As Long<br>        t = i<br>        While t &gt; 0<br>            ret += p(t Mod 10)<br>            t \= 10<br>        End While<br> <br>        If i &lt; 1000000 Then sk(i) = ret<br>        Return ret<br>    End Function<br> <br>End Class<br></td>