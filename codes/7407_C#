<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br><br>public class AnagramList{<br>public string getAnagram(string ss, int need){<br>int i,j,l,n;<br>long c;<br>string res="";<br>char[] qc=new char[22];<br>n=ss.Length;<br>for (i=0;i&lt;n;i++){<br>  qc[i]=(char)(ss[i]);<br>}<br>//if (n==4) {return (""+qc[0]+qc[1]+qc[2]+qc[3]);}<br>char mm;<br>for (i=0;i&lt;n;i++){<br>  for (j=i+1;j&lt;n;j++) {<br>    if (qc[i]&gt;qc[j]) {<br>      mm=qc[i];qc[i]=qc[j];qc[j]=mm;<br>      }<br>    }<br>  }<br>long[] f=new long[22];<br>f[0]=1;<br>for (i=1;i&lt;22;i++) {f[i]=(long)i*f[i-1];}<br>long[,] cc=new long[22,22];<br>for (i=0;i&lt;21;i++) {cc[i,0]=1;}<br>for (i=1;i&lt;21;i++){<br>  for (j=1;j&lt;21;j++){<br>    cc[i,j]=cc[i-1,j-1]+cc[i-1,j];    <br>  }<br>}<br>int[] co=new int[22];<br>char[] let=new char[22];<br>let[0]=qc[0];<br>co[0]=1;<br>j=0;<br>for (i=1;i&lt;n;i++){<br>  if (qc[i]==qc[i-1]) {co[j]++;}<br>  else {<br>  j++;<br>  let[j]=qc[i];<br>  co[j]=1;  <br>  }<br>}<br>int nn=j+1;<br>long num=f[n];<br>for (i=0;i&lt;nn;i++) {<br>  num=num/f[co[i]];<br>  }<br>if (need&gt;=num) {<br>  //for (i=0;i&lt;nn;i++) {<br>  //  res=res+co[i]+" ";<br>  //  }<br>  //return res+""+num+" "+f[12];<br>  return "";<br>  }<br>long sum=(long)need;<br>long cur;<br>int[] u=new int[22];<br>for (i=0;i&lt;nn;i++){u[i]=co[i];}<br>for (l=n;l&gt;0;l--){<br>  j=0;<br>  cur=0;<br>  i=-1;<br>  c=0;<br>  while (cur&lt;=sum){<br>    i++;<br>    c=0;<br>    if (co[i]&gt;0) {<br>      for (j=0;j&lt;nn;j++) {u[j]=co[j];}<br>      u[i]--;<br>      c=f[l-1];<br>      for (j=0;j&lt;nn;j++) {c=c/f[u[j]];}<br>      cur+=c;<br>      //if (l==3) {return ""+i+" "+cur+" "+sum+" "+co[0]+co[1]+co[2];}<br>      }<br>  }<br>  res=res+let[i];<br>  cur-=c;<br>  sum-=cur;<br>  co[i]--;<br>}<br>return res;<br>}<br>}<br></td>