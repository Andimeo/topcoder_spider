<td class="problemText" colspan="8" valign="middle" align="left">
            const double EPS = 1e-8;<br><br>double ps[64][15][2048];<br><br>class TestBettingStrategy<br>{<br>public:  <br>  double winProbability(int iS, int gS, int r, int p)<br>  {<br>    int i;<br>    int j;<br>    int k;<br>    double res = 0;<br>    double prob = (double)p / 100.0;<br><br>    ps[0][0][iS] = 1.0;<br><br>    for ( i=0; i&lt;r; i++ )<br>    {<br>      for ( j=0; j&lt;12; j++ )<br>        for ( k=0; k&lt;gS; k++ )<br>          if ( k &gt;= ( 1 &lt;&lt; j ) )<br>          {<br>            //win<br>            ps[i+1][0][k+( 1 &lt;&lt; j )] += ps[i][j][k] * prob;<br>            //lose<br>            ps[i+1][j+1][k-( 1 &lt;&lt; j )] += ps[i][j][k] * ( 1.0 - prob );<br>          }<br>    }<br><br>    for ( i=0; i&lt;=r; i++ )<br>      for ( j=0; j&lt;=12; j++ )<br>        for ( k=gS; k&lt;2048; k++ )<br>          res += ps[i][j][k];<br><br>    return res;<br>  }<br>};<br></td>