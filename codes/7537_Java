<td class="problemText" colspan="8" valign="middle" align="left">
            public class GamesSchedule<br>{<br>  int n;<br>  char[][] s;<br>  <br>  public int dfs (int x, int y, int[] color, int[] games, int gc, int exp)<br>  {<br>    if (y == s.length)<br>      return dfs(x+1, 0, color, games, 0, -1);<br>    <br>    if (x == s.length)<br>    {<br>      for (int i = 0; i &lt; games.length; i++)<br>        if (games[i] != n)<br>          return 0;<br>      <br>      return 1;<br>    }<br>    <br>    if (s[x][y] == '-')<br>      return dfs(x, y+1, color, games, gc, exp);<br>    <br>    if (s[x][y] == '?')<br>    {<br>      int out = 0;<br>      if (n != s.length)<br>        out = dfs(x, y+1, color, games, gc, exp);<br>      for (int i = 0; i &lt; n; i++)<br>      {<br>        int t = 1 &lt;&lt; i;<br>        if ((color[y] &amp; t) == 0 &amp;&amp; <br>            (gc &amp; t) == 0 &amp;&amp; <br>            (games[y] == exp || exp == -1))<br>        {<br>          games[y]++;<br>          color[y] ^= t;<br>          out += dfs(x, y+1, color, games, gc ^ t, games[y]-1);<br>          games[y]--;<br>          color[y] ^= t;<br>        }<br>      }<br>      return out;<br>    }<br>    <br>    int t = (1 &lt;&lt; (s[x][y]-'A'));<br>    if ((color[y] &amp; t) == 0 &amp;&amp; <br>        (gc &amp; t) == 0 &amp;&amp; <br>        (games[y] == exp || exp == -1))<br>    {<br>      games[y]++;<br>      color[y] ^= t;<br>      int out = dfs(x, y+1, color, games, gc ^ t, games[y]-1);<br>      games[y]--;<br>      color[y] ^= t;<br>      return out;<br>    }<br>    return 0;<br>  }  <br>  <br>  public int howMany (String[] in, int inN)<br>  {<br>    n = inN;<br>    s = new char [in.length][in.length];<br>    for (int i = 0; i &lt; s.length; i++)<br>      for (int j = 0; j &lt; s.length; j++)<br>        s[i][j] = in[i].charAt(j);<br>    <br>    return dfs(0, 0, new int [s.length], new int [s.length], 0, -1);<br>  }<br>}<br></td>