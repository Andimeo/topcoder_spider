<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt;<br>#include &lt;string&gt;<br>using namespace std;<br> <br>int g[50][50];<br>int cs[50][2];<br>int rn, cn;<br> <br>int cache[50][1&lt;&lt;12];<br> <br>#define INF 0x01010101<br> <br>struct TaxiManager<br>{<br>int go(int loc, int mask)<br>{<br>  if (mask == 0) {<br>    return g[loc][0];<br>  }<br>  int&amp; ret = cache[loc][mask];<br>  if (ret != -1) return ret;<br>  <br>  ret = INF;<br>  for (int i = 0; i &lt; cn; ++i) if ((mask&amp;(1&lt;&lt;i))) {<br>    int d = g[loc][cs[i][0]];<br>    int x = g[cs[i][0]][cs[i][1]];<br>    ret = min(ret, x+d+go(cs[i][1], mask^(1&lt;&lt;i)));<br>  }<br>  return ret;<br>}<br> <br>int schedule(vector&lt;string&gt; r, vector&lt;string&gt; c)<br>{<br>  rn = r.size();<br>  <br>  memset(g, 1, sizeof(g));<br>  for (int i = 0; i &lt; rn; ++i) {<br>    for (int j = 0; j &lt; rn; ++j) if (r[i][j] != '0') g[i][j] = r[i][j]-'0';<br>  }<br>  for (int k = 0; k &lt; rn; ++k) {<br>    for (int i = 0; i &lt; rn; ++i) {<br>      for (int j = 0; j &lt; rn; ++j) g[i][j] = min(g[i][j], g[i][k] + g[k][j]);<br>    }<br>  }<br>  for (int i = 0; i &lt; rn; ++i) g[i][i] = 0;<br>  <br>  cn = c.size();<br>  for (int i = 0; i &lt; cn; ++i) {<br>    sscanf(c[i].c_str(), "%d%d", &amp;cs[i][0], &amp;cs[i][1]);<br>  }<br> <br>  memset(cache, -1, sizeof(cache));  <br>  int ret = INT_MAX;<br>  for (int i = 0; i &lt; (1&lt;&lt;cn); ++i) {<br>    int c1 = i, c2 = (~i)&amp;((1&lt;&lt;cn)-1);<br>    ret = min(ret, max(go(0, c1), go(0, c2)));<br>  }<br>  return ret;<br>}<br>};<br></td>