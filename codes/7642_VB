<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Public Class PacketRepack<br>    Public Function output(ByVal input As Integer(), ByVal b As Integer, ByVal num_fields As Integer, ByVal field_size As Integer) As Integer()<br>        Dim inarr(num_fields * field_size) As Integer<br>        Dim outarr(num_fields * field_size) As Integer<br>        Dim i As Integer, j As Integer<br>        For i = 0 To num_fields - 1<br>            For j = 0 To field_size - 1<br>                outarr((num_fields - i - 1) * field_size + j) = getBit(input, b, i * field_size + j)<br>            Next<br>        Next<br>        Dim ret(input.GetUpperBound(0)) As Integer<br>        For i = 0 To num_fields * field_size - 1<br>            j = i Mod b<br>            ret(Int(i / b)) = ret(Int(i / b)) Or outarr(i) * 2 ^ j<br>        Next<br>        output = ret<br>    End Function<br>    Function getBit(ByVal inp As Integer(), ByVal b As Integer, ByVal n As Integer) As Integer<br>        Dim i As Integer, j As Integer<br>        j = n Mod b<br>        i = Int(n / b)<br>        If inp(i) And 2 ^ j Then<br>            getBit = 1<br>        Else<br>            getBit = 0<br>        End If<br>    End Function<br>End Class<br></td>