<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections.Generic;<br><br>public class SchoolTrip {<br>  public double duration(int[] probability) {<br>        int n = probability.Length;<br>        double[,] exp = new double[1 &lt;&lt; n, n];<br>        for (int set = 1; set &lt; (1 &lt;&lt; n); ++set)<br>        {<br>            List&lt;int&gt; ind = new List&lt;int&gt;();<br>            for (int i = 0; i &lt; n; ++i)<br>                if (((set &gt;&gt; i) &amp; 1) != 0)<br>                {<br>                    ind.Add(i);<br>                }<br>            if (ind.Count == 1)<br>                continue;<br>            double[] res = new double[ind.Count];<br>            for (int step = 0; step &lt; 5000; ++step)<br>            {<br>                for (int i = 0; i &lt; ind.Count; ++i)<br>                {<br>                    double r = double.MaxValue;<br>                    for (int j = 0; j &lt; ind.Count; ++j)<br>                    {<br>                        if (i != j)<br>                        {<br>                            int ii = ind[i];<br>                            int jj = ind[j];<br>                            double p = probability[ii] / 100.0;<br>                            int k = (i + 1) % ind.Count;<br>                            if (k == j) {<br>                                k = (k + 1) % ind.Count;<br>                            }<br>                            int kk = ind[k];<br>                            r = Math.Min(r, 1 + p * exp[set ^ (1 &lt;&lt; jj), kk] + (1 - p) * res[(i + 1) % ind.Count]);<br>                        }<br>                    }<br>                    res[i] = r;<br>                }<br>            }<br>            for (int i = 0; i &lt; ind.Count; ++i)<br>                exp[set, ind[i]] = res[i];<br>        }<br>        return exp[(1 &lt;&lt; n) - 1, 0];<br>  }<br><br><br><br>}<br><br><br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003] [modified for C# by Petr]<br>// Powered by CodeProcessor<br></td>