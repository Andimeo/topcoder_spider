<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.math.*;<br><br>import static java.lang.Math.*;<br><br>public class PointsOnCircle {<br>  long ans = 0;<br>  long d1, d3;<br><br>  List&lt;Integer&gt; d, pw;<br><br>  void Go(int p, long x) {<br>    if (p == d.size()) {<br>      x &amp;= 3;<br>      if (x == 1) ++d1;<br>      if (x == 3) ++d3;<br>      return;<br>    }<br>    for(int i = 0; i &lt;= pw.get(p); ++i) {<br>      Go(p + 1, x);<br>      x *= d.get(p);<br>    }<br>  }<br><br>  public long count(int r) {<br>    d = new ArrayList&lt;Integer&gt;();<br>    pw = new ArrayList&lt;Integer&gt;();<br>    while (r % 2 == 0) r &gt;&gt;= 1;<br><br>    for(int i = 3; i * i &lt;= r; ++i) {<br>      if (r % i != 0) continue;<br>      int cnt = 0;<br>      while (r % i == 0) {<br>        ++cnt;<br>        r /= i;<br>      }<br>      d.add(i);<br>      pw.add(cnt * 2);<br>    }<br>    if (r != 1) {<br>      d.add(r);<br>      pw.add(2);<br>    }<br>    <br>    d1 = 0;<br>    d3 = 0;<br>    Go(0, 1);<br><br>    ans =  4 * (d1 - d3);<br>    return ans;<br>  }<br>}<br></td>