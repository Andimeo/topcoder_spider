<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.util.regex.*;<br>import java.text.*;<br>import java.math.*;<br>import java.awt.geom.*;<br> <br>public class CountPaths<br>{<br>  public int[] difPaths(int r, int c, int[] fieldrow, int[] fieldcol) {<br>    int[] dx = new int[] { 1, 0 };<br>    int[] dy = new int[] { 0, 1 };<br>    int mod = 1000007;<br>    int n = fieldrow.length;<br>    int[][] num = new int[r][c];<br>    for (int i = 0; i &lt; n; i++) {<br>      int x = fieldrow[i] - 1;<br>      int y = fieldcol[i] - 1;<br>      num[x][y] = i + 1;<br>    }<br>    int[][][][] res = new int[r][c][n + 1][n + 1]; // [\u1089][\u1082][\u1086][\u1083][\u1100][\u1082][\u1086]<br>    if (num[0][0] == 0)<br>      res[0][0][0][0] = 1;<br>    else res[0][0][1][num[0][0]] = 1;<br>    for (int x = 0; x &lt; r; x++)<br>      for (int y = 0; y &lt; c; y++)<br>        for (int k = 0; k &lt;= n; k++)<br>          for (int last = 0; last &lt;= n; last++) {<br>            if (res[x][y][k][last] == 0)<br>              continue;<br>            for (int d = 0; d &lt; 2; d++) {<br>              int x1 = x + dx[d], y1 = y + dy[d];<br>              if (x1 &lt; r &amp;&amp; y1 &lt; c) {<br>                if (num[x1][y1] == 0) {<br>                  res[x1][y1][k][last] = (res[x1][y1][k][last] + res[x][y][k][last])<br>                      % mod;<br>                } else if (num[x1][y1] &gt; last) {<br>                  res[x1][y1][k+1][num[x1][y1]] = (res[x1][y1][k+1][num[x1][y1]] + res[x][y][k][last])<br>                  % mod;<br>                }<br>              }<br>            }<br>          }<br>    int[] ans = new int[n+1];<br>    for (int i=0; i&lt;=n; i++)<br>    {<br>      for (int j=0; j&lt;=n; j++)<br>        ans[i] = (ans[i]+res[r-1][c-1][i][j])%mod;<br>    }<br>    return ans;<br>  }<br>  <br>  <br>}<br>//Powered by [KawigiEdit] 2.0!<br></td>