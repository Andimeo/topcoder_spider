<td class="problemText" colspan="8" valign="middle" align="left">
            // greetings to you, for reading this<br><br>#include &lt;algorithm&gt;<br>#include &lt;string&gt;<br>#include &lt;vector&gt;<br>using namespace std;<br><br>typedef long long ll;<br><br>#define LS &lt;<br>#define Size(x) (int(x.size()))<br><br>// All macros with parameters "k,a,b" run the "k" variable in range [a,b)<br>#define FOR(k,a,b) for(typeof(a) k=(a); k LS (b); ++k)<br><br>#line 3 "TVGame.cc"<br><br>#define P 121547<br><br>int b[60][60];<br><br>int val(char c) {<br>  if(c &gt;= '0' &amp;&amp; c &lt;= '9') return c - '0';<br>  if(c &gt;= 'A' &amp;&amp; c &lt;= 'I') return P + 'A' - c - 1;<br>  return 0;<br>  }<br><br>class TVGame {<br>  public:<br>  int expectedProfit(vector &lt;string&gt; board) {<br>    // !FDI<br>    int N = Size(board);<br>    <br>    FOR(y,0,N) FOR(x,0,N) b[y][x] = val(board[y][x]);<br>    <br>    int sign = 1;<br>    <br>    if(!(N&amp;1)) sign = P-sign;<br>    <br>    FOR(u,1,P) if(P % u == 0) printf("p%d\n", u);<br>    <br>    FOR(x,0,N) {<br>    <br>/*    printf("x=%d: sign=%d\n", x, sign);<br>      FOR(yy,0,N) {<br>        FOR(xx,0,N) printf("%6d", b[yy][xx]); printf("\n");<br>        }<br>*/    <br>      if(b[x][x] == 0) {<br>        FOR(y,x,N) if(b[y][x] != 0) {<br>          sign = P-sign;<br>          FOR(xx,0,N) swap(b[y][xx], b[x][xx]);<br>          goto gotit;<br>          }<br>        return 0;<br>        }<br>      <br>      gotit: <br><br>      int corn = b[x][x];<br>      <br>      ll q;<br>      for(q=0; q&lt;P; q++) if((q * corn) % P == 1) break;<br><br>      FOR(xx,0,N) b[x][xx] = (b[x][xx] * q) % P;<br>      sign = (sign * ll(corn)) % P;<br>//    printf("sign *= %d\n", corn);<br>      <br>      FOR(y,0,N) if(y!=x) {<br>        ll aa = b[y][x];<br>        FOR(xx,0,N) {<br>          b[y][xx] = (b[y][xx] - aa * b[x][xx]) % P;<br>          b[y][xx] += P; b[y][xx] %= P; <br>          }<br>        }<br>      }<br>    <br>    return sign;<br>    }<br>  };<br><br><br><br><br>// Powered by FileEdit<br>// Powered by TZTester 1.01 [25-Feb-2003]<br>// Powered by CodeProcessor<br></td>