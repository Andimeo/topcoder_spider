<td class="problemText" colspan="8" valign="middle" align="left">
            using System;<br>using System.Collections.Generic;<br>using System.Text;<br><br>public class RandomRide {<br>  static string[] roads = new string[]{"OBF","AGC","BGD","CHE","DKF","ELA","BIHC","GJD","GMJ","IMKH","JNLE","KNF","INJ","MLK"};<br><br>  public int flipCount(string flips) {<br>    int n = 'O' - 'A' + 1;<br>    bool[,,] was = new bool[n, n, flips.Length];<br>    int cur = 'A' - 'A';<br>    int prev = 'O' - 'A';<br>    int at = 0;<br>    int time = 0;<br>    while (true) {<br>      if (was[cur, prev, at])<br>  return -1;<br>      was[cur, prev, at] = true;<br>      int delta = 0;<br>      if (roads[cur].Length == 3) {<br>  if (flips[at] == 'H')<br>    delta = 1;<br>  else<br>    delta = 2;<br>  at = (at + 1) % flips.Length;<br>  ++time;<br>      } else {<br>  while (true) {<br>      String s = "" + flips[at];<br>    at = (at + 1) % flips.Length;<br>    s += flips[at];<br>    at = (at + 1) % flips.Length;<br>    time += 2;<br>    if (s == "HH")<br>      delta = 1;<br>    else if (s == "HT")<br>      delta = 2;<br>    else if (s == "TH")<br>      delta = 3;<br>    else {<br>            if (was[cur, prev, at])<br>             return -1;<br>            was[cur, prev, at] = true;<br>      continue;<br>    }<br>    break;<br>  }<br>      }<br>      int index = roads[cur].IndexOf((char) ('A' + prev));<br>      int next = (index + delta) % roads[cur].Length;<br>      next = roads[cur][next] - 'A';<br>      prev = cur;<br>      cur = next;<br>      if (cur == 'O' - 'A')<br>  return time;<br>    }<br>  }<br>}<br><br><br>// Powered by FileEdit<br></td>