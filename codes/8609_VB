<td class="problemText" colspan="8" valign="middle" align="left">
            imports System<br>imports Microsoft.VisualBasic<br>imports System.Collections<br>imports System.Text<br>imports System.Collections.Generic<br> <br>Public Class PhoneNumbers<br> <br>    Dim memo(50) As Integer<br>    Dim memou(50) As Integer<br>    Dim ss As String<br> <br>    Public Function bestNumber(ByVal number As String) As String<br>        ss = number<br> <br>        Dim i1 As Integer<br>        For i1 = 0 To 50<br>            memo(i1) = -1<br>        Next<br> <br>        Dim cp, un As Integer<br>        Dim b As String<br>        b = ""<br>        cp = 0<br>        While cp &lt; Len(number)<br>            bestScore(cp, un)<br>            b = b &amp; Mid(number, cp + 1, un) &amp; "-"<br>            cp += un<br>        End While<br> <br>        Return Left(b, Len(b) - 1)<br> <br>    End Function<br> <br>    Private Function bestScore(ByVal sp As Integer, ByRef un As Integer) As Integer<br>        un = -1<br>        If sp = ss.Length Then Return 0<br>        If sp = ss.Length - 1 Then Return -1000000<br>        If memo(sp) &lt;&gt; -1 Then<br>            un = memou(sp)<br>            Return memo(sp)<br>        End If<br> <br>        If sp = ss.Length - 2 Then<br>            un = 2<br>            memou(sp) = 2<br>            memo(sp) = getScore(Mid(ss, sp + 1, 2))<br>            Return memo(sp)<br>        End If<br> <br>        Dim b, v As Integer<br>        Dim xn As Integer<br>        b = -1000000<br>        v = getScore(Mid(ss, sp + 1, 2)) + bestScore(sp + 2, xn)<br>        If v &gt; b Then<br>            un = 2<br>            b = v<br>        End If<br>        v = getScore(Mid(ss, sp + 1, 3)) + bestScore(sp + 3, xn)<br>        If v &gt; b Then<br>            un = 3<br>            b = v<br>        End If<br> <br>        memou(sp) = un<br>        memo(sp) = b<br>        Return b<br>    End Function<br> <br>    Private Function getScore(ByVal s As String)<br>        Dim mm, i As Integer<br>        mm = 0<br>        For i = 1 To Len(s) - 1<br>            If s.Chars(i) &lt;&gt; s.Chars(0) Then mm += 1<br>        Next<br>        If mm = 0 Then Return 2<br> <br>        If Len(s) &lt;&gt; 3 Then Return 0<br>        If mm = 1 Then Return 1<br>        If s.Chars(1) = s.Chars(2) Then Return 1<br> <br>    End Function<br> <br>End Class<br></td>