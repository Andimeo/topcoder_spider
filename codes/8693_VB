<td class="problemText" colspan="8" valign="middle" align="left">
            Imports Microsoft.VisualBasic<br>Imports System<br>Imports System.Collections<br>Imports System.Text<br>Imports System.Math<br> <br>Public Class PrettyPrintASpiral<br>  Function Calc(r As Integer, c As Integer) As Integer<br>    Dim Layer As Integer = max(abs(r),abs(c))<br>    If r = c Then<br>      If r &gt;= 0 Then<br>        Return (2*r + 1)^2<br>      Else<br>        Return 1 + (2*r)^2<br>      End If<br>    ElseIf r = Layer Then<br>      Return Calc(Layer,Layer) - (Layer - c)<br>    ElseIf r  = -1 * Layer Then<br>      Return Calc(r,r) + (r-c)<br>    ElseIf c = Layer Then<br>      Return Calc(Layer-1,Layer-1) + (Layer - r)<br>    ElseIf c = -1 * Layer Then<br>      Return Calc(c,c) + (r-c)<br>    End If<br>  End Function<br>  Public Function getWindow(ByVal row1 As Integer, ByVal col1 As Integer, ByVal row2 As Integer, ByVal col2 As Integer) As String()<br>    Dim OutStr(row2-row1) As String<br>    Dim OutVal(row2-row1,col2 - col1) As Integer<br>    Dim numdig(row2-row1,col2-col1) As Integer, maxdig as integer = 0<br>    Dim I As Integer, J As Integer<br>    For I = row1 to row2<br>    For J = col1 to col2<br>    OutVal(I-row1,J-col1) = calc(I,J)<br>    numdig(I-row1,J-col1) = Int(log(outval(I-row1,J-col1))/log(10))+1<br>    If numdig(I-row1,J-col1) &gt; maxdig then<br>    maxdig = numdig(I-row1,J-col1) <br>    End If<br>    Next<br>    Next<br>    Console.writeline(maxdig)<br>    Dim K As Integer<br>    For I = row1 to row2<br>    For J = col1 to col2<br>    For K = 1 to maxdig-numdig(I-row1,J-col1)<br>    outstr(I-row1) &amp;= " "<br>    Next K<br>    If J &lt;&gt; col1 Then<br>    outstr(I-row1) &amp;= " "<br>    End If<br>    outstr(I-row1) &amp;= CStr(Format(outval(I-row1,J-col1)))<br>    Next<br>    Next<br>    Return OutStr<br>  End Function<br>End Class<br></td>