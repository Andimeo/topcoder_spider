<td class="problemText" colspan="8" valign="middle" align="left">
            import java.util.*;<br>import java.util.regex.*;<br>import java.text.*;<br>import java.math.*;<br>import java.awt.geom.*;<br>import static java.lang.Math.*;<br> <br>public class BinarySum<br>{<br>  public long a,b,c;<br>  public long[][][][][] memo;<br>  public long oo=987654321987654321L;<br>  public int len;<br> <br>  public int rearrange(int aIn, int bIn, int cIn)<br>  {<br>    a=aIn; b=bIn; c=cIn;<br>    len=max(max(len(a),len(b)),len(c));<br>    <br>    memo=new long[len+1][len+1][len+1][len+1][2];<br>    int i,j,k,x;<br>    <br>    for(x=0;x&lt;=len;x++)<br>    for(i=0;i&lt;=len;i++)<br>    for(j=0;j&lt;=len;j++)<br>    for(k=0;k&lt;=len;k++) Arrays.fill(memo[x][i][j][k],-1);<br>    <br>    long ret=solve(0,one(a),one(b),one(c),0);<br>    <br>    return ret&lt;oo?((int)ret):-1;<br>  }<br>  <br>  public long solve(int i,int a1,int b1,int c1,int carry)<br>  {<br>    if(a1&lt;0 || b1&lt;0 || c1&lt;0) return oo;<br>    <br>    if(memo[i][a1][b1][c1][carry]&gt;=0) return memo[i][a1][b1][c1][carry];<br>    <br>    long ret=oo;<br>calculate:  <br>    {<br>      if(i==len)<br>      {<br>        if(a1==0 &amp;&amp; b1==0 &amp;&amp; c1==0 &amp;&amp; carry==0)<br>        {<br>          ret=0;<br>        }<br>        else<br>        {<br>          ret=oo;<br>        }<br>      }<br>      else<br>      {<br>        int cd,newc;<br>        long sub=oo;<br>        ret=oo;<br>        <br>        //11<br>        cd=(1+1+carry)%2;<br>        newc=(1+1+carry)/2;<br>        <br>        sub=solve(i+1,a1-1,b1-1,c1-cd,newc);<br>        if(sub&lt;oo) ret=min(ret,sub*2+cd);<br>        <br>        //10<br>        cd=(1+carry)%2;<br>        newc=(1+carry)/2;<br>        <br>        sub=solve(i+1,a1-1,b1,c1-cd,newc);<br>        if(sub&lt;oo) ret=min(ret,sub*2+cd);<br>        <br>        //01<br>        <br>        sub=solve(i+1,a1,b1-1,c1-cd,newc);<br>        if(sub&lt;oo) ret=min(ret,sub*2+cd);<br>        <br>        //00<br>        cd=carry;<br>        newc=0;<br>        sub=solve(i+1,a1,b1,c1-cd,newc);<br>        if(sub&lt;oo) ret=min(ret,sub*2+cd);<br>      }<br>    }<br>    return memo[i][a1][b1][c1][carry]=ret;<br>  }<br>  <br>  public int len(long x)<br>  {<br>    int ret=0;<br>    while(x&gt;0)<br>    {<br>      ret++; x/=2;<br>    }<br>    return ret;<br>  }<br>  <br>  public int one(long x)<br>  {<br>    int ret=0;<br>    while(x&gt;0)<br>    {<br>      if(x%2==1) ret++;<br>      x/=2;<br>    }<br>    return ret;<br>  }<br>  <br>  <br>}<br>//Powered by [KawigiEdit] 2.0!<br></td>