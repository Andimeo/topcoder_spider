<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;cstdio&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;string&gt;<br>#include &lt;cmath&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;functional&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;list&gt;<br>#include &lt;queue&gt;<br>#include &lt;vector&gt;<br>#include &lt;valarray&gt;<br>#include &lt;complex&gt;<br>#include &lt;iostream&gt;<br>#include &lt;fstream&gt;<br>#include &lt;sstream&gt;<br> <br>using namespace std;<br> <br>#define SIZE(A) ((int)(A.size()))<br>#define LENGTH(A) ((int)(A.length()))<br>#define MP(A,B) make_pair(A,B)<br> <br>typedef long long int64;<br>typedef unsigned long long uint64;<br>typedef pair&lt;int,int&gt; ipair;<br>typedef pair&lt;double,double&gt; dpair;<br>typedef vector&lt;int&gt; VI;<br>#define two(X) (1&lt;&lt;(X))<br>#define twoL(X) ((1LL)&lt;&lt;(X))<br>#define contain(S,X) ((S&amp;two(X))&gt;0)<br>#define containL(S,X) ((S&amp;twoL(X))&gt;0)<br> <br>const double eps=1e-11;<br>const double pi=acos(-1.0);<br>const int oo=100000000;<br> <br>template&lt;class T&gt; int countbit(T n) {return (n==0)?0:(1+countbit(n&amp;(n-1)));}<br>template&lt;class T&gt; T lowbit(T n) {return (n^(n-1))&amp;n;}<br>template&lt;class T&gt; void checkmin(T &amp;a,T b) {if (b&lt;a) a=b;}<br>template&lt;class T&gt; void checkmax(T &amp;a,T b) {if (b&gt;a) a=b;}<br>template&lt;class T&gt; void out(T A[],int n) {for (int i=0;i&lt;n;i++) cout&lt;&lt;A[i]&lt;&lt;","; cout&lt;&lt;endl;}<br>template&lt;class T&gt; void out(vector&lt;T&gt; A,int n=-1) {if (n&lt;0) n=SIZE(A);checkmin(n,SIZE(A));for (int i=0;i&lt;n;i++) cout&lt;&lt;A[i]&lt;&lt;",";cout&lt;&lt;endl;}<br>template&lt;class T&gt; string toString(T x) {ostringstream sout;sout&lt;&lt;x;return sout.str();}<br>int toInt(string s) {int v;istringstream sin(s);sin&gt;&gt;v;return v;}<br>int toInt64(string s) {int64 v;istringstream sin(s);sin&gt;&gt;v;return v;}<br>template&lt;class T&gt; T gcd(T a,T b) {if (a&lt;0) a=-a;if (b&lt;0) b=-b;return (b==0)?a:gcd(b,a%b);}<br>template&lt;class T&gt; T lcm(T a,T b) {return (a/gcd(a,b))*b;}<br> <br>class BinaryMatrix <br>{<br>public:<br>  int n,A[100][5];<br>  int C[5];<br>  int f[42][22][22][22][22];<br>  int solve(int d,int B[5])<br>  {<br>    for (int i=0;i&lt;5;i++) if (B[i]&gt;C[i] || B[i]+(n-d)&lt;C[i]) return oo;<br>    int G[5];<br>    for (int i=0;i&lt;5;i++) G[i]=B[i]-max(0,C[i]-(n-d));<br>    int &amp;ret=f[d][G[1]][G[2]][G[3]][G[4]];<br>    if (ret!=-1) return ret;<br>    if (d==n) return ret=0;<br>    ret=oo;<br>    for (int k=0;k&lt;5;k++)<br>    {<br>      for (int j=0;j&lt;5;j++) if (A[d][(j-k+5)%5]==1) B[j]++;<br>      checkmin(ret,solve(d+1,B)+k);<br>      for (int j=0;j&lt;5;j++) if (A[d][(j-k+5)%5]==1) B[j]--;<br>    }<br>    return ret;<br>  }<br>  vector &lt;string&gt; getMaximalLexicographically(vector &lt;string&gt; matrix, vector &lt;int&gt; columns, int left) <br>  {<br>    n=SIZE(matrix);<br>    for (int i=0;i&lt;n;i++) for (int j=0;j&lt;5;j++) A[i][j]=(matrix[i][j]-'0');<br>    memset(f,255,sizeof(f));<br>    for (int i=0;i&lt;5;i++) C[i]=columns[i];<br>    int B[5];<br>    for (int i=0;i&lt;5;i++) B[i]=0;<br>    vector&lt;string&gt; result;<br>    if (solve(0,B)&gt;left) return result;<br>    for (int i=0;i&lt;n;i++)<br>    {<br>      int bestk=-1,bestV=-1;<br>      printf("%d %d ",i,left);<br>      out(B,5);<br>      for (int k=0;k&lt;5;k++)<br>      {<br>        int value=0;<br>        for (int j=0;j&lt;5;j++) if (A[i][(j-k+5)%5]==1) value|=two(4-j),B[j]++;<br>//        printf("%d ",k);<br>//        out(B,5);<br>//        printf("%d %d %d\n",solve(i+1,B),value,bestV);<br>        if (solve(i+1,B)+k&lt;=left &amp;&amp; value&gt;bestV) bestV=value,bestk=k;<br>        for (int j=0;j&lt;5;j++) if (A[i][(j-k+5)%5]==1) B[j]--;        <br>      }<br>      string s="";<br>      for (int j=0;j&lt;5;j++) if (contain(bestV,4-j)) s+="1",B[j]++; else s+="0";<br>      result.push_back(s);<br>      left-=bestk;<br>    }<br>    return result;<br>  }<br>};<br> <br>// Powered by PopsEdit<br></td>