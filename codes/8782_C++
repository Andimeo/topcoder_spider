<td class="problemText" colspan="8" valign="middle" align="left">
            #include &lt;vector&gt;<br>#include &lt;list&gt;<br>#include &lt;map&gt;<br>#include &lt;set&gt;<br>#include &lt;deque&gt;<br>#include &lt;stack&gt;<br>#include &lt;bitset&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;functional&gt;<br>#include &lt;numeric&gt;<br>#include &lt;utility&gt;<br>#include &lt;sstream&gt;<br>#include &lt;iostream&gt;<br>#include &lt;iomanip&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;cmath&gt;<br>#include &lt;cstdlib&gt;<br>#include &lt;ctime&gt;<br> <br>using namespace std;<br> <br>#define FOR(i,a,b) for (int i = (a); i &lt; (b); ++i)<br>#define FORD(i,a,b) for (int i = (a); i &gt;= (b); --i)<br>#define REP(i,n) FOR(i, 0, n)<br>#define SZ(x) ((int) (x).size())<br>#define ALL(x) (x).begin(),(x).end()<br>#define SORT(x) sort(ALL(x))<br>#define UNIQUE(x) SORT(x),(x).resize(unique(ALL(x)) - (x).begin())<br>#define pb push_back<br>#define X first<br>#define Y second<br> <br>typedef vector &lt;int&gt; VI;<br>typedef vector &lt;VI&gt; VVI;<br>typedef pair &lt;int, int&gt; PII;<br>typedef vector &lt;PII&gt; VPII;<br> <br>class ColorfulBalls {<br>public:<br>  double expectedStepCount(string);<br>};<br> <br>map &lt;VI, int&gt; p;<br>int N;<br> <br>void rec (VI a) {  <br>  int sum = N-accumulate (ALL (a), 0);<br>  if (sum == 0) {<br>    p[a] = SZ (p)-1;<br>    return;<br>  }<br>  int lim = sum;<br>  if (SZ (a))<br>    lim &lt;?= a.back();<br>  FOR (i, 1, lim+1) {<br>    VI b = a;<br>    b.pb (i);<br>    rec (b);<br>  }    <br>}<br> <br>int koef[2000][500];<br>int ind[2000][500];<br>int len[2000];<br>double val[2000];<br> <br>double ColorfulBalls::expectedStepCount(string c) {<br>  N = SZ (c);  <br>  rec (VI ());<br> <br>  for (map &lt;VI, int&gt;::iterator it = p.begin(); it != p.end(); it++) {  <br>    VI a = it-&gt;X;<br>    int i1 = it-&gt;Y;    <br>    <br>    map &lt;int, int&gt; h;<br>    <br>    REP (i, SZ (a))<br>      REP (j, a[i])<br>        REP (k, SZ (a))<br>          REP (e, a[k])<br>            if (i != k || j != e) {<br>              VI b (a);<br>              b[i]++;<br>              b[k]--;<br>              if (b[k] == 0)<br>                b.erase (b.begin() + k);<br>              SORT (b);<br>              reverse (ALL (b));<br>              <br>              int i2 = p[b];<br>              h[i2]++;<br>            }<br>    <br>    for (map &lt;int, int&gt;::iterator pit = h.begin(); pit != h.end(); ++pit) {<br>      koef[i1][len[i1]] += pit-&gt;Y;<br>      ind[i1][len[i1]] = pit-&gt;X;<br>      len[i1]++;<br>    }<br>  }<br>  <br>  REP (i, SZ(p))<br>    val[i] = 1.0;<br>  int h = p[VI (1, SZ (c))];<br>  REP (it, 15000) {<br>    REP (i, SZ (p)) {  <br>      if (h == i) {<br>        val[i] = 0.0;    <br>        continue;<br>      }<br>      double r = 0.0;<br>      REP (j, len[i]) <br>        r += (val[ind[i][j]]+1) * koef[i][j];<br>      r /= SZ(c) * (SZ(c)-1);<br>      val[i] = r;<br>    }<br>  }    <br>  map &lt;char, int&gt; kol;<br>  REP (i, SZ (c)) {<br>    kol[c[i]]++;<br>  }<br>  VI f;<br>  for (map &lt;char, int&gt;::iterator it = kol.begin(); it != kol.end(); ++it)<br>    f.pb (it-&gt;Y);<br>  SORT (f);<br>  reverse (ALL (f));<br>  return val[p[f]];<br>}<br> <br>//Powered by [KawigiEditNonTest] modified by pivanof!<br></td>