<td class="problemText" colspan="8" valign="middle" align="left">
            Public Class HappyCells<br><br>    Public Function getHappy(ByVal grid As String()) As Integer()<br>        Dim result(0 To 2) As Integer<br>        Dim i As Integer<br>        Dim j As Integer<br>        Dim i2 As Integer<br>        Dim j2 As Integer<br><br>        Dim happy1 As Boolean<br>        Dim happy2 As Boolean<br>        Dim happy3 As Boolean<br><br>        Dim dv As Boolean<br>        Dim ov As Boolean<br><br>        result(0) = 0<br>        result(1) = 0<br>        result(2) = 0<br>        For i = 0 To grid.Length - 1<br>            For j = 0 To grid(i).Length - 1<br>                Try<br>                    If (grid(i)(j) = ".") Then<br><br>                        happy1 = True<br>                        happy2 = True<br>                        happy3 = True<br>                        dv = False<br>                        ov = False<br><br>                        For i2 = -1 To 1<br>                            For j2 = -1 To 1<br>                                If (i2 = 0) And (j2 = 0) Then<br>                                    Continue For<br>                                End If<br>                                Try<br>                                    If (grid(i + i2)(j + j2) = "X") Then<br><br>                                    Else<br>                                        If ((i2 = -1) And (j2 = -1)) Or ((i2 = 1) And (j2 = 1)) Or ((i2 = -1) And (j2 = 1)) Or ((i2 = 1) And (j2 = -1)) Then<br>                                            dv = True<br>                                            happy3 = False<br>                                        Else<br>                                            ov = True<br>                                            happy2 = False<br>                                        End If<br>                                        happy1 = False<br>                                    End If<br>                                Catch ex As Exception<br><br>                                End Try<br>                            Next j2<br>                        Next i2<br><br>                        If (happy1) Then<br>                            result(0) = result(0) + 1<br>                        End If<br>                        If (dv) And (happy2) Then<br>                            result(1) = result(1) + 1<br>                        End If<br>                        If (ov) And (happy3) Then<br>                            result(2) = result(2) + 1<br>                        End If<br><br>                    End If<br>                Catch ex As Exception<br><br>                End Try<br>            Next j<br>        Next i<br><br>        Return result<br>    End Function<br><br>End Class<br></td>