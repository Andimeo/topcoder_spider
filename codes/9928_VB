<td class="problemText" colspan="8" valign="middle" align="left">
            Imports System.Math<br>Imports System.Text<br>Imports System.Text.RegularExpressions<br>Imports System.IO<br>Imports System.Text.Encoding<br>    Public Class TournamentWinner<br><br>        Public Shared Function winningProbabilities(ByVal P As Integer()) As Double()<br><br>            Dim comboProbs(7, 7) As Double<br>            Dim cnt As Integer = 0<br>            Dim player As Integer = 0<br>            For i As Integer = 7 To 1 Step -1<br><br>                For j As Integer = 8 - i To 7<br><br>                    comboProbs(player, j) = P(cnt) / 100<br>                    comboProbs(j, player) = 1 - (P(cnt) / 100)<br><br>                    cnt += 1<br>                Next<br>                player += 1<br><br>            Next<br><br>            Dim winRound(7, 2) As Double<br><br>            For i As Integer = 0 To 3<br>                winRound(2 * i, 0) = comboProbs(2 * i, 2 * i + 1)<br>                winRound(2 * i + 1, 0) = comboProbs(2 * i + 1, 2 * i)<br>            Next<br><br><br>            For i As Integer = 0 To 1<br>                winRound(i, 1) = Min(winRound(i, 0) * (winRound(2, 0) * comboProbs(i, 2) + winRound(3, 0) * comboProbs(i, 3)), 1)<br>            Next<br><br>            For i As Integer = 2 To 3<br>                winRound(i, 1) = Min(winRound(i, 0) * (winRound(0, 0) * comboProbs(i, 0) + winRound(1, 0) * comboProbs(i, 1)), 1)<br>            Next<br><br>            For i As Integer = 4 To 5<br>                winRound(i, 1) = Min(winRound(i, 0) * (winRound(6, 0) * comboProbs(i, 6) + winRound(7, 0) * comboProbs(i, 7)), 1)<br>            Next<br><br>            For i As Integer = 6 To 7<br>                winRound(i, 1) = Min(winRound(i, 0) * (winRound(4, 0) * comboProbs(i, 4) + winRound(5, 0) * comboProbs(i, 5)), 1)<br>            Next<br><br><br>            For i As Integer = 0 To 3<br>                winRound(i, 2) = Min(winRound(i, 1) * (winRound(4, 1) * comboProbs(i, 4) + winRound(5, 1) * comboProbs(i, 5) + winRound(6, 1) * comboProbs(i, 6) + winRound(7, 1) * comboProbs(i, 7)), 1)<br>            Next<br><br>            For i As Integer = 4 To 7<br>                winRound(i, 2) = Min(winRound(i, 1) * (winRound(0, 1) * comboProbs(i, 0) + winRound(1, 1) * comboProbs(i, 1) + winRound(2, 1) * comboProbs(i, 2) + winRound(3, 1) * comboProbs(i, 3)), 1)<br>            Next<br><br><br>            Dim ret(7) As Double<br>            For i As Integer = 0 To 7<br>                ret(i) = winRound(i, 2)<br>            Next<br><br>            Return ret<br><br>        End Function<br><br><br><br><br><br>    End Class<br></td>